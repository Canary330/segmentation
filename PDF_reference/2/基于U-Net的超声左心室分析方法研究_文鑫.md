## Page 1

 
单位代码：10610 
学    号：2019223049237 
 
 
 
硕士研究生学位论文 
 （专业学位）  
 
题目： 
基于U-Net 的超声左心室 
 
分析方法研究 
 
 
培养单位： 
计算机学院(软件学院) 
作者姓名： 
文 鑫 
指导教师： 
刘东权 教授 
学位类别： 
工程硕士 
领域名称： 
计算机技术 
 
 
论文答辩时间：二〇二三年九月 
学位授予时间：二〇二三年九月 
 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page1_img1.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page1_img1.png)

## Page 2

 
Research on ultrasonic left ventricular analysis method based 
on U-Net 
 
 
 
A dissertation submitted to Sichuan University 
in partial fulfillment of the requirements 
for the degree of  
Master of Engineering 
in Computer technology 
 
By 
Xin Wen 
Supervisor：Prof. Dong C Liu 
 
 
 
Computer Science, Sichuan University, Chengdu, China 
 
September 2023 
 
 
 
 
 


## Page 3

摘要 
Ⅰ 
摘 要 
我国居民至今频发心血管疾病，对人体损害较大，其已成为致居民死亡的罪魁祸
首。二维心脏超声检测 ( Echocardiogram ) 是一种目前最常见且使用最频繁的心脏机理
检测方法。在超声心动图中,针对成对的左心室图像进行定性与定量指标的分析是医师
判断患者心功能的关键。 
关于超声心动图左心室的分析，首先，其心室的准确分割是后续对心肌功能定量
分析的重要前提，左心室的准确分割也利于临床人员定性观察解剖形态是否异常；其
次，左心室射血分数( Ejection fraction , EF )是判断心脏功能的重要定量指标，而左心室
左心尖到二尖瓣中心点距离这一长轴维度 ( Long-axis Dimension , LAD )的精准测量有利
于计算结果的准确性；最后，左心室准确定量分析需要对成对心尖观超声图像进行分
析，临床人员在采集图像过程中也需要注意操作，以实现有效测量。在实际任务进行
时，需要临床人员手动对图像进行放大、勾勒轮廓、确定左心尖和二尖瓣中心位置等
操作，对操作人员有一定要求。但是，由于超声成像所固有的低信噪比、边缘不清晰
等缺陷，到现在为止，左心室的临床分析任务存在主观性强，可重复性低，工作量大
等问题。因此，对心脏超声图像左心室区域的自动分割以及长轴维度的自动测量，以
及对于心脏超声图像腔室结构的判别，对于左心室准确定量分析是一个亟待解决的问
题。该问题的解决，对于临床对左心室功能的准确高效评估具有重大意义，而腔室结
构的判别对于临床图像采集人员的辅助指导也具有重大意义。 
针对上述问题，本文针对超声心脏图像左心室，研究了左心室分割、长轴维度量
化以及腔室结构判别等内容。主要内容包括基于双解码端U-Net网络的左心室分割、长
轴维度量化以及腔室结构判别。主要工作与贡献如下： 
(1) 验证一些 Snake 及其改进模型在本文数据集上的表现结果，总结出传统方法在
左心室超声图像分割工作表现上的局限性。 
(2) 提出了双解码端U-Net 网络，采用结合左心尖与二尖瓣中心点位置特征信息和
左心室分割区域特征信息作为标签的双解码端U-Net网络，对左心尖和二尖瓣中心点直
接标注，从而直接获得左心室的长轴维度(Long-axis Dimension , LAD ) 这一重要指标，
进而计算EF 值，完成了对LAD、面积以及EF 这三类指标的直接量化。 
(3) 采用结合超声图像腔室结构信息和左心室分割区域特征信息作为标签的双解码
端U-Net 网络，在单一网络上同时完成了对左心室的分割和两腔\四腔的腔室结构判别，
比较了单平面面积-长度法和辛普森法计算得到的EF 与推荐算法双平面辛普森法的EF
结果的差异。确定了两腔\四腔判别功能对成对心尖超声图像采集的辅助指导功能。 
(4) 引入Dense Block 模块和注意力融合模块对双解码端U-NET 进行改进，进一步


## Page 4

基于U-Net 的超声左心室分析方法研究 
II 
提高了两腔四腔判别的准确性和左心室分割的精度。引入Dense Block 模块对网络编码
端结构进行改进，使通道信息融合更为优秀，减少参数量，提高训练速率。在腔室判
别解码端引入注意力融合模块，提高两腔四腔判别的准确率。 
关键字：超声心动图; 左心室分割; EF;U-Net 
 
 


## Page 5

Abstract 
III 
Abstract 
At present, cardiovascular diseases have occurred frequently in Chinese residents, which 
have caused great damage to the human body and have become the main culprit causing the 
death of residents. Echocardiogram (2D Echocardiogram) is one of the most common and 
frequently used cardiac mechanism detection methods. In echocardiography, the qualitative and 
quantitative analysis of paired left ventricle images is the key for doctors to judge the heart 
function of patients. 
The accuracy of segmentation of the left ventricle is a fundamental factor in the 
quantitative assessment of myocardial function, and this same segmentation allows clinical 
personnel to qualitatively determine if the anatomical shape is abnormal. In echocardiography, 
this is a key factor to consider when analyzing the left ventricle. The accuracy of calculation 
results is enhanced by the precise measurement of the Long-axis Dimension (LAD), which is 
the span from the apical of the left ventricle to the center of the mitral valve. Moreover, the left 
ventricular Ejection fraction (EF) is a significant quantitative measure for gauging heart 
function. Finally, accurate quantitative analysis of the left ventricle requires the analysis of 
paired apical ultrasound images, and clinical personnel also need to pay attention to the 
operation in the process of image acquisition to achieve effective measurement. In the actual 
task, clinical personnel need to manually enlarge the image, outline the outline, determine the 
left apical of the heart and mitral valve center position and other operations, which have certain 
requirements for operators. Until now, clinical analysis of the left ventricle has been a subjective, 
repetitive and laborious task, owing to the inherent flaws of ultrasonic imaging such as low 
signal-to-noise ratio and indistinct edges. The urgent need to solve the automatic segmentation 
of the left ventricular region, the automatic measurement of the long axis dimension, and the 
identification of the chamber structure in cardiac ultrasound images for the precise quantitative 
analysis of the left ventricle is of great importance. This resolution is essential for the precise 
and effective evaluation of left ventricular function. in clinic, and the identification of chamber 
structure is also of great significance for the auxiliary guidance of clinical image acquisition 
personnel. 
This paper investigated the segmentation of left ventricle, quantifying long axis dimension, 
and recognizing chamber structure in ultrasonic heart image to address the aforementioned 
issues. The main contents include left ventricular segmentation, long-axis dimension 
quantization and chamber structure identification based on U-Net double-decoded terminal 


## Page 6

基于U-Net 的超声左心室分析方法研究 
 
IV 
network. The main work and contributions are as follows: 
(1) Verify the performance results of some Snake and its improved models on the dataset 
in this paper, and summarize the limitations of traditional methods in the performance of left 
ventricular ultrasound image segmentation. 
(2) A double-decoded U-Net network is proposed, which uses the double-decoded U-Net 
network combined with the location characteristic information of the left apical of the heart and 
mitral valve center and the feature information of the left ventricular segmentation region as 
labels to directly label the left apical of the heart and mitral valve center. In this way, the Long-
axis Dimension (LAD) of the left ventricle was directly obtained, and then the EF value was 
calculated, completing the direct quantification of LAD, area and EF. 
(3) Using the double-decoded U-Net network combined with the ultrasonic image chamber 
structure information and the left ventricle segmentation region feature information as labels, 
the left ventricle segmentation and the two-cavity/four-chamber structure identification were 
completed simultaneously on a single network. The EF calculated by the single-plane area-
length method and Simpson method is compared with the EF calculated by the recommended 
two-plane Simpson method. The auxiliary and guiding function of two-cavity/four-cavity 
discriminant function for pairwise apical ultrasound image acquisition was determined. 
(4) Dense Block module and attention fusion module are introduced to improve U-NET at 
the double decoding end, which further improves the accuracy of two-cavity four-cavity 
discrimination and the accuracy of left ventricular segmentation. Dense Block module is 
introduced to improve the network coding terminal structure, so that the channel information 
fusion is better, the number of parameters is reduced, and the training rate is increased. The 
accuracy of two-cavity four-cavity discrimination is improved by introducing attention fusion 
module in the decoding end of the chamber discrimination. 
Key words : Echocardiogram; Left ventricular segmentation; EF; U-Net 


## Page 7

目  录 
第1 章 绪论............................................................................................... 1 
1.1 研究背景和意义 ............................................................................... 1 
1.2 超声成像简介 ................................................................................... 2 
1.3 国内外研究现状 ............................................................................... 3 
1.3.1 左心室分割相关算法研究现状 ................................................. 3 
1.3.2 左心室直接量化分析研究现状 ................................................. 5 
1.4 本文的主要工作 ............................................................................... 6 
1.5 论文结构安排 ................................................................................... 6 
第2 章 基于Snake 模型的左心室分析 .................................................. 9 
2.1 引言 ................................................................................................... 9 
2.2 经典模型介绍 ................................................................................... 9 
2.2.1 Snake 原始模型 ........................................................................... 9 
2.2.2 GVF 模型 ................................................................................... 10 
2.2.3 ADF 模型 ................................................................................... 11 
2.2.4 基于圆投影向量场分析的ADF 模型 .................................... 11 
2.3 实验结果与分析 ............................................................................. 13 
2.3.1 数据集 ....................................................................................... 13 
2.3.2 实验配置及结果分析 ............................................................... 13 
2.4 本章小结 ......................................................................................... 17 
第3 章 基于双解码端U-Net 的超声左心室分析 ................................ 19 
3.1 引言 ................................................................................................. 19 
3.2 理论基础 ......................................................................................... 20 
3.2.1 U-Net 模型 ................................................................................. 20 
3.2.2 双解码端U-Net 模型 ............................................................... 20 
3.2.3 左心室EF 值计算 .................................................................... 22 
3.2.4 网络学习损失函数 ................................................................... 23 
3.3 左心尖和二尖瓣标注网络 ( AMD U-Net ) .................................. 23 
3.3.1 数据集 ....................................................................................... 24 
3.3.2 试验配置 ................................................................................... 24 
3.3.3 评价指标 ................................................................................... 25 
3.3.4 结果分析 ................................................................................... 26 
3.4 左心室和右心房标注网络 ( CD U-Net) ...................................... 31 
3.4.1 数据集 ....................................................................................... 32 
3.4.2 实验配置与流程 ....................................................................... 32 


## Page 8

3.4.3 评价指标 ................................................................................... 35 
3.4.4 结果分析 ................................................................................... 35 
3.5 本章小结 ......................................................................................... 41 
第4 章 基于改进双解码端U-Net 的超声左心室分析 ........................ 43 
4.1 引言 ................................................................................................. 43 
4.2 理论基础 ......................................................................................... 44 
4.2.1 结合注意力机制的融合模块 ................................................... 44 
4.2.2 Dense Net ................................................................................... 45 
4.2.3 本章网络结构 ........................................................................... 47 
4.3 实验设置与材料 ............................................................................. 48 
4.3.1 数据集 ....................................................................................... 48 
4.3.2 实验配置 ................................................................................... 48 
4.3.3 评价指标 ................................................................................... 49 
4.4 实验结果与分析 ............................................................................. 49 
4.4.1 网络输出结果 ........................................................................... 49 
4.4.2 消融实验结果 ........................................................................... 50 
4.4.3 CAMUS 公开数据集测试结果 ................................................ 52 
4.5 本章小结 ......................................................................................... 53 
第5 章 结论与展望 ................................................................................ 55 
5.1 本文工作总结 ................................................................................. 55 
5.2 未来工作展望 ................................................................................. 56 
参考文献 ................................................................................................... 57 


## Page 9

图表目录 
VII 
 
图表目录  
图1.1 超声心动图两腔/四腔特征示意图 ....................................................................... 2 
图2.1 一些向量场模式及其对应( )
P  ........................................................................ 12 
图2.2 传统Snake 模型实验的(a)初始图、(b)手工确定初始轮廓 ............................. 14 
图2.3 传统Snake 模型分割结果(a)GT、(b)演化图像 ................................................ 14 
图2.4 不同值下的分割效果 ...................................................................................... 15 
图2.5 不同值下的分割效果 ...................................................................................... 15 
表2.1 在不同值和下的GVF 模型Dice 系数 ....................................................... 16 
图2.6 ADF 模型分割示例 ............................................................................................. 16 
图3.1 左心室分割及心尖与二尖瓣标注示意图 .......................................................... 19 
图3.2 U-Net 网络结构 ................................................................................................... 20 
图3.3 双解码端U-Net 结构 .......................................................................................... 21 
图3.4 辛普森方法示意图 .............................................................................................. 22 
图3.5 双平面辛普森法示意图 ...................................................................................... 23 
图3.6 网络训练数据集示意图 ...................................................................................... 24 
图3.7 Dice 指数示意图.................................................................................................. 25 
图3.8 成功分割及标注案例 .......................................................................................... 26 
图3.9 失败案例展示 ...................................................................................................... 27 
图3.10 手动补足边缘对比实验 .................................................................................... 27 
表3.1 左心室相关量化指标的MRE ............................................................................ 28 
表3.2 左心室分割结果的量化指标对比 ...................................................................... 28 
图3.11 一组连续帧的分割结果 .................................................................................... 29 
表3.3 EF 值相关系数对比 ............................................................................................ 30 
图3.12 分割效果对比 .................................................................................................... 30 
表3.4 左心室分割结果的量化指标对比 ...................................................................... 31 
图3.13 左心室和右心房位置示意图 ............................................................................ 32 
图3.14 数据集标签标注示意图 .................................................................................... 33 
图3.15 后处理算法流程图 ............................................................................................ 33 
图3.16 两腔/四腔判别实例 ........................................................................................... 34 
图3.17 模型输出左心室分割结果 ................................................................................ 34 
图3.18 左心室分割后处理算法流程图 ........................................................................ 34 
图3.19 分割区域后处理 ................................................................................................ 35 


## Page 10

基于U-Net 的超声左心室分析方法研究 
VIII 
图3.20 左心室分割案例 ................................................................................................ 36 
图3.21 四种网络分割效果对比 .................................................................................... 36 
表3.5 左心室相关量化指标的MRE ............................................................................ 37 
表3.6 左心室分割结果的量化指标对比 ...................................................................... 37 
图3.22 两腔\四腔判别成功案例 ................................................................................... 38 
图3.23 两腔\四腔判别失败案例 ................................................................................... 38 
表3.7 两腔/四腔判别准确率 ......................................................................................... 39 
表3.8 EF 值相关系数对比 ............................................................................................ 39 
图3.24 分割效果对比 .................................................................................................... 40 
表3.9 左心室分割结果的量化指标对比 ...................................................................... 40 
表3.10 两腔/四腔判别准确率 ....................................................................................... 41 
图4.1 腔室判别失败案例 .............................................................................................. 43 
图4.2 融合模块 .............................................................................................................. 44 
图4.3 Dense Block 结构图示意 .................................................................................... 46 
表4.1 编码器改进结构 .................................................................................................. 47 
图4.4 本章改进的网络结构 .......................................................................................... 48 
图4.5 数据集标签标注示意图 ...................................................................................... 49 
图4.6 改进双解码端U-Net 网络输入输出结果 .......................................................... 49 
图4.7 模型分割结果 ...................................................................................................... 50 
表4.2 左心室分割结果的量化指标对比 ...................................................................... 50 
表4.3 两腔四腔判别准确率对比 .................................................................................. 51 
表4.4 EF 值对比 ............................................................................................................ 51 
表4.5 左心室分割结果的量化指标对比 ...................................................................... 52 
表4.6 两腔四腔判别准确率对比 .................................................................................. 53 
 
 


## Page 11

第1 章 绪论 
1 
第1 章 绪论 
1.1 研究背景和意义 
近些年来，伴随着我国经济持续繁荣发展，医疗保健行业和医疗保障产业也得到
了极大的发展。随着人们生活水平的提高，导致人类基本生命健康受到威胁的主要影
响因素也逐渐变成了各种慢性疾病。在导致慢性病的因素中，混乱的生活规律，不合
理的膳食结构，以及极度缺乏的体育锻炼等因素，共同导致了心血管疾病 (简称CVD) 
在城乡居民总死亡原因中占据第一位，具体占比为乡村46.66%、城市43.81%，对人民
自身健康和社会繁荣发展造成了沉重负担，是我们当前面临的一个重要公共健康安全
问题[1]。据统计结果显示，我国国内大约有3.3 亿人患各种心血管疾病。其中，脑梗死、
冠心病的人口约有1139 万，患高血压病的约有2.45 亿人。且这一数据仍呈逐年上升趋
势[2]。 
迄今为止，医生们仍主要通过电脑扫描断层 ( CT ) 、核磁共振 ( MRI ) 以及超声诊
断等手段来进行心血管疾病的检测。同时，因为使用超声检测具备下列优点：1) 实时
性，能将心腔内构造、心脏搏动等特点实时表现出来；2) 无辐射且无创成像；3) 成本
低廉且设备操作灵活，心脏超声检测成为使用最多且普及范围最广的检测手段[3]。心
脏超声检测也是日常体检或心血管疾病早期检测使用最多的手段。通常，医生通过超
声心动图检测心房、心室的大小，室间隔、房间隔厚度，瓣膜的闭合情况，血流的速
度以及左心室射血分数 (Ejection Fractions, 简称EF 值) 等指标，以此对心脏是否异常进
行诊断。这里最常见到的就是EF 值，它可以代表左心室收缩末期至舒张末期之间的体
积变动，为心脏功能检测提供了有效的定量分析指标[4]。 
超声心动图的左心室定量分析主要是通过对心动图中的左心室区域的一维、二维
以及三维特征进行一定的估测来进行相应计算，其中包括长轴维度 ( Long-axis 
Dimension , LAD ) 的距离、短轴维度 ( Short-axis Dimension , SAD ) 的距离和左心室的
面积 (Area)[5]，如图1.1 所示。因超声成像相比于其他检测方法的局限性，超声心动图
图像易受斑点噪声等影响，成像质量较MRI 等方法差，存在边缘伪影，这也导致左心
室的分割过程很难完全准确的判断和区分超声图像的细节[6]。同时，因为心脏结构复
杂，并且在超声成像过程中心脏的不断收缩-舒张使得心室的位置不断发生变化，这也
对左心室的分割造成一定的困难。 
目前，虽然已有众多左心室超声检测自动或半自动辅助系统来帮助医生对超声心
动图进行定量分析，但这些方法在面对两腔/四腔等不同视角切面同时存在时的分析手
段仍有一定的局限性，需要操作人员手动确定超声图像为两腔还是四腔，以便后续左


## Page 12

基于U-Net 的超声左心室分析方法研究 
2 
心室定量分析得以更加准确。 
综合考虑，超声心动图切面的准确识别和分割技术的发展至关重要，它不仅能够
帮助医生更精准地定量分析左心室，而且还能够提升临床医生的诊断准确度、可靠性
和可重复性，从而发挥着重要的社会意义。 
 
 
 
 
 
 
 
               (a)一维度量                                                           (b)二维度量 
图1.1 超声心动图两腔/四腔特征示意图 
Figure 1.1 Schematic diagram of features of two-chamber/four-chamber echocardiography 
1.2 超声成像简介 
超声波,是指频谱幅度超出了一般人类听见的正常声音频谱的声音,其频谱幅度一
般大于20000 赫兹 (Hertz, Hz ) 。自然界中，如蝙蝠就是通过发送和接受超声波对障碍
物定位，从而能在黑暗环境中轻易飞行。受到此现象启发，人类开始根据蝙蝠回声定
位原理研发了特殊的装置和设备。超声在医学领域首先应用于治疗领域，将超声技术
用于碎石，并将高强度聚焦超声用于手术。其后，声呐雷达等在军事领域的广泛运用
才将人们的视线引向超声在医学检测领域的应用。 
医学上使用的超声为20000Hz 以上的纵向压力波，医学诊断治疗上常使用的频率
为2-10MHz[7]。超声波是一种机械波，由振动产生，由于纵波在传播过程中会使得介
质颗粒产生变化的特性，使其传播能量能变得更加快。超声波有以下传播特点：1)在
密度均匀的介质中，超声波不会产生反射现象；2)当相邻介质的密度与超声传播的速
度的乘积之间的差异超过0.1%时，超声波就会在差异产生处发生反射和折射等现象；
3) 当超声波穿越低于其速度直径或粗糙接口时，就会出现散射现象，这就意味着，随
着介质的密度增加，超声波的反应也会发生变化，从而使得超声波的传播受到限制，
从而影响其传播效率，其回声形成不同分界面。此外，超声波在媒介中传播时，其方
向性非常明显，它以直线的形式传播，具有良好的方向性。具有物理特性，如超声的
多普勒(Doppler)效应，可以用于检测人体的器官，这是超声检测的基础
[8]。当超声波
在传播中出现反射现象、折射现象、散射现象、衰减现象等情况时，其反射所传递的



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page12_img1.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page12_img1.png)

## Page 13

第1 章 绪论 
3 
超音波是回报。 
医学诊断超声是指通过超声波的物理性质以及人体器官的组织密度不同，使其回
声通过检波器处理，通过波形、曲线或合成图像等形式，通过这些人体对超声的反馈
信号来对疾病进行诊断。人体不同的器官组织具有一定的声阻抗和衰减性，且各不相
同，这些特性使得超声传播在不同的器官组织中会遭遇不同的声阻抗和衰减性。在探
测时，在探测中,把超声波发射到人体内后，由人体表层传播到体内深处，再利用具有
各种不同声阻抗途径，进入器官或组织，超声波的衰减性也就不同。从而形成了不同
的声反射和衰减，造成了超声波的不同的回声强度。医用超声检查主要是利用装置接
收的回声信息，并按其信号强较弱程度，以光度差异的光点呈现在设备的显示屏上，
进而产生一个代表身体的各器官截面超声波图像，即声像图[9]。 
1.3 国内外研究现状 
目前，对于超声心动图左心室的自动以及半自动定性定量分析方法，得到了广泛
的研究发展和应用。本小节将对当前国内外左心室分割和定量分析的研究状况进行一
定的分析和探讨。 
1.3.1 左心室分割相关算法研究现状 
能够得到心脏超声图像左心室准确的分割结果是后续医师对受检测心脏的功能进
行定性定量分析的一个重要先决条件。由于心脏的复杂结构、伪边界和超声图像中难
以消除的噪音，准确地分离左心室变得尤为重要，这也成为了全球关注的焦点。左心
室的分割目前分为两种研究方向：传统的方法和深度学习[10](Deep Learning)。 
在传统方法研究中，阈值分割[11],[12]是最早期发展起来的一种常用图像分割方法，
具体为设定一个阈值，按其像素的灰度值对待分割的图像进行分类，从而实现将该图
像分割成不同的区域的目的。Kass 等人[13]于1988 年提出了一种新的超声心动图分析技
术，主动轮廓方法，它可以有效地抑制斑点噪声和伪影干扰，从而达到最佳的结果。
这种技术利用最小化能量函数，可以有效地获取目标区域的轮廓线。截至目前，已有
多位研究者投入研究，将主动式轮廓法运用到左心室的超声心动图分割上来。Mishra
等人[14] 给出了一个基于遗传算法的主动轮廓模型求解方案,该方法利用低通滤波和形态
学算法来定义了第一幅输入图形的原始轮廓,并通过对强度梯度的非线性映射求解能量
泛函从而演化得到了目标区域分割轮廓,并把该轮廓视为下一帧图形的初始轮廓,并以此
进行对左心室序列图形的重新划分。Ning 等人[15] 提出了一种多尺度水平集的方法，该
方法利用高斯模型近似地描述图像在粗尺度下的灰度分布，再结合图像区域均匀性和
边缘特征,采用水平集方法,在这种粗尺度下自动提取边界，确定目标区域的初始轮廓，
之后在更精细的尺度上，这些粗边界将作为外部约束来指导轮廓演化。Boukerroui 等


## Page 14

基于U-Net 的超声左心室分析方法研究 
4 
人[16]在贝叶斯框架中引入了全局和局部统计方法，对左心室结构进行自适应的区域分
割，该方法利用加权函数对分割过程的自适应特性来进行控制，进而完成了对超声心
动图图像目标区域特征的分割。Belaid 等人[17]发表了一种新的水平集的分割方法，是
基于相位设计的，该方法将局部相位与局部方向引入到水平集中，对左心室边缘进行
捕捉，这使得该方法对伪影以及灰度不均匀等因素具有更好的鲁棒性。可以促进算法
更加适应性地匹配心脏结构和分布。Chen 等人[18]通过在主动轮廓算法中引入先验知识
[19]，设计了依赖于左心室先验形状的能量项，此能量项是关于活动轮廓与给定先验左
心室轮廓的接近度，其通过一种独立于轮廓方向、位置以及尺度的方式来测量，从而
对心尖四腔观超声图像的左心室完成分割，从中提取出了相应的左心室轮廓。以此更
进一步，Chen 等人[20]提出基于先验形状和先验强度等先验知识的主动轮廓模型对心尖
二腔观中左心室进行分割。Xiao 等人[21]提出了一种不同于检验边缘轮廓线的方法，其
通过对分割区域进行像素标记来实现左心室分割，该方法利用马尔可夫随机场法和最
大后验概率法，两种方法相结合对超声心动图像的变形场进行了估算，并且根据校正
后的强度统计值标记图像区域从而实现左心室分割。 
近几年来，深度学习的发展越来越繁荣，其应用领域越来越广泛，研究者们也越
来越多的采用深度神经网络模型的方法来实现心脏超声图像相应区域的分割。这种算
法的优点,就是端到端的结构以及其不需要通过先验信息与用户交流,就能够很直观得到
预测结果。深度学习方法的引入，还能更准确全面的学习超声心动图象与特征标签之
间的非线性映射关系。 
Chen 等人[22]通过采用跨域的迁移学习，有效地增强了特征表示，强化了全卷积网
络对心脏超声图像左心室的分割。Moradi 等人[23]使用特征金字塔将U-Net 网络的解码
器部分的特征进一步融合，以获得更丰富的语义描述，增强了分割结果的准确性。Liu
等人[24]通过对网络添加金字塔局部注意模块，在紧凑或稀疏的相邻上下文中捕捉信息
来强化特征，再结合标签一致性学习机制来提高像素及其邻域的预测一致性，从而实
现心脏超声图像的分割。Hamila 等人[25]通过一种全新的2D 和3D 全卷积神经网络对心
尖四腔(A4C)观左心室进行分割。Krishnaswamy 等人[26]提出了一种依赖于微分配准的
半自动化分割算法对时间序列的三维心脏超声进行分割。Xu 等人[27]通过采用空洞卷积
链来聚合多尺度上下文信息和减少网格问题，以精确定位心脏腔室的位置, 再通过 W-
Net 获得更为精确边界，从而实现胎儿心尖四腔观超声图像分割。Dong 等人[28]采用基
于迁移学习和残差模块的全卷积网络以获得左心室分割初步结果，再以此结果作为
Snake 模型的初始轮廓，使用三维 Snake 能量函数作为约束项，优化三维心脏超声左心
室分割结果以得到更为精确的分割结果。Degel 等人[29]采用 V-Net[30]作为主干网络，结
合关于左心房形状和成像设备的先验知识，对三维超声左心房进行分割。Jafari 等人[31]
首先根据心脏形态完整度、噪声大小等因素将超声图像分为高、低质量两类，然后通


## Page 15

第1 章 绪论 
5 
过解剖约束的 CycleGAN 改善低质量图像，以求提高图像质量以提高分割效果。Veni 
等人[32]通过端到端训练的全卷积网络模型对左心室进行一定的初步分割以得到一个满
足一定条件的初步分割结果，再以此分割结果作为先验的初始轮廓，并用此分割结果
驱动基于水平集的形变模型，从而实现对心尖四腔观(A4C)超声心动图像的分割。Yu 
等人[33]将用于提取高层上下文语义特征的上下文路径和用于捕获低层空间特征的空间
路径相结合，实现对儿童超声心动图像的分割。Dong 等人[34]将Atlas 先验信息集成到
端到端深度学习优化框架中，在信息一致性约束下对网络进行优化，实现了立体的心
脏超声影像的左心室的分割。Hansegard 等人[35]通过结合所有视角下超声心动图像中
纹理、形状的运动向量构建多视角特征，采用主动外观模型中实现多视角心超序列左
心室分割，该方法考虑到了不同视角心脏超声图像之间的空间相关性而引入空间信息
互补。类似地考虑到空间信息互补的研究还有Allan 等人[36]对左心房分割和二尖瓣返
流患病诊断的相关研究，其主要通过将心尖二腔观和四腔观感兴趣区域的主成分分析
特征连接起来，再结合支持向量机，利用联合多视角进行独立的组分分析。Ye 等人[37]
提出了一种基于BiSeNet 网络架构，结合空间路径和上下文路径的Bi-DCNet 网络，首
次在大型数据集上完成验证。Zhang 等人[38]提出了一种基于滑块的强化学习深度网络，
避免了编码端-解码端结构网络和腔室结构信息可能造成的粗燥分割，完成了四腔图像
左心室的高精度分割。 
1.3.2 左心室直接量化分析研究现状 
左心室EF 是一个重要的心脏功能指标，它可以用来评估心脏的正常运作，无论是
直接还是间接地反映出心脏的血液循环情况。大多数有关左心室的定量分析研究都会
关注EF 值的测定。Afshin 等人[39]建立了一个基于图像分布之间的 Bhattacharyya 相似
系数的统计, 再通过全连接网络实现了超声心动图左心室短轴截面的面积估测。Wang 
等人[40]通过似然函数对同质性、边缘以及斑点等多个外观特征进行挖掘，同时设计先
验概率模型来融合区域间的相关性，进而完成面积的估测。Zhen 等人[41]提出了一种基
于方向梯度直方图、金字塔Gabor 特征以及像素灰度等多种特征相结合的表示方法，
再通过随机森林回归出心脏截面的面积，用于累加计算容积。更进一步，Zhen 等人[42]
采用监督流形正则化的方法对矩阵进行广义低秩逼近，通过特征降维去除冗余信息，
再提取与腔体相关的判别特征，克服了四腔结构的空间高复杂度。Xue 等人[43][44][45]提
出在手动标记的ROI 上，通过特征提取与线性回归相结合一同学习的方法，该方法利
用预训练的自动编码器来进行特征提取，在此基础上，将提取的特征分别用以学习各
个壁厚和面积等指标的参数[43]。再进一步，用一条前向卷积网络路径对各指标进行初
步估算，再用一条辅助切片空间递归神经元和时间递归神经元和相结合的路径对残差
进行估测，两步结合从而实现各帧超声心动图图像中腔室壁厚的准确估测[44]。在此基


## Page 16

基于U-Net 的超声左心室分析方法研究 
6 
础上更进一步，Xue 等人选取联合的递归神经元路径作为主干网络结构，用于提取时
空关联性，再用 L1/ L2 范数以及运动阶段标签约束,实现各指标的回归估测[45]。 
以上直接量化分析工作在心脏磁共振图像(MRI)上有广泛研究，但在超声心脏图像
领域，对于左心室的直接量化分析仍是一个研究的重点问题。由于超声成像的固有缺
点，其图像常常出现信息缺失，故而，对于超声心动图的直接量化面临许多问题。如
Silva 等人[46]提出了基于3D-CNN 的心尖四腔观(A4C)超声心动图的EF 值计算。Ge 等
人[47]提出了一种结合患者级整体特征作为基底和帧级动态变化残差的残差循环网络，
再结合左心室定位、裁剪和计算模块构成一个整体的网络结构，直接从多维度、多角
度对心脏功能各指标进行估算。Smistad 等人[48]提出了一种由视图分类、心动周期定时、
分割和标注提取等深度学习模块组成的实时自动射血分数计算辅助系统。该方法结果
表明EF 值受投影缩减影响很大且可以测量心脏超声成像过程中由于操作人员引起的投
影缩减，具有良好的应用前景。 
1.4 本文的主要工作 
本文首先通过查阅收集文献，比较全面认识了左心室定量分析对心脏功能检查的
重要性与临床意义。左心室的准确分割结果，对左心室进行定量分析具有重要意义。
完成超声心动图精确分割和左心室EF 计算是这篇论文的主要目的。本文的主要工作如
下： 
(1) 验证一些传统方法如 Snake 模型在左心室分割上的表现以及该方法的局限性。 
(2) 对U-Net 进行改进，在改进网络上完成对超声心动图左心室区域的分割以及左
心室区域左心尖和二尖瓣中心位置的标注。在此基础上完成对左心室面积的估算从而
得到EF 值。同时对比分析现有网络与本文网络的结果。 
(3) 利用该改进网络，完成对超声心动图心尖两腔观(A2C)和心尖四腔观(A4C)的分
类和左心室区域的分割，在此分割基础上进行二值轮廓检测、凸包检测、矩形拟合等
相关后处理并计算左心室EF 值。 
(4) 对上述双解码端U-Net 网络进行改进，提高了网络对左心室的分割精度以及两
腔四腔判别功能的准确性。 
1.5 论文结构安排 
本文共分为五个章节，其章节内容大致按以下几个方面安排： 
第一章为绪论，以介绍了超声成像原理和国内外研究现状，给出了左心室分割及
定量分析的研究背景与意义；其次对本文的主要工作进行了介绍，并给出了全篇文章
的章节安排。 


## Page 17

第1 章 绪论 
7 
第二章，介绍了当前一些对Snake 模型的改进模型在超声左心室分割工作上的实
践成果，介绍了一些当前对于传统分割方法的研究结果以及传统方法的局限性。 
第三章，介绍了双解码端U-Net 网络，以及分别采用左心尖二尖瓣标注以及两腔
四腔分类信息标注的实验结果。首先，详细介绍了U-Net 网络的结构以及改进双解码
端U-Net 网络。其次，介绍了基于左心尖和二尖瓣中心点为解码端2 标签的网络及其
实验结果与分析。最后，介绍了采用左心室和右心房区域作为解码端2 标签的网络及
其实验结果与分析。 
第四章，介绍了基于改进双解码端U-Net 的左心室两腔四腔分类以及左心室定量
分析算法。首先介绍了改进网络的理论基础。其次，介绍了网络结构。最后是实验流
程、实验结果以及结果分析三个方面的内容。 
第五章工作综述与展望，对以U-Net 为基础的左心室分割及EF 计算等工作进行了
总结，并且指出了目前工作存在的不足以及未来能够进一步改进的地方。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 


## Page 18

基于U-Net 的超声左心室分析方法研究 
8 
 
 
 
 
 
 
 
 
 
 
 
 
 


## Page 19

第2 章 基于Snake 模型的左心室分析 
9 
第2 章 基于Snake 模型的左心室分析 
2.1 引言 
在关于超声心动图左心室的分割问题研究上，当前已有大量相关研究成果。其中，
在超声影像的分割问题上，研究者广泛应用了基于形变模型的思想。通过形变模型，
可以有效地利用图像中的特征信息，将曲线或曲面演化，以达到最优的分割效果。具
体来说，可以根据曲线或曲面的运动特性，设定一个相应的能量函数，并将其最小化，
以达到最佳的分割效果。这一类算法也可以看作是曲线演化的模型,该类算法会将待分
割区域的理想边界视为这一个运动初始轮廓的最终演化状态。通过参数主动轮廓和几
何主动轮廓的方式，本章详细探讨了 Snake 模型，以及一些经典改进模型介绍，以提
高超声心动图左心室的分割精度。该模型的优势在于，能够更准确地捕捉到动态变化
的特征，从而更好地满足医学诊断的需求。 
2.2 经典模型介绍 
2.2.1 Snake 原始模型 
Kass 等人[13] 提出了一种新的数学模型 Snake，它可以用来解决复杂的变分问题。
Snake模型采用封闭式曲线或曲面的形态变换，将分割问题转换为最佳问题，在将最小
的能量函数转换为最优问题，从而使曲线或曲面逐渐接近目标对象的边缘。 
Snake 模型的核心思想是：通过利用弹性力学的概念，如弹性势能、弯曲势能等，
来构建一个具有良好性质的能量函数，并且把图像的基本属性也纳入这个函数的考量
范围。内在能量使曲线在演化过程中保持平滑，外在能的作用是驱动曲线向目标处演
化，曲线轮廓在内能与外能有机结合共同作用下演变。曲线在模型能量达到最小时演
化结束，即作用于曲线上的内能和外能达到平衡状态。Snake 可以定义为一条参数曲
线[13]： 
                                                       ( )
[ ( ), ( )]
v s
x s y s
=
                                                  (2-1) 
假定S 表示弧长，那么以( )
v s 为变量的Snake 模型能量函数
nake
S
E
可定义为下式所
示： 
            
nake
1
1
int
0
0
( ( ))
[
( ( ))
( ( ))
( ( ))]
S
Snake
image
con
E
E
v s ds
E
v s
E
v s
E
v s
ds

=
=
+
+


                (2-2) 
式中：
int
E
——内部能量；
image
E
——图像能量；
con
E
——外部能量；( )
v s ——Snake 沿路径s 上
的点 
路径s 的长度归一化到1，当能量函数
nake
S
E
最小时，( )
v s 即为目标轮廓。 


## Page 20

基于U-Net 的超声左心室分析方法研究 
10 
该模型的优点是，曲线演化过程以及曲线轮廓完整性受图像质量主要是图像噪声
影响较小，总可以得到较为光滑、封闭的目标边界，适合应用于结构复杂的图像。缺
点是演化效果受初始轮廓的选择影响较大，而且，如何选取合适的初始轮廓也是这一
方法的问题所在。 
2.2.2 GVF 模型 
传统的Snake 模型由于受限于初始轮廓选取范围，在边界凹陷处收敛性较差。为
了解决这些问题对分割效果的影响，Xu 等人[49]提出了在模型中加入一个梯度矢量流场 
(Gradient vector flow ,GVF) 作为 Snake 模型的外力。GVF 是由梯度向量产生的扩散灰
度或二值边缘映射所形成的密集向量场。下式可定义此外力场： 
                                          
( , )
[ ( , ), ( , )]
V x y
u x y v x y
=
                                                  (2-3) 
则此时的Snake 模型能量泛函如式2-4 所示： 
           
2
2
2
2
2
2
( , )
(
)
x
y
x
y
E u v
u
u
v
v dxdy
f
V
f
dxdy

=
+
+
+
+

−


                           (2-4) 
式中：f ——边缘图，则
f

的值在边缘附近高，在均质区域低； 
2
2
2
2
(
)
x
y
x
y
u
u
v
v dxdy

+
+
+

——平滑能量即Snake 模型中的内能； 
2
2
f
V
f
dxdy

−

——外部能量；  
——权值，平衡内能与外能 
曲线演化过程即对公式2-4 的最小化求解，通过变分演算，最小化式2-4 可简化为
求如下欧拉-拉格朗日方程： 
                                         
2
2
2
(
)(
)
0
x
y
V
V
f
f
f

−
−
+
=
                                          (2-5) 
将
( , )
V x y 作为一个关于 t  , x  ,和 y 的函数，将式2-5 嵌入到一个动态格式中，如
下式所示： 
                                        
2
2
2
2
2
2
(
)(
)
0
(
)(
)
0
x
x
y
x
x
y
u
u
u
f
f
f
t
v
v
v
f
f
f
t




=

−
−
+
=



=

−
−
+
=


                                  (2-6) 
式中：
2
——拉普拉斯算符 
求得结果为 ( , )
x y  点集，该集合即为目标轮廓。该方法能有效克服传统 Snake 模
型初始轮廓选取要求高这一问题，且在边界凹问题上也取得了一定的改进成果。但在
窄而深的边界处收敛效果仍不理想；且对于强度差异较大的强弱边界处时，弱边界可
能会出现边界消失等问题。 


## Page 21

第2 章 基于Snake 模型的左心室分析 
11 
2.2.3 ADF 模型 
自适应的扩散流场模型 (Adaptive Diffusion Flow ADF) 是一种对经典GVF 模型的
改进模型。基于前文提到的因GVF 方法的局限而出现的问题，Wu 等人[50]提出了不同
于梯度矢量场的一种新的外力，即自适应扩散流场(ADF)。它将梯度向量流场方法中
的能量泛函的平滑能量项替换为谐波超曲面极小泛函，以减少弱边可能产生的渗漏，
以减少弱边缘可能出现的泄漏。它还利用p(x)在1 到2 范围内的p(x)谐波映射，使得流
场的扩散过程可以根据图像特征自适应调整。还结合了一个无限拉普拉斯泛函到ADF
模型，将活动轮廓驱动到物体的深凹和窄凹区域。其能量泛函如式2-7 所示： 
             
2
2
1
( )
(1
)
( 1
)
L
E V
g
m
m
dxdy
h V
f
dxdy
p



=
−

+
−

+ 
+

−






              (2-7) 
式中：
2
1
(1
)
( 1
)
L
g
m
m
dxdy
p



−

+
−

+ 





——平滑能量项； 
2
h V
f
dxdy

−

——边缘能量项和停止触发项； 
f
——图像边缘图f 导出的梯度场； 
g 、m 和h ——权重函数； 
p ——单调递减函数，
1
1 1
p
G f

= + + 
，边缘图f
I
= 
，I 表示待分割的灰度图像； 
当
0
G f


→
时
2
p →，当
G f


→时，
1
p →； 
2
1 ( 1
)
p 
+ 
——谐波超曲面极小泛函，
2
G V

=
，G为标准差为的高斯核； 
L

——无穷拉普拉斯算子 
求解式2-7 最小值的欧-拉方程如式2-8 所示： 
     
2
(
)
( )
(1
)
(
)
0
V
V
L V
g m
m div
G
V
h V
f
G
V
V
















+
−


−
−
=
















                (2-8) 
式中：
V


——无穷大拉普拉斯量，
2
2
xx
x
xy
x
y
yy
y
V
V V
V V V
V V


=
+
+
；
(
)
1 (
)
V
V

=
+ 
 
该泛函的极小化是由方程
( )
V
L V
t

=

，其中(0)
V
f
= 来迭代得到的。 
运用ADF 最重要的一点是要合理选取p 、m 和的值，研究表明其选取符合如式
2-9 所示： 
                                         
2
2
2
2
1-
;
5
5
0;     
f
f
if
K
m
K
otherwise





= 



                                                (2-9) 
式中K 的取值满足
(
)
(
)
1.4826
K
E
f
E
f
=


−

，E 表示图像均值。 
2.2.4 基于圆投影向量场分析的 ADF 模型 
基于前文提到的ADF 模型的使用需要选取合适的p 、m 和的值，这一点在实际


## Page 22

基于U-Net 的超声左心室分析方法研究 
12 
应用中的选取依据是不太符合上述2-9 公式所示，需要不断试错以达到最佳效果。故
而 Rodtook 等人[51]提出了一种基于圆形矢量场分析来选取ADF 模型的控制参数的方法。
该方法能够提供改进的边缘图f 和其他计算ADF 模型参数值的方法，且使ADF 模型
不再需要高斯核等平滑项。 
圆投影是在一个相邻向量的窗口上进行的，假设一个以向量
( , )
V i j 为中心，k
k

个像素大小的窗口
k k
w ，表征向量场模式的特征值可由式2-10 得出： 
                       
( )
(
)
2
,
( , ) ( ) ;   ( , )
i j
k k
p
q
P
V p q
V p q
w



=


                             (2-10) 
式中，
cos( )
( )
,     0
sin( )







=






。 
对
( )
,i j
P

+
和
( )
,i j
P

−
分别按下式2-11 和2-12 定义： 
( )
(
)
2
,
( , ) ( ) ; if ( , ) ( )
0
0;                       otherwise
p
q
i j
V p q
V p q
P



+



= 


                                        (2-11) 
( )
(
)
2
,
( , ) ( ) ; if ( , ) ( )
0
0;                       otherwise
p
q
i j
V p q
V p q
P



−



= 


                                        (2-12) 
图2.1 展示了一些向量场模式以及其相对应的圆投影示例： 
 
 
 
 
 
 
a)(噪声)                                 b)(边界)                                     c)(背景) 
 
 
 
 
 
 
d)噪声
( )
P                               e)边界
( )
P                                 f)背景
( )
P  
图2.1 一些向量场模式及其对应( )
P  
Figure 2.1 Some vector field patterns and their corresponding ( )
P  
如图2.1(a)和(d)对应所示，在排斥或吸引节点处的
( )
P 表现为一个包含多个波峰



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page22_img1.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page22_img1.png)

![基于U-Net的超声左心室分析方法研究_文鑫_page22_img2.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page22_img2.png)

![基于U-Net的超声左心室分析方法研究_文鑫_page22_img3.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page22_img3.png)

![基于U-Net的超声左心室分析方法研究_文鑫_page22_img4.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page22_img4.png)

![基于U-Net的超声左心室分析方法研究_文鑫_page22_img5.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page22_img5.png)

![基于U-Net的超声左心室分析方法研究_文鑫_page22_img6.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page22_img6.png)

## Page 23

第2 章 基于Snake 模型的左心室分析 
13 
波谷的小幅度曲线。在边界处的投影曲线特点为有一个或两个波峰且有一个很大振幅。
对应图(c)和(f)背景处，
( )
P

+
和
( )
P

−
有不同表现。 
基于( )
P 、
( )
P

+
和
( )
P

−
，可以定义如下是的两种度量： 
                               
(
)
( )
(
)
( )
(
)
(
)
( )
(
)
( )
(
)
(
)
.
.
.
.
,
max max
max
min min
min
i j
i j
i j
i j
D i j
P
P
P
P








+
−
+
−
=
−
，
，
                             (2-13) 
                                    
(
)
( )
(
)
( )
(
)
(
)
( )
(
)
( )
(
)
(
)
.
.
.
.
min min
min
,
max max
max
i j
i j
i j
i j
P
P
R i j
P
P








+
−
+
−
=
，
，
                        (2-14) 
则圆投影图C 可由式C
D
R


=
I
得到，其中D和R为相对应归一化的结果。由此，
圆投影图的梯度
C

可用于替换
f
，同时，假设式2-7 中的G V
V


，则基于圆投影
向量场分析的ADF 模型分割效果将不在受到值影响。故该改进ADF 的控制参数可
定义为
1
m
D
= −
，
2
p
D
=
−
。因此，在图像边界处，
1
D→，此时
0
m →，能量泛函
将受到谐波超曲面极小能量泛函的极大影响，此时扩散流将沿边缘方向的各向异性扩
散，为目标边界。 
2.3 实验结果与分析 
2.3.1 数据集 
本文使用的超声心动图均来源于声泰特(成都)科技有限公司。每个超声视频为一
例个体的超声心动图，一个视频包括多个心动周期。数据集来自9 个不同对象共15 组
心脏超声图片，每组心动图为包含多个心动周期的240 帧心超图，共计3600 张。图像
原始分辨率为1430 768

。将全部超声图像进行灰度归一化预处理。 
2.3.2 实验配置及结果分析 
2.3.2.1 传统 Snake 模型 
传统 Snake 模型的优异的分割效果，很大程度上是依赖于初始轮廓的巧妙选取来
实现的。本节使用手动选取初始轮廓实验Snake 模型的分割精度。其初始轮廓以及分
割效果如图2.2 所示.本节实验采用的传统Snake 模型能量泛函如下式所示： 
                      
nake
1
2
2
0
1 (
( )
( ) )
( ( ))
2
S
con
E
v s
v s
E
v s
ds







=
+
+





                               (2-15) 
最小化上式的欧拉方程如式2-14 所示： 
( )
( )
0
con
v s
v s
E



−
−
=
                                             (2-16) 
带入( )
v s 是关于t , s, 的函数： 


## Page 24

基于U-Net 的超声左心室分析方法研究 
14 
                                   
( , )
( , )
( , )
t
con
v s t
v s t
v
s t
E




=
−
−
                                     (2-17) 
当解( , )
v s t 稳定时，就能得出最后演化的结果。 
 
 
 
 
 
 
 
(a)原始图像                  (b)手工勾勒图像 
图2.2 传统Snake 模型实验的(a)初始图、(b)手工确定初始轮廓 
Figure 2.2 Traditional Snake model experiment: (a) initial diagram, (b) manual determination of 
initial contour 
经过实验验证，当=0.25，=0 时，实验取得最佳效果，其分割结果如图2.3 所
示： 
 
 
 
 
 
 
(a)GT                                    (b) 演化图像                      
图2.3 传统Snake 模型分割结果(a)GT、(b)演化图像 
Figure 2.3 Segmentation results of Snake model (a)GT, (b) manual outline 
如图2.3(b)所示，金色曲线为Snake模型分割结果，由图2.2对比可知，传统Snake
模型在拥有良好的初始轮廓的情况下能取得出色的分割结果。其Dice 系数分为0.9014。 
2.3.2.2 GVF、ADF 模型 
对于 GVF 模型和 ADF 模型，都需要在实验过程中取得边缘图
( , )
f x y ，边缘图的
计算满足
( , )
( , )
( , )
f x y
G
x y
I x y

=

，故的取值会影响分割的效果。 
对于GVF 模型，通过实验对比分析和的取值对分割效果的影响。如图2.4所
示，在
0.1
=
时，分别为0.5、1、1.5、2时的分割效果： 
 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page24_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page24_img1.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page24_img2.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page24_img2.jpeg)

## Page 25

第2 章 基于Snake 模型的左心室分析 
15 
 
 
 
 
 
(a)0.5                                    (b)1.0 
 
 
 
 
 
(c)1.5                                     (d)2.0 
图2.4 不同值下的分割效果 
Figure 2.4 Segmentation effect under different  values 
由图2.4可知，图中红色曲线为GVF模型的曲线演化结果，在一定时，为了取得
良好的分割结果，取值要大于一定值。 
当
2.0
=
时，分别取0.05、0.1、0.15、0.2的分割效果如图2.5所示： 
 
 
 
 
 
(a)0.05                                    (b)0.1 
 
 
 
 
 
(c)0.15                                     (d)0.2 
图2.5 不同值下的分割效果 
Figure 2.5 Segmentation effect under different  values 
由图 2.5 可知，对于本章所用左心室心动超声数据， 
0.1
=
 的分割效果达到最



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page25_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page25_img1.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page25_img2.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page25_img2.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page25_img3.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page25_img3.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page25_img4.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page25_img4.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page25_img5.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page25_img5.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page25_img6.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page25_img6.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page25_img7.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page25_img7.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page25_img8.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page25_img8.jpeg)

## Page 26

基于U-Net 的超声左心室分析方法研究 
16 
佳，再增大时影响不再明显，值和值影响的 Dice 系数如表2.1所示。 
表2.1 在不同值和下的GVF 模型Dice 系数 
Table 2.1 Dice coefficient of GVF model at different  and  values 
 
0.5
=
 
1.0
=
 
1.5
=
 
2.0
=
 
0.05
=
 
0.5013 
0.7217 
0.7901 
0.8564 
0.1
=
 
0.6873 
0.7734 
0.8544 
0.9021 
0.15
=
 
0.5317 
0.7319 
0.8407 
0.8767 
0.2
=
 
0.5453 
0.7403 
0.8321 
0.8821 
由表2.1可以看出，在本章所用左心室心动超声数据实验结果下，在
2.0
=
，
0.1
=
时GVF模型效果最好。 
对于ADF模型，类似于GVF模型，由式2-7可知，ADF模型需要调控的参数有K 和
。图像噪声越大，的取值就应该越大；K 的取值应随着图像边界的强弱调整，边
界弱时取值小，边界强时取值大，实验结果表明K 的取值范围为[0.03,0.1]。其分割结
果如图2.6所示。此时
2.0
=
，图2.6(a)、(c)的
0.03
K =
，(b)、(d)图像的
0.1
K =
 
 
   
 
 
 
 
(a) 
0.03
K =
                            (b) 
0.1
K =
 
 
 
 
 
 
 
(c) 
0.03
K =
                            (d) 
0.1
K =
 
 
图2.6 ADF 模型分割示例 
Figure 2.6 Segmentation example of ADF model 
如图2.6所示，(a)、(b)图像存在弱边界时，K 的取值小更能有效达到分割效果。



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page26_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page26_img1.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page26_img2.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page26_img2.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page26_img3.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page26_img3.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page26_img4.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page26_img4.jpeg)

## Page 27

第2 章 基于Snake 模型的左心室分析 
17 
(c)、(d)图像的边界较强，K 的取值应该相应增大。其Dice系数达到了0.9122。 
对于改进ADF模型，基于圆投影矢量场分析，使得该方法不需要考虑高斯平滑，
即不需要对待分割区域预处理也能良好运行，这一方法在本文超声心动图数据中关于
左心室的分割工作也取得了优异表现，其Dice系数达到了0.9231。表明该方法适用于
超声左心室分割。 
综合上述所有实验结果表明，传统方法均会存在对待分割图像的先验信息有一定
依赖性等问题，在面对一幅完整超声图像时，可能会因为心室具有的复杂结构等因素
影响导致算法在初始轮廓选取时就发生目标区域定位错误等情况出现。 
2.4 本章小结 
在超声心动图左心室分割问题上，本章介绍了一些主动轮廓模型改进方法的实际
效果。在保证初始轮廓的选取具有一定质量时，传统Snake 模型就能获得一个较好的
分割效果，其Dice 系数达到了0.9014。GVF、ADF、基于圆投影矢量场分析的ADF 在
参数选取合适的情况下都能达到一个较好的分割结果，其最优参数下的Dice 系数分别
为0.9021、0.9122 和0.9231。但传统方法在不同数据之间的优异分割表现的可重复性
较差，对不同数据集进行处理时依赖先验信息，在临床表现上也对操作人员有更高的
要求，因此，本文引入基于深度学习的方法。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 


## Page 28

基于U-Net 的超声左心室分析方法研究 
18 
 
 
 
 
 
 
 
 
 
 
  
 


## Page 29

第3 章 基于双解码端U-Net 的超声左心室分析 
19 
第3 章 基于双解码端U-Net 的超声左心室分析 
3.1 引言 
心脏超声心动图是检测心脏功能的重要手段，结合心动图影像临床医生能对心室
功能进行定性及定量分析，反映心脏功能的重要指标是心脏腔室的长短轴距离、腔室
面积和射血评分 ( EF ) 。其中，左心室作为心脏最大的腔室，其舒张末期到收缩末期
的容积变化即射血分数 (EF) 是常用于心脏功能临床诊断的一项重要指标。左心室面积
的准确估计是准确计算其EF 值的重要前提。临床常根据左心室面积与左心尖到左心室
二尖瓣的欧氏距离估算左心室射血分数，如图所示。但是，由于超声成像的一些如噪
声、伪影等固有缺点影响，临床医务人员常会因主观想法而使结果差异较大，且难以
重复。针对传统方法对所采集影像结构相似性的依赖，本章引入基于深度学习的方法，
利用双解码端U-NET 模型，来完成左心室的分析工作。 
 
 
 
 
 
 
 
 
 
 
图3.1 左心室分割及心尖与二尖瓣标注示意图 
Figure 3.1 Left ventricular segmentation and apical and mitral valve labeling 
在本章中，通过提出双解码端U-Net 网络，其中一个解码端全自动的完成对左心
室的分割。另一个解码端完成长轴维度量化或者腔室判别功能：长轴维度量化功能采
用对左心尖以及二尖瓣中心位置进行标注，从而得到左心室的长轴维度以及面积这两
项重要参数，再经过后续计算即可估算得出左心室EF 值；腔室判别功能采用对左心室
和右心房位置这一腔室结构信息进行标注来完成对图像两腔四腔判别这一功能的实现。 
 
 
 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page29_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page29_img1.jpeg)

## Page 30

基于U-Net 的超声左心室分析方法研究 
20 
3.2 理论基础 
3.2.1 U-Net 模型 
U-Net[52]是Olaf R 等人于2015 年提出的一种可以基于小数据集做出语义分割的网
络结构，模型结构如图3.2所示。其主要用于攻克医学范畴的图像分割难题。作者同时
采用数据增强等技术，可以通过使用有限数量的样本，完成高效率的端到端地网络训
练，实现图像的精确定位和分割。由于该网络结构为一个U 型，因而得名U-Net。U-
Net 也是一种对称的生成模型，左边部分由conv 层、ReLU 层和Pooling 层组成，进行
下采样特征提取，称之为编码端(Encoder)。右边部分从下到上利用transposed 
convolution 进行图上采样，将浓缩的特征进行还原，恢复上下文的位置信息，称之为
解码端(Decoder)。如图中所示，深蓝色的箭头表示进行卷积操作，其卷积核尺寸大小
为3×3，作用是改变特征图的通道数，以便更好捕捉特征信息；然后使用ReLu 函数对
特征图进行非线性激活；棕色箭头表示进行最大池化操作，作用是使特征图尺寸减小；
红色剪头表示上采样操作；最后的绿色箭头表示进行卷积操作，其卷积核大小为1× 1；
灰色箭头表示级联(concatenate)操作，通过拼接的方式将相对应尺寸的特征图通道进行
叠加融合，在解码端的上采样过程中加入来自浅层的卷积层特征信息，因为浅层特征
图的分辨率较高，而且由于特征层数较浅，信息中会含有比较丰富的低层信息，用以
为网络的分割预测提供更多尺度和多层次的信息，有助于还原下采样过程中带来的信
息损耗[53]。这有利于使得网络的预测结果更加精细。 
 
 
 
 
 
 
 
图3.2 U-Net 网络结构 
Figure 3.2 U-net network structure 
3.2.2 双解码端U-Net 模型 
本文的改进网络为在U-Net 网络结构的编码端之后再增加一个解码端，以完成原
U-Net 网络所不具备的功能，形成Encoder-Decoder+Decoder 结构的双解码端U-NET。
如图3.3 所示。解码端1 完成对左心室的分割，解码端2 完成对超声心动图左心尖以及
二尖瓣的标注或者对左心室和右心房范围进行分割，称为双解码端U-Net 网络 ( Dual-



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page30_img1.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page30_img1.png)

## Page 31

第3 章 基于双解码端U-Net 的超声左心室分析 
21 
decoding U-Net, DDU-Net )。 
在该双解码端U-Net 网络中，整体结构仍类似为一个U 型结构，网络的左边部分
为编码端，其中有四个下采样模块，每个下采样模块的作用为对输入的特征图进行特
征提取操作同时进行通道数升维操作，每一个下采样模块都为两个卷积层和一个池化
层组成，其中，卷积层的卷积核采用尺寸为3× 3，在进行卷积操作后会将卷积后的输
出进行由 ReLU 激活函数进行的非线性激活，然后再利用一个最大池化层对输出特征
图进行最大池化操作，最大池化操作能够保证特征图的在平移、旋转等操作时尺度保
持不变，因此对于图像待分割区域可以保留更多的纹理信息。 
右边部分包含两个解码端，其结构一致。每一个解码端均含有四个上采样模块，
每个上采样模块中包括一个上采样操作和两个卷积操作，上采样模块的输入包含两个
部分，一个是前面一个模块的输出特征，另一个是采用跳层连接操作所调取过来的尺
寸相对应的浅层网络的输出特征图，两者进行级联操作。前一模块输出过来的深层信
息包含有比较多的抽象语义特征，其分辨率比较低，它能够提供待分割目标在整张图
像中更多的语义信息，而浅层特征信息是从尺寸相对应的编码端模块传递过来的较高
分辨率的信息，级联操作可以将前一模块输出的低分辨率的语义特征和编码端高分辨
率的低维特征进行特征融合。最后一个上采样模块中，经过上采样操作和两层卷积操
作后，将特征图输入进一个尺寸大小为1×1 的卷积核的卷积层进行通道降维操作，在
最后使用 softmax 激活函数对待输出图像的每个像素点进行预测，其中概率值最大的
类别即作为该像素点的预测类别。其输出即为分割结果。 
 
 
 
 
 
 
 
 
 
 
 
图3.3 双解码端U-Net 结构 
Figure 3.3 U-Net structure with two decoders 
 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page31_img1.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page31_img1.png)

## Page 32

基于U-Net 的超声左心室分析方法研究 
22 
3.2.3 左心室EF 值计算 
3.2.3.1 辛普森法的左心室EF 计算 
二维超声心动图的近似左心室容积可根据其分割区域面积与左心尖到二尖瓣的欧
氏距离求得[54]。A (area)为左心室分割区域的面积。LAD 为左心尖到二尖瓣的距离，
即网络输出结果中左心尖和二尖瓣标注两点之间的距离。 
心脏超声图像中左心室的近似容积可以根据辛普森方法得出。如下图3.4所示，当
切面为心脏正中心切面时，左心室区域沿长轴维度方向均分为n 份，则每一份区域高
近似为
/
L n ，对于左心室腔体可近似认为是由下图右上方图例所示的圆盘叠加。圆盘
直径为该份区域横向短轴维度(SAD)，p 表示相邻像素点之间的欧氏距离，则这一时
刻左心室近似容积可由式3-1 估算得出，再由式3-2 计算射血分数。 
2
3
1
4
n
i
SAD L
V
p
n

=
=


                                                (3-1) 
 
 
 
 
 
 
 
图3.4 辛普森方法示意图 
Figure 3.4 Schematic diagram of simpsons method 
ED
V
、
ES
V
分别记作左心室舒张末期和收缩末期的近似容积，那么射血分数即可计
算得： 
100%
ED
ES
ED
V
V
EF
V
−
=

                                              (3-2) 
3.2.3.2 双平面辛普森法的左心室EF 计算 
对于左心室分割区域，它的最小外接矩形可由矩形拟合得到，其最小外接矩形的
长度近似于长轴维度的长度。进而可根据收缩-舒张末期左心室容积变化对 EF 值进行
计算。左心室的近似容积由如图 3.5 所示的双平面辛普森法[55]求得，其公式如 3-3 所
示。 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page32_img1.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page32_img1.png)

![基于U-Net的超声左心室分析方法研究_文鑫_page32_img2.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page32_img2.png)

![基于U-Net的超声左心室分析方法研究_文鑫_page32_img3.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page32_img3.jpeg)

## Page 33

第3 章 基于双解码端U-Net 的超声左心室分析 
23 
3
2
4
1
4
n
A Ci
A Ci
i
D
D
L
V
p
n

=


=


                                              (3-3) 
式中：
2
A Ci
D
 ——心尖两腔观视图下的该位置的短轴长度；
4
A Ci
D
 ——心尖四腔观视图下的该位置
的短轴长度；L ——长轴维度距；p ——相邻像素点之间的欧式距离 
 
 
 
 
 
 
 
图3.5 双平面辛普森法示意图 
Figure 3.5 Schematic diagram of biplane Simpson method 
 
3.2.4 网络学习损失函数 
本文网络采用构造如下的交叉熵损耗函数： 
1
1
1
log( (
))
(1
) log(1
(
))
N
i
i
i
i
i
i
i
L
L
y
p y
y
p y
N
N
=
=
= −

+
−

−


                 (3-4) 
式中：
iy ——符号函数(0 或1)，如果样本i 的真实类别属于标签，则取1，否则取0； 
(
)
i
p y
——观测样本i 属于标签的预测概率。 
3.3 左心尖和二尖瓣标注网络 ( AMD U-Net )  
左心室功能表征的一项重要指标就是其射血分数值 ( EF ) ，而射血分数的准确计
算比较依赖与左心尖与二尖瓣中心点这两点连线所表示的长轴维度 ( LAD ) ，根据辛普
森法计算左心室近似容积时需根据垂直该连线的切片做积分得到。故本文采用左心室
分割区域作为解码端1 的标签，左心尖和二尖瓣中心点(左心室和左心房交界处的中点)
为解码端2 的标签，该网络称为左心尖和二尖瓣位置标注的双解码端U-Net (Left apical 
and Mitral valve position annotated double decoding U-Net ,AMD U-Net) 网络.其标签示意
如图3.6所示。该标注方式旨在通过模型输出结果同时获得左心室的分割结果和左心尖
和二尖瓣中心点的位置信息，从而有利于之后的EF 值计算。 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page33_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page33_img1.jpeg)

## Page 34

基于U-Net 的超声左心室分析方法研究 
24 
3.3.1 数据集 
本文使用的超声心动图均来自声泰特(成都)科技有限公司。每个超声视频为一例
个体的超声心动图，一个视频包括多个心动周期。数据集来自9 个不同对象共15 组心
脏超声图片，每组心动图为包含多个心动周期的240 帧心超图，共计3600 张。其中，
2880张左心室图像用于模型的学习，另外180张图片用于验证，剩余540张用于测试。
图像原始分辨率为1430 768

，去除设备、时间等信息，裁剪后图片分辨率为918 768

。 
采用公开数据集 CAMUS 心脏分割数据集对模型效果进行验证。CAMUS 数据集[62]
来源于法国圣艾蒂安大学医院，其符合该医院伦理委员会的规定。CAMUS 数据集取
自500 名患者的超声心动检查，共含2000 张单幅图像。每名患者的超声检查都含有4
张图片：两张是心室收缩末期(end systolic, ES)的心尖四室视图(apical four-chamber view, 
A4C)和心尖二室视图(apical two-chamber view, A2C)；两张是心室舒张末期(end diastole, 
ED)的A4C 和A2C 视图。CAMUS 数据集共含有1000 张ES 图像和1000 张ED 图像。 
在数据预处理阶段，将两个数据集中分辨率不同的超声心动图尺寸缩放到512×
512，以满足神经网络输入的需要。 
3.3.2 试验配置 
本文使用tensorflow 实现网络结构，训练模型硬件平台为Tesla V100 服务器，GPU
型号为内存16GB 的 V100 ，梯度优化使用Adam 优化器，批大小设置为4，学习率设
置为0.0001，迭代次数为100 次。网络输入和标注如图3.6 所示。图3.6(a)为原始输入
图像，(b)为左心室带分割区域位置标注，(c)为左心尖与二尖瓣位置标注。 
 
 
 
 
 
 
 
 
(a)原始图像                   (b) 左心室带分割区域位置标注      (c) 左心尖与二尖瓣中心位置标注 
图3.6 网络训练数据集示意图 
Figure 3.6 Schematic diagram of data set 
 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page34_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page34_img1.jpeg)

## Page 35

第3 章 基于双解码端U-Net 的超声左心室分析 
25 
3.3.3 评价指标 
3.3.3.1 DICE 指数 
通过计算Dice 系数，我们可以评估分割结果与理论预测结果之间的差异，该系数
的具体表达式为式3-5，其中 A 代表预期分割结果的总像素点数， B 则指模型的预测
分割结果的总像素点数。分子代表着 A 和 B 两个元素的交叉点的数量，而分母则代表
着它们两个元素的总数。其值的范围为0 到1 之间。Dice 系数值越高，表明分割精度
越高。 
 
 
 
 
 
 
图3.7 Dice 指数示意图 
Figure 3.7 Dice Index schematic 
 
2
D
A
B
iec
A
B

=
+
                                                    (3-5) 
3.3.3.2 Hausdorff 距离指数 
豪斯多夫 ( Hausdorff ) 距离可以用来衡量两个数据集的差异性，它可以用来表示两
个数据集的近邻关系，从而反映两个数据集的差异性。是一种用来表示两个点集之间
距离的方法：假设存在两组数据点集合


1
2
,
,...,
p
A
a a
a
=
，


1
2
,
,...,
q
B
b b
b
=
 ,那么这两个
点集合之间的 Hausdorff 距离定义为： 
( , )
max( ( , ), ( , ))
H A B
h A B h B A
=
                                             (3-6) 
( ,
)
max(
)min(
)
h A B
a
A
b
B a
b
=


−
                                   (3-7) 
( ,
)
max(
)min(
)
h B A
b
B
a
A b
a
=


−
                                   (3-8) 
" Hausdorff “距离可以用来衡量两个数据集 A 与其对应数据集 B 的相对位置的偏
移量，其中，公式3-6 代表着两个数据集的相对位置的最大偏移量。Hausdorff 距离指
数越小，表明两集合差异越小，分割精度越高。 
 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page35_img1.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page35_img1.png)

## Page 36

基于U-Net 的超声左心室分析方法研究 
26 
3.3.3.3 MSE 指数 
MSE(Mean Squared Error)叫做均方误差。其公式如式3-9 所示： 
2
1
1
N
i
i
i
MSE
y
y
N

=
=
−

                                               (3-9) 
式中：N ——样本量；
iy

——算法预测值；
iy ——理论真实值。 
在本文中，MSE 分为MSE_A 和MSE_C，其中MSE_A 表示左心尖位置标注的准
确度，MSE_C 表示二尖瓣中心点位置标注的准确度。均方误差结果越小，表明两点分
割准确度越高。 
3.3.4 结果分析 
3.3.4.1 分割结果展示 
如图3.8 所示为一些成功分割左心室区域并准确标注左心尖和二尖瓣中心点的案
例。图中蓝色区域即为网络模型的预测分割结果，红色标点为网络预测的左心尖与二
尖瓣中心点位置。金色曲线则为手动勾勒的理论分割结果，紫色标点为人工确定的左
心尖与二尖瓣中心点位置。可以明显看出网络的左心室分割预测结果与手工勾勒的理
论结果相差甚小，表明了网络模型的分割效果较为理想。同时，网络预测的左心尖和
二尖瓣中心点的位置标注也可以看出均是在比较理想的位置处。表明了网络模型结果
优良。 
 
 
 
 
 
 
 
 
 
图3.8 成功分割及标注案例 
Figure 3.8 Successful segmentation and labeling cases 
 
如图3.9所示，是自采数据中未成功分割及标注的案例展示。展示图像分割区域严
重偏离理论分割结果，且左心尖和二尖瓣的标注结果也受到影响，极大偏离了期望位



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page36_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page36_img1.jpeg)

## Page 37

第3 章 基于双解码端U-Net 的超声左心室分析 
27 
置。推测影响分割及标注结果的原因在于左心室腔壁的大量缺失，造成了网络对该左
心室腔壁缺失处特征信息的提取学习不足，致预测效果不佳。 
 
 
 
 
 
 
 
 
 
图3.9 失败案例展示 
Figure 3.9 Failure Case Presentation 
设置手动补足缺失边界对比实验效果如图3.10 所示，两张图片为一组，图中共四
组初始图像和对应预测结果图像。图中按从左到右，从上到下的顺序，分别对左心室
图像缺失的边界逐步进行补全。左上角为没有任何人工添加边界的原始图像及其分割
结果，右下角为手动补充完整边界的图像及其分割结果。由分割结果可以看出，随着
左心室腔壁的逐渐完善，分割效果也呈显著好转。由此得出，本章所用网络至少需要
比较完整的左心室腔壁才能达到一个比较理想的结果。 
 
 
 
 
 
 
 
 
 
 
图3.10 手动补足边缘对比实验 
Figure 3.10 Manual supplement contrast experiment 
 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page37_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page37_img1.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page37_img2.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page37_img2.jpeg)

## Page 38

基于U-Net 的超声左心室分析方法研究 
28 
3.3.4.2 分割结果定量对比分析 
如表3.1所示，实验结果说明本章所提出的网络模型较好的完成了左心室的准确分
割以及LAD、Area 等量化指标的自动估测。左心尖和二尖瓣位置标注的双解码端U-
Net (AMD U-Net) 网络可直接得到LAD 长度，传统U-Net 和FCN-8s[58]的LAD 长度由
椭圆拟合估测求得。 
 
表3.1 左心室相关量化指标的MRE 
Table 3.1 MRE of left ventricular correlation quantification  
 
LAD(%) 
Area(%) 
U-Net 
9.48 ± 1.96 
11.67 ± 2.73 
FCN-8s 
11.67 ± 3.52 
13.21 ± 3.15 
AMD U-Net 
7.8 ± 1.13 
9.33 ± 2.03 
 
由表中数据对比可知，AMD U-Net 是使用由左心尖和二尖瓣中心点位置特征信息
对本章网络进行标注的模型，其长轴维度的估测结果的相对误差较传统U-Net 网络和
FCN-8s 网络分别降低了1.68%和3.87%；对面积的估测相对误差分别降低了2.34%和
3.89%。 
 
表3.2 左心室分割结果的量化指标对比 
Table 3.2 Comparison of quantitative indexes of left ventricular segmentation results 
 
Dice 
HD 
MSE_A 
MSE_C 
U-Net 
0.8333 
16.3 
7.85 
8.54 
FCN-8s 
0.8047 
18.9 
9.23 
10.14 
AMD U-Net 
0.8924 
12.9 
6.34 
7.25 
 
如表3.2 所示，超声心动图左心室分割以及左心尖及二尖瓣中心标注效果展示如
下，其与传统U-Net 以及FCN 网络模型分割效果对比可以得出，本章网络模型提高了
分割的精度。其中，AMD U-Net 相较于传统U-Net 以及FCN-8s 网络模型，其分割Dice
系数分别提高了5.91%和8.77%；HD 系数分别降低了3.4 和6。左心尖标注位置与理想
位置距离的方差相较于传统U-Net 以及FCN 网络模型分别降低了1.51 和2.89；二尖瓣
中心点的标注位置与理想位置距离的方差分别降低了1.29 和2.89。其中，传统U-Net
与FCN 网络模型对左心尖与二尖瓣的标注是另外通过网络训练得出的结果。同时，比


## Page 39

第3 章 基于双解码端U-Net 的超声左心室分析 
29 
较AMD U-Net 和传统U-Net 结果可以得出，左心尖与二尖瓣中心处位置的确定，反过
来对左心室的准确分割提供了一定的空间信息，起到了对左心室的定位效果，提高了
网络的分割效果。 
3.3.4.3 左心室EF 计算结果分析 
对于左心室EF 的计算分析，由图3.11所示一个心动图像序列为例，一组数据包含
了多个心动周期，因为一张单独的心脏超声图无法分辨属于收缩还是舒张末期，所以，
对所有连续的帧都做相同处理：左心室分割并进行相应后处理，再通过算法计算每帧
图面积，近似选出一串连续帧中面积最大时作为心脏舒张末期图像，连续帧中面积最
小时为心脏收缩末期图像。 
 
 
 
 
 
 
 
 
 
 
 
图3.11 一组连续帧的分割结果 
Figure 3.11 The segmentation result of a set of consecutive frames 
对于AMD U-Net输出结果，根据辛普森法计算近似容积，从而对该心动周期求EF
值，如图3.11 这组数据为例，其计算所得EF 值为65%，根据美国超声心动学会2015
年提出的标准EF 值范围[55]为男性52%-72%，女性54%-74%可知，该例EF 值在标准范
围内。对比自采数据集采用辛普森法计算得出的EF 值，其结果如表3.3 所示，单平面
辛普森法EF 值与金标准EF 值的相关系数𝑟= 0.9223，较 FNC-8s 网络的 0.8447 和传
统 U-Net 的0.8633 均有一定提高，能较为准确的得出其左心室EF 值，评估心脏功能，
表明AMD U-Net 网络的长轴直接量化结果要优于对左心室分割结果进行矩形拟合等后
处理所得到的长轴指标。 
 
 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page39_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page39_img1.jpeg)

## Page 40

基于U-Net 的超声左心室分析方法研究 
30 
表3.3 EF 值相关系数对比 
Table 3.3 Comparison of correlation coefficients of EF values 
 
r 
U-Net 
0.8633 
FCN-8s 
0.8447 
AMD U-Net 
0.9223 
3.3.4.4 CAMUS 数据集结果分析 
如图3.12 所示为CAMUS 数据集中一例A2C 图像经不同网络模型对超声心动图左
心室分割的效果与ground truth 的对比展示，其从左到右分别为ground truth，本章二尖
瓣标注的双解码端U-Net 网络 (AMD U-NET) 、传统U-Net 网络和FCN-8s 网络。由对
比效果可以看出，AMD U-NET 网络的分割效果最接近与ground truth，优于传统U-Net
网络和FCN-8s 网络。 
 
 
 
 
 
 
 
 
 
GT                         AMD U-Net                                U-Net                                  FCN-8s 
图3.12 分割效果对比 
Figure 3.12 Segmentation effect comparison 
如表3.4 所示，CAMUS 数据集在本节网络的分割结果量化指标，其中，AMD U-
Net 网络在该数据集上的Dice 系数高于对比网络，为0.8801；HD 指数小于对比网络，
为10.9；左心尖位置的均方误差为7.21，二尖瓣中心点的均方误差为6.33，均小于对
比网络。该结果符合前文所述AMD U-Net 的分割结果最佳。表明该网络模型具有较好
的泛化性和鲁棒性。 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page40_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page40_img1.jpeg)

## Page 41

第3 章 基于双解码端U-Net 的超声左心室分析 
31 
表3.4 左心室分割结果的量化指标对比 
Table 3.4 Comparison of quantitative indexes of left ventricular segmentation results 
 
Dice 
HD 
MSE_A 
MSE_C 
U-Net 
0.8253 
13.3 
9.55 
9.36 
FCN-8s 
0.8038 
15.9 
10.44 
11.53 
AMD U-Net 
0.8801 
10.9 
7.21 
6.33 
 
本节基于CAMUS 数据集计算得到的EF 值较金标准相关系数为0.9165，与自采数
据集0.9223 较为接近。表明了 AMD U-Net 网络模型左心室分割功能以及左心尖和二尖
瓣中心点定位分割功能在不同数据集之间均具有良好的鲁棒性和泛化性。 
3.4 左心室和右心房标注网络 ( CD U-Net)  
在实际临床应用中，为了更准确的测量心脏的各项相关指标，通常需要多视角心
脏图像联合分析。其中，左心室射血分数的定量表征通常需要对沿长轴维度的成对图
像进行分析，如A2C ( Apical two-chamber view, A2C ) 观图像和A4C ( Apical four-
chamber view, A4C ) 观图像这两种沿心脏中轴线相互垂直的解剖视角图像相结合，能够
采用双平面辛普森公式得到更准确的计算结果。故而针对上一节使用单一视角心动图
序列计算得到的EF 值仍有较大误差的问题，根据成对心尖观心脏超声图像采用双平面
辛普森法能更准确的计算得到左心室近似容积，从而得出更准确的EF 值。 
实际操作中，由于种种原因导致图像缺失或需要补充图像时，需要对已知图像腔
室结构进行判别，以辅助临床人员对特定腔室结构图像进行采集。本节同样采用左心
室分割区域作为解码端1 的标签，新采用左心室和右心房等腔室信息作为解码端2 标
签，称为左心室右心房等腔室范围标注的双解码端U-Net 网络 (Chamber annotated dual-
decoding U-Net , CD U-Net )，还可降低由于心脏超声图像复杂的腔室结构信息对分割
所造成的影响。如图3.13 所示，左心室和右心房位置处于类似中心对称，故在一张心
脏超声图像中，若左心室和右心房同时存在，即可表示此图像为A4C 观图像；反之，
即为A2C 观图像。 
 
 
 
 
 
 


## Page 42

基于U-Net 的超声左心室分析方法研究 
32 
 
 
 
 
 
 
 
 
 
图3.13 左心室和右心房位置示意图 
Figure 3.13 Schematic representation of the position of the left ventricle and right atrium 
3.4.1 数据集 
本文使用自采数据集进行网络训练和验证。再额外采用公开数据集CAMUS 心脏
分割数据集对模型效果进行验证。 
3.4.2 实验配置与流程 
3.4.2.1 网络配置与标签 
本文使用tensorflow 实现网络结构，训练模型硬件平台为Tesla V100 服务器，GPU
型号为 V100 ，梯度优化使用Adam 优化器，批大小设置为4，学习率设置为0.0001，
迭代次数为100 次。训练标注如图3.14 所示。其中，图a)和图d)分别表示心尖两腔观
(A2C)和心尖四腔观(A4C)下的原始图像。图b) 和图e)为心尖两腔观心动图下左心室区
域的标注和心尖四腔观下心动图左心室区域，是解码端1 ( Der1 ) 的标签。对两腔和四
腔图像同样采用图标注，如图3.14c)是对两腔观心动图进行标注，表示所选区域为左
心室，图f)则是对四腔观心动图的标注，即解码端2 ( Der2 ) 的标签，标签作用为对左
心室和右心房区域定位。 
 
 
 
 
 
 
 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page42_img1.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page42_img1.png)

## Page 43

第3 章 基于双解码端U-Net 的超声左心室分析 
33 
 
 
 
 
 
 
 
 
                                                          Input                     Der1                 Der2                               
图3.14 数据集标签标注示意图 
Figure 3.14 Data set label annotation schematic diagram 
3.4.2.2 两腔四腔判别后处理 
网络模型解码端2 输出的图像为几个分割区域，再经由一定后处理才能实现对两
腔四腔观图像的判别功能。后处理流程如图3.15 所示。 
 
 
 
图3.15 后处理算法流程图 
Figure 3.15 Flow chart of post-processing algorithm 
以图3.16 (a)作为输入图像为例，网络模型输出后的图像后处理流程如下所示。对
于深度神经网络模型，理想情况下，输入的是两腔图像，输出的两腔\四腔标志图应该
只有一个圆形高亮区域，如果输入的是四腔图像，理想输出应该是两个高亮区域。对
于例图3.16 (a)，其作为输入，输出的两腔\四腔判别标志图像如图3.16 (b)所示。两腔
四腔判别算法流程如下所示： 
① 通过resize 函数，将输出的图 3.16 (b) 两腔\四腔判别图放大为输入图像尺寸大
小。 
② 通过图像轮廓提取[56]得到图3.18 的轮廓线及其像素值。对例图3.16 (c)得到三
个轮廓线，其大小分别为47、536、719。 
③因为算法设计时标记两腔\四腔是通过一个白色圆，经过大量统计实验发现，能
标识腔体的高亮轮廓像素值都是大于400 的，所以对所有轮廓进行判断并计数轮廓大
小大于400 的个数more_than_400_cnt； 
④如果计数more_than_400_cnt>1，那么就说明输入图像轮廓像素值大于400 的有



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page43_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page43_img1.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page43_img2.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page43_img2.png)

## Page 44

基于U-Net 的超声左心室分析方法研究 
34 
两个区域，即表示该图像是四腔图像；否则就认为输入图像是两腔图像。 
 
 
 
 
 
 
(a)模型输入图像                         (b)解码端2 输出图像                     (c) 轮廓提取图像 
图3.16 两腔/四腔判别实例 
Figure 3.16 Two Chambers/four cavity discriminants 
3.4.2.3 左心室分割区域后处理 
例图3.17 左心室部分经由深度模型分割后输出的结果如图3.17 所示 
 
 
 
 
 
 
 
 
图3.17 模型输出左心室分割结果 
Figure 3.17 Left ventricular segmentation results output from the model 
由图3.17 可以看出，由于噪声和模型的原因，左心室分割图像中会存在真实左心
室区域小的多的干扰区域，其次分割区域存在一些不连续或凹凸部分，所以需要对分
割区域进行处理。其流程图如图3.18 所示。 
 
 
 
图3.18 左心室分割后处理算法流程图 
Figure 3.18 Flow chart of left ventricular segmentation post-processing algorithm 
 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page44_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page44_img1.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page44_img2.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page44_img2.png)

![基于U-Net的超声左心室分析方法研究_文鑫_page44_img3.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page44_img3.png)

![基于U-Net的超声左心室分析方法研究_文鑫_page44_img4.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page44_img4.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page44_img5.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page44_img5.png)

## Page 45

第3 章 基于双解码端U-Net 的超声左心室分析 
35 
具体流程如下所示： 
①输出的分割图像通过resize 函数放大到输入图像的大小。 
②根据图3.17 可以看出，除了真实左心室分区外，还有4 个干扰区域。所以首先
对图像进行轮廓提取，本例中一共得到5 个轮廓，它们的轮廓大小分别是26、55、41、
63、1279。从数据就可以看出，5 个轮廓中最大的轮廓对应真实的左心室分割区域，
其余4 个只是干扰； 
③选出5 个轮廓中最大的轮廓，这个轮廓就对应左心室分割区域，单独画出如图
3.19 (a) 所示。 
④因为心肌内膜附近噪声较多，所以分割图像会凹凸不平滑，所以通过凸包检测
计算轮廓的凸包，平滑的结果如图 3.19 (b) 所示，这样就得到了左心室的分割结果。 
⑤随后将左心室分割区域通过旋转卡壳算法[57]矩形拟合成矩形，得到如图3.19 (c)
所示的最小外接矩形，其外接矩形的长即近似于分割区域的左心室长轴维度，从而能
够估算得到左心室的面积指标。 
 
 
 
 
 
 
(a)分割区域图像                             (b)平滑图像                              (c) 矩形拟合图像 
图3.19 分割区域后处理 
Figure 3.19 Segmentation region post-processing 
3.4.3 评价指标 
采用Dice 系数和豪斯多夫（Hausdorff）距离衡量网络的左心室区域分割效果。对
于两腔\四腔判别效果，使用准确率对其进行评价。 
(
) /
Accuracy
TP TN
N
=
+
                                        (3-10) 
式中：TP——判断正确的四腔数量；TN ——判断正确的两腔数量；N ——样本总数 
3.4.4 结果分析 
3.4.4.1 分割结果 
如图3.20 所示为一例A2C 图像输入模型后的输出以及经过凸包检测平滑后的左心
室分割区域。图a)为手工标记的原始图像，图像上面的金色线条构成的为左心室的理



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page45_img1.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page45_img1.png)

![基于U-Net的超声左心室分析方法研究_文鑫_page45_img2.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page45_img2.png)

![基于U-Net的超声左心室分析方法研究_文鑫_page45_img3.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page45_img3.png)

## Page 46

基于U-Net 的超声左心室分析方法研究 
36 
论分割区域。图 b)为模型输出的分割结果，图b)经过凸包检测，其平滑多边形如图c)
所示。由此可见，本模型较好完成了左心室分割任务。 
 
 
 
 
 
 
   (a) 手工勾勒原始图像                   (b) 模型输出                                         (c) 平滑多边形           
图3.20 左心室分割案例 
Figure 3.20 Case of left ventricular segmentation 
如图3.21 所示为不同网络模型对超声心动图左心室分割效果与理想手工分割结果
的对比展示，其从左到右分别为输入的原始图像，本章二尖瓣标注的双解码端U-Net
网络 (AMD U-NET) 的输出结果、本章两腔四腔观标注的双解码端U-Net 网络 (CD U-
NET) 的输出结果、传统U-Net 网络的输出结果、FCN-8s 网络的输出结果和ground 
truth 。由对比效果可以看出，CD U-Net 网络的分割效果最接近与ground truth，优于
AMD U-NET、传统U-Net 网络和FCN-8s 网络。 
 
 
 
 
 
 
 
      原始图像          AMD U-Net             CD U-Net               U-Net                  FCN-8s                    GT 
图3.21 四种网络分割效果对比 
Figure 3.21 Comparison of three network segmentation effects 
3.4.4.2 分割结果定量指标对比分析 
如表3.5所示，实验结果说明本章所提出的网络模型较好的完成了左心室的准确分
割以及LAD、Area 等量化指标的自动估测。左心尖和二尖瓣位置标注的双解码端U-
Net (AMD U-Net) 网络可直接得到LAD 长度，左心室右心房等腔室范围标注的双解码
端U-Net 网络 (CD U-Net ) 的LAD 长度近似为矩形拟合后所得边长，传统U-Net 和



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page46_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page46_img1.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page46_img2.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page46_img2.png)

## Page 47

第3 章 基于双解码端U-Net 的超声左心室分析 
37 
FCN-8s[58]的LAD 长度由椭圆拟合估测求得。 
 
表3.5 左心室相关量化指标的MRE 
Table 3.5 MRE of left ventricular correlation quantification  
 
LAD(%) 
Area(%) 
U-Net 
9.48 ± 1.96 
11.67 ± 2.73 
FCN-8s 
11.67 ± 3.52 
13.21 ± 3.15 
AMD U-Net 
7.8 ± 1.13 
9.33 ± 2.03 
CD U-Net 
8.06 ± 1.33 
8.41 ± 1.81 
 
由表中数据对比可知，CD U-Net 对长轴维度的估测结果矩形近似拟合得到，估算
值偏大，其相对误差较传统U-Net 网络和FCN-8s 网络分别降低了1.42%和3.46%，但
相较于AMD U-Net 提高了0.26%；对面积的估测相对误差较传统U-Net 网络和FCN-8s
网络分别降低了3.26%和4.80%，较于AMD U-Net 降低了0.92%。 
如表3.6 所示，超声心动图左心室分割效果展示如下，其与传统U-Net 以及FCN
网络模型分割效果对比可以得出，本章网络模型提高了分割的精度。其中，CD U-Net
左心室分割精度较左心尖标注网络有所提高，其Dice 系数达到了90.91%，较AMD U-
Net、U-Net 和FCN-8s 分别提高了1.67%；HD 为10.3，分别降低了2.7、6.0 和8.6。结
果表明两腔/四腔分类信息对左心室的准确分割具有促进作用，有效提高了分割准确性。
该结果表明两腔/四腔分类信息的标注降低了心脏复杂结构信息对左心室分割效果的影
响，且较AMD U-Net 分割精度仍有一定提高，表明了两腔/四腔分类信息相较于左心
室左心尖和二尖瓣中心点空间位置信息对于超声心动图的准确分割更有帮助。 
 
表3.6 左心室分割结果的量化指标对比 
Table 3.6 Comparison of quantitative indexes of left ventricular segmentation results 
 
Dice 
HD 
U-Net 
0.8333 
16.3 
FCN-8s 
0.8047 
18.9 
AMD U-Net 
0.8924 
12.9 
CD U-Net 
0.9091 
10.3 
 


## Page 48

基于U-Net 的超声左心室分析方法研究 
38 
3.4.4.3 两腔\四腔判别结果分析 
如图3.22 所示，图像左侧分别为心尖两腔观(A2C)的输入图像和心尖四腔观(A4C)
的输入图像，右侧为模型输出的两腔\四腔判别标志图像。由右侧高亮图形数目可知模
型对左侧这两例超声心动图的判别效果很好。说明模型基本实现了对两腔\四腔进行准
确判别这一功能。 
 
 
 
 
 
 
 
 
图3.22 两腔\四腔判别成功案例 
Figure 3.22 Two \ four cavities distinguish successful cases 
如图3.23 展示的是几组判别失败案例。图3.23a)展示的是两组将两腔图像错误判
断为四腔图像的例子，由图像可以看出将左下角暗区错误判断为存在右心室。如图
3.23 b)展示的两组分别是将四腔识别为两腔和没有识别出来。上面这组两腔\四腔判别
标志图显示了两个较大轮廓，但由于右心室边缘缺失导致右心室标志轮廓大小只有
392 从而导致误判。而下面这组从轮廓线标志图可以得出第二组图像由于其严重的噪
声干扰而导致了误判。超声图像中心脏腔室的复杂结构影响了腔室判别功能的准确性。 
 
 
 
 
 
 
 
a)两腔判别失败案例                                              b)四腔判别失败案例 
图3.23 两腔\四腔判别失败案例 
Figure 3.23 Two\ four-cavity discriminant failure case 
 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page48_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page48_img1.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page48_img2.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page48_img2.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page48_img3.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page48_img3.jpeg)

## Page 49

第3 章 基于双解码端U-Net 的超声左心室分析 
39 
本节计算得到CD U-Net 网络对两腔\四腔判别的准确率如表3.7 所示，其中两腔\
四腔判别的总准确率约为83%左右，其中，两腔判别的准确率96%，但四腔判别准确
率仅为70%。因为A4C 图像心脏结构更复杂，其结构信息更易受到噪声等因素影响导
致误判。 
 
表3.7 两腔/四腔判别准确率 
Table 3.7 Two-chamber/four-chamber discrimination accuracy 
 
Accuracy 
总 
83% 
四腔 
70% 
两腔 
96% 
3.4.4.4 左心室EF 计算结果分析 
对于左心室EF 的计算分析，由一个同时包含A2C 和A4C 视角的成对超声心动图
数据的个体为例，一组数据包含了多个心动周期，因为一个单独的心脏超声图无法分
辨属于收缩还是舒张末期，所以，对所有连续的帧都做相同处理：左心室分割并进行
相应后处理，再通过算法计算每帧图面积，近似选出一串连续帧中面积最大时作为心
脏舒张末期图像，连续帧中面积最小时为心脏收缩末期图像。对于CD U-Net 输出结果，
根据双平面辛普森法求左心室该心动周期的EF 值，同样以图3.11所示个体为例，以该
个体的成对两组数据为例，其计算所得EF 值为64%，根据美国超声心动学会2015 年
提出的标准[55]可知，双平面辛普森法为准确参考标准，该例EF 值在标准范围内。 
表3.8 EF 值相关系数对比 
Table 3.8 Comparison of correlation coefficients of EF values 
 
r 
AMD U-Net 
0.9223 
CD U-Net 
0.9427 
 
表3.8 为CD U-Net 网络与AMD U-Net 网络计算EF 值与金标准相关系数对比，对
比自采数据集的单平面辛普森法以及双平面辛普森法计算得出的EF 值，双平面辛普森
法计算得出的EF 值与金标准EF 值的相关系数𝑟= 0.9427。CD U-Net 网络的误差较
AMD U-Net 网络降低了2%左右，表明成对图像的EF 值计算结果更为准确。 
 


## Page 50

基于U-Net 的超声左心室分析方法研究 
40 
3.4.4.5 CAMUS 数据集测试结果分析 
如图3.24 所示为 CAMUS 数据集中一例A2C 图像经不同网络模型对超声心动图左
心室分割的效果与 ground truth 的对比展示，其从左到右分别为 ground truth，本章二尖
瓣标注的双解码端U-Net 网络 (AMD U-NET) 、本章两腔/四腔观标注的双解码端U-Net
网络 (CD U-NET) 、传统U-Net 网络和FCN-8s 网络。由对比效果可以看出，CD U-Net
网络的分割效果最接近与ground truth，优于AMD U-NET、传统U-Net 网络和FCN-8s
网络。 
 
 
 
 
 
 
 
GT                    AMD U-Net                 CD U-Net                    U-Net                       FCN-8s 
图3.24 分割效果对比 
Figure 3.24 Segmentation effect comparison 
如表3.9 所示，CAMUS 数据集在本文网络的分割结果量化指标，其中，CD U-Net
网络在该数据集上的Dice 系数高于对比网络，为0.9024；HD 指数小于对比网络，为
8.7。该结果符合前文所述CD U-Net 的分割结果最佳。表明该网络模型的分割功能具
有良好的泛化性和鲁棒性。 
 
表3.9 左心室分割结果的量化指标对比 
Table 3.9 Comparison of quantitative indexes of left ventricular segmentation results 
 
Dice 
HD 
U-Net 
0.8253 
13.3 
FCN-8s 
0.8038 
15.9 
AMD U-Net 
0.8801 
10.9 
CD U-Net 
0.9024 
8.7 
 
本节基于 CAMUS 数据集计算得到CD U-Net 网络对两腔\四腔判别的准确率如表
3.10 所示，其中两腔\四腔判别的总准确率约为80%左右，其中，两腔判别的准确率



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page50_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page50_img1.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page50_img2.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page50_img2.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page50_img3.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page50_img3.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page50_img4.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page50_img4.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page50_img5.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page50_img5.jpeg)

## Page 51

第3 章 基于双解码端U-Net 的超声左心室分析 
41 
97%，四腔判别准确率约为63%。与自采数据集的结果相比，准确率更低，因为不同
数据集间由于采集设备的不同导致图像尺寸、图像质量、腔室位置等均存在差异，可
以得出CD U-Net 网络的两腔/四腔判别功能的泛化性和鲁棒性较差。 
表3.10 两腔/四腔判别准确率 
Table 3.10 Two-chamber/four-chamber discrimination accuracy 
 
Accuracy 
总 
80% 
四腔 
63% 
两腔 
97% 
 
CD U-Net 网络基于CAMUS 公开数据集的分割结果计算得到的EF 值较金标准的
相关系数𝑟= 0.9373，与自采数据集相似，也表明了网络分割功能的泛化性和鲁棒性。 
3.5 本章小结 
本章节主要介绍了包含两个解码端的改进U-Net 网络：分别通过1) 结合左心尖和
二尖瓣位置信息和左心室分割区域特征信息标签 ( AMD U-Net ) 和2) 结合两腔/四腔观
分类特征信息和左心室分割区域特征信息标签标注( CD U-Net )的双编码端U-Net 网络。
对传统U-Net 模型以及双解码端U-Net 模型进行了介绍，对左心室EF 值计算进行了一
定介绍。 
本章首先采用AMD U-Net 完成了对左心室的分割，以及对左心尖和二尖瓣的直接
准确标注。使得算法能够直接得到左心室长轴维度，从而较容易得到左心室面积以及
EF 值等相关量化指标。其次，针对单平面辛普森公式对左心室近似容积计算不准确的
问题，采用CD U-Net 完成了两腔\四腔超声心动图像的判别和左心室的分割工作，通
过对模型输出结果进行一系列后处理，达到了对心尖两腔和四腔观超声图像的自动判
别以及自动分割左心室和等功能，进而采用双平面辛普森法计算成对图像的左心室近
似容积，从而完成左心室射血分数的计算。 
实验结果表明，AMD U-Net 网络在长轴维度和面积等定量指标估算上其平均相对
误差分别为7.8%和9.33%，分别较传统U-Net 网络和FCN-8s 网络有一定程度的提高，
具体数值为长轴维度指标相对误差分别降低了17.7%和33%；面积指标的相对误差分
别降低了20%和29%。分割效果方面：AMD U-Net 较传统U-Net 网络和FCN-8s 网络
Dice 系数分别达到了0.8924，CD U-Net 网络Dice 系数达到了0.9091，由此可知，添加
有其他特征标注的网络均显著提高了左心室分割的准确性，且对心脏结构分类的信息
比左心尖二尖瓣等特征标注信息更能提高左心室分割的准确率。EF 值计算结果显示，


## Page 52

基于U-Net 的超声左心室分析方法研究 
42 
两种标注网络左心室EF 值的估测结果都在正常值范围内。两腔四腔判别结果：虽然模
型对两腔\四腔的判别准确率不高，总体分类准确率仅有83%，其中，两腔的判别正确
率达到96%，四腔的判别正确率仅有70%。基于CAMUS 数据集的测试结果指标与上
述变化趋势一致，该模型具有较好的泛化性和鲁棒性。本章算法一定程度上完成自动
判别心动图两腔四腔，辅助临床医生对指定切面结构的超声心动图进行采集，同时将
量化指标的计算整合在一个算法中，简化了临床诊断流程，具有一定的应用价值。 
本章实验结果还存在一些问题，由于超声成像的缺陷导致的超声心动图像的不完
整仍会严重影响算法的性能，且左心室和右心房的标注不太突出，导致根据轮廓点数
量判别两腔四腔的结果存在一定误差。针对这些问题，本文第四章将在该网络的基础
上，对该网络模型进行一定改进。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 


## Page 53

第4 章 基于改进双解码端U-Net 的超声左心室分析 
43 
第4 章 基于改进双解码端U-Net 的超声左心室分析 
4.1 引言 
在第三章中，提出了针对双解码端U-Net 网络，分别对二尖瓣位置进行标注和对
左心室右心房范围进行标注的两种不同的标签。二尖瓣标注网络较好的完成了左心室
的分割，并采用单平面辛普森法对EF 值进行了估测。但该特征标注的网络对超声心动
图的分割仍存一定问题：在心尖两腔/四腔观图像混杂情况下，对于不同腔室切面其心
脏结构信息对于左心室分割造成的影响不可忽略；其次，左心室EF 的计算较为粗糙，
没有考虑在心脏超声图像只有一个视角时容积计算不准确的问题。所以通过左心室右
心房位置标注网络来同时实现对心脏超声图像两腔\四腔的判别和左心室的分割，两腔\
四腔判别功能对医生的临床工作具有很高的辅助指导意义，同时采用双平面辛普森法
对左心室EF 值进行了估测。但上述网络在实现两腔\四腔判别方面受左心室和右心房
轮廓标记效果影响较大，受图像整体质量影响较大，同时受右心室和左心房等目标区
域之外的结构影响较大，如图4.1案例所示，轮廓图受腔室复杂结构影响出现多条轮廓
线。 
 
 
 
 
 
图4.1 腔室判别失败案例 
Figure 4.1 Failure cases of chamber discrimination 
本章在上一章节的网络结构基础上，引入稠密连接的Dense Net 结构对双解码端
U-Net 网络编码端进行改进，引入注意力机制对上一章双解码端U-Net 网络解码端2 进
行改进。实现对左心室和右心房区域更精确的分割，从而提高两腔/四腔判别的准确性，
辅助医生完成心脏超声指定A2C 或A4C 心动图像的采集，完成对左心室区域的分割以
及EF 值的计算，对临床工作具有一定的贡献价值。 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page53_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page53_img1.jpeg)

## Page 54

基于U-Net 的超声左心室分析方法研究 
44 
4.2 理论基础 
4.2.1  结合注意力机制的融合模块 
U-Net 网络针对下采样信息丢失的问题是采用跳层连接来解决的，将浅层的特征
信息与深层的特征信息融合后，作为上采样的特征图。该操作的优点在于操作简单，
同时可以弥补大量丢失信息，但网络结果仍有一些不足的地方：一方面，解码器无法
很好地利用编码端传递过来的浅层空间的特征信息；另一方面，引入的空间信息可能
会破坏原有的语义信息。因此，如何合理的利用深浅不同维度的信息，对提高网络分
割的精度具有重要的意义。在上一章，网络利用定位左心室和右心房来实现两腔四腔
的判别，其结果受到了右心房定位分割精度的极大影响。为了有效地应对这一挑战，
本章采用了一种结合了注意力机制的融合模块[59]，它将传统的模块融合技术和先进的
注意力机制有机结合在一起，从而实现了替换上一章上解码端U-Net 网络中的跳层连
接操作的目的。融合模块是作用是把不同的信息进行有效整合，它包含了两部分，分
别为通道注意力分支以及空间注意力分支，从而使得高低不同维度的特征信息能有效
地融合在一起。这一模块的具体融合过程如下图4.2 所示： 
 
 
 
 
 
 
 
 
 
图4.2 融合模块 
Figure 4.2 Fusion module 
图中，S 表示通道随机平分操作，C 表示通道连接操作，+ 表示元素相加操作，
CBR 表示
3 3
Conv 2D
BN+ReLU
+
操作。该融合模块用于替换上一章CD U-Net 网络模
型解码端2 用于判断左心室和右心房位置的级联操作模块。 
如图4.2 所示，通道的注意力分支是一个压缩激励模块[60]，该模块的功能在于能
够获取不同特征通道之间的关系信息。低维度的特征信息通过大小为1×1 的卷积层实
现跨域操作处理后，仍然包含大量没有价值的信息。因此，如果直接将其与高维度的
特征信息相融合，会出现破坏语义信息的情况。因此，本章通过引入通道注意力机制，



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page54_img1.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page54_img1.png)

## Page 55

第4 章 基于改进双解码端U-Net 的超声左心室分析 
45 
达到抑制没有价值的信息通道的目的。通道注意力的整体过程如下：1) 获取特征图的
所有通道信息，对其做全局平均池化处理，以得到当下该通道的全局特征信息，完成
对特征信息进行压缩的目的，2) 通过两个卷积核大小为 1×1 的卷积层操作，再由
ReLU 激活函数代替原网络结构中的全连接层，同时学习通道与通道之间的关系信息；
3) 将学习后得到的特征信息进行 Sigmoid 激活变换操作，得到的结果作为通道信息的
权重，以实现特征激励作用，以此来表现出左心室和右心房的信息。 
空间注意力分支的作用在于能够获取特征图空间上的关系信息，得到自身学习通
道上共享出来的空间权重参数信息，以此来突出表现出左心室和右心房的轮廓信息。
空间注意力分支能够通过对高低不同维度的特征图进行简单的加操作，来实现低维语
义信息与高维空间信息的融合，再结合引入的注意力机制，使得该解码端的关注重心
放在左心室和右心房的轮廓信息上面。整体的流程如下：1）将高低不同维度的特征元
素数据进行加操作；2）对相加后的特征信息，进行通道上的最大池化与平均池化操作；
3）将获取到的两个特征图进行通道连接，然后经过一个卷积内核的大小为 7×7 的卷
积层，由此得到了通道数为一的特征图；4）最后，将所得到的特征图信息进行
Sigmoid 激活变化，将结果作为高低维度信息融合后的空间信息的权重，由此就可以
达到更有效的特征信息融合。 
4.2.2 Dense Net 
该网络结构是由Hang 等人[61]于2016 年提出一种基于Res Net 改进的网络结构，它
将网络结构中的short path 进一步细化，得到了一种更加简洁的连接方式：在保证层之
间信息流动的最大化的前提下，当特征图大小一致时，将每一层与其它所有层相连接。
每一层都将之前的所有层的特征映射作为输入，再将自身的特征图传递给后面所有层，
已实现向前传播。如图4.3 所示。其结构与Res Net 对比可知，其它层传入该层的方式
并不是以求和的方式，而是将前几层的特征进行连接（concatenating）。因此，第L 层
具有l 个输入（前面所有层的连接组合）。它本身的特征图传递到所有后面的所有层。
所以，对于一个L 层的Dense Net 网络，它将包含有(
1) / 2
L L+
个连接，而不是像Res 
Net 网络具有L 个连接，由于其连接数量更多，可以达到更高的效率。由于其特有的连
接模式，称之为Dense Convolutional Network ( Dense Net )。 
 
 
 
 
 
 


## Page 56

基于U-Net 的超声左心室分析方法研究 
46 
 
 
 
 
 
 
 
 
 
 
图4.3 Dense Block 结构图示意 
Figure 4.3 Dense Block structure diagram 
如上图所示，
0x 是作为网络的输入，是Input。那么此时作为
1
H 的输入便是
0x ,下
一层
2
H 的输入就是
0x 和
1
H 的输出
1x ，以此类推可得Dense Net 的公式如式 (4-1)所示 


(
)
0
1
1
,
,
,
l
l
x
H
x x
x −
=

                                              (4-1) 
式中,

0
1
1
,
,
,
l
x
x
x −

表示的是模型第0 层到
1
l −层之间这前面所有各层输出的特征图(feature map)作
通道合并的 concatenation 操作。 
上图Dense Net 结构图中的
l
H 操作中包括有批规范化 (batch normalization) ，激活
函数 ReLU 和核大小为3×3 的卷积操作。Dense Net 这种密集连接的Block，看似复杂，
实则参数比传统网络参数更少。因为网络训练不需要重新学习多余的特征图信息。通
过使用神经网络，我们发现层与层之间的关系是非常重要的。层的状态（state）是通
过相互交换来确定的，而且这些状态还能够被持续地记录和更新。提出的 Dense Net 网
络结构使得要传递到下一层网络的信息和要保存的信息存在一定差别。Dense Net 的网
络架构非常紧凑，每一层都拥有12 个卷积核，每一层都能够提取出大量的特征，而这
些特征可以被用于多种用途，比如模型建立、模型优化、模型扩展等，这些都可以被
用于多种用途的数学模型，从而实现多种用途的数学模型。 
Dense Net 的独特优越性在于，它不仅拥有较低的参数数量，而且还能够有效地促
进数据的交互，从而大大简化模型的训练学习过程。此外，它还能够将损失函数的结
果、模型的特征、模型的性能等等实时传递，有效地实现对模型的实时监控。通过采
取密集的连接结构，可以显著加快网络训练的速率，而且，这种方式还可以减少由于
较少的数据量而导致的模型失真。 
由于引入了结合注意力机制的融合模块，故而再将上一章双解码端U-Net 网络的
下采样特征提取部分替换为采用稠密链接的Dense Net 网络中的Dense Block 模块，其



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page56_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page56_img1.jpeg)

## Page 57

第4 章 基于改进双解码端U-Net 的超声左心室分析 
47 
通道信息融合更为优秀，且参数量更少，训练速率更快。由于在Dense Block 结构中，
后面几层的通道是由前面所有层作通道连接得到的，导致后面几层的通道特别多。因
此，每个Dense Block 中的3×3 卷积层前都会添加一个大小为1×1 的卷积层，以便将
原本的通道信息进行降维并进行融合。这样可以减少U-Net 的复杂性，从而提高模型
的效率。在本节中，对上一章双编码端U-Net 的改进：我们将 DenseNet-121 的
classification layer 取消，并使用一个大小为 1×1 的卷积操作来代替它。这样，我们就
能得到输出大小为 32×32 的特征图，特征图的个数达到了输入通道数目的一半。这样，
我们就完成了对双解码端U-Net 网络的编码端部分的改进。 
表4.1 编码器改进结构 
Table 4.1 The encoder improves the structure 
层名称 
输出尺寸 
DenseNet-121(k=32) 
卷积层 
512×512 
7×7 卷积，步长为2 
池化层 
256×256 
池化，步长为2 
DenseBlock 1 
256×256 
[1 × 1 卷积
3 × 3 卷积
] × 6 
Transition Layer 1 
256×256 
1 × 1 卷积 
128×128 
池化，步长为2 
DenseBlock 2 
128×128 
[
1 × 1 卷积
3 × 3 卷积
] × 12 
Transition Layer 2 
128×128 
1 × 1 卷积 
64×64 
池化，步长为2 
DenseBlock 3 
64×64 
[
1 × 1 卷积
3 × 3 卷积
] × 24 
Transition Layer 3 
64×64 
1 × 1 卷积 
32×32 
池化，步长为2 
DenseBlock 4 
32×32 
[
1 × 1 卷积
3 × 3 卷积
] × 16 
编码器最后一层 
32×32 
1 × 1 卷积，通道数512 
4.2.3 本章网络结构 
整体结合Dense Block 模块和注意力融合模块的改进网络如图4.4 所示。引入结合
注意力机制的融合模块对实现左心室和右心室定位以及轮廓检测的解码端进行改进，
如图4.4 解码端2 红色部分。 


## Page 58

基于U-Net 的超声左心室分析方法研究 
48 
 
 
 
 
 
 
 
 
 
图4.4 本章改进的网络结构 
Figure 4.4 Improved network structure in this chapter 
4.3 实验设置与材料 
4.3.1 数据集 
本文使用的超声心动图均来自声泰特(成都)科技有限公司,自采数据集用于网络训
练和验证。额外采用公开数据集CAMUS 心脏分割数据集对模型效果进行验证。 
4.3.2 实验配置 
本文使用tensorflow 实现网络结构，训练模型硬件平台为Tesla V100 服务器，GPU
型号为 V100 ，梯度优化使用Adam 优化器，批大小设置为4，学习率设置为0.0001，
迭代次数为100 次。训练标注如图4.5 所示。其中，图a)和图d)分别表示心尖两腔观
(A2C)和心尖四腔观(A4C)下的原始图像。图b) 和图e)为心尖两腔观心动图下左心室区
域的标注和心尖四腔观下心动图左心室区域。对两腔和四腔图像同样采用图标注，由
图3.13 所示，左心室和右心房处于中心对称位置，当左心室和右心房同时存在于图像
中时，表示该图像为四腔观 (A4C) 图像，故而如图4.5 c)是对两腔观心动图进行标注，
表示所选区域为左心室，图f)则是对四腔观心动图的标注，所标注区域为左心室与右
心房，表示此时图像显示的心脏结构为四腔。 
 
 
 
 
 
 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page58_img1.png](images/基于U-Net的超声左心室分析方法研究_文鑫_page58_img1.png)

## Page 59

第4 章 基于改进双解码端U-Net 的超声左心室分析 
49 
 
 
 
 
 
 
 
 
图4.5 数据集标签标注示意图 
Figure 4.5 Data set label annotation schematic diagram 
4.3.3 评价指标 
通过Dice 系数和豪斯多夫（Hausdorff）距离表征分割效果。采用准确率 
(Accuracy) 对两腔四腔判别功能进行评价。 
4.4 实验结果与分析 
4.4.1 网络输出结果 
如图4.6 所示为本章引入Dense Block 模块和结合注意力机制的融合模块的双解码
端U-Net 网络的输出结果，从左到右分别为原始图像，左心室分割结果，左心室和右
心房标注结果。表明网络较顺利完成分割任务。 
 
 
 
 
 
 
 
 
图4.6 改进双解码端U-Net 网络输入输出结果 
Figure 4.6 Improved Dual Decoder U-Net Network Input and Output Results 
 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page59_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page59_img1.jpeg)

![基于U-Net的超声左心室分析方法研究_文鑫_page59_img2.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page59_img2.jpeg)

## Page 60

基于U-Net 的超声左心室分析方法研究 
50 
4.4.2 消融实验结果 
4.4.2.1 分割效果对比结果 
 
 
 
 
 
 
Input                     GT               CD-U-Net         E- CD U-Net      A-CD U-Net      EA U-Net 
图4.7 模型分割结果 
Figure 4.7 segmentation result 
如图4.7 所示分别为A2C 和A4C 图像在上述网络的分割结果。由图可以看出，改
进模型均能较好的完成左心室轮廓检测。 
表4.2 所示分别为CD U-Net 网络，只改进编码端的CD U-NET 网络(记为E-CD U-
Net) ，只在解码端2 引入基于注意力机制的融合模块的改进CD U-Net 网络 (记为 A-CD 
U-Net)，两模块均进行改进了的CD U-Net 网络 (记为 EA U-Net) 的Dice 系数以及HD
距离指数。 
由表可知，E-CD U-Net 的Dice 系数达到了0.9146，较上章CD U-NET 网络提高了
0.53%，HD距离指数降低了0.8，说明稠密链接的编码端结构提高了特征信息的提取效
果，一定程度上提高了分割精度。A-CD U-Net 的Dice 系数达到了0.9115，较上一章
CD U-NET 网络提高了0.24%，HD 距离指数降低了0.6，说明应用于左心室和右心房位
置判断的融合模块对网络左心室分割精度有一定提升，但效果不太明显。EA U-Net 的
Dice 系数达到了0.9203，较上章CD U-NET 网络提高了1.12%，HD 距离指数降低了
1.2，说明两种对网络结构的改进相结合时，分割精度提高效果最佳。 
表4.2 左心室分割结果的量化指标对比 
Table 4.2 Comparison of quantitative indexes of left ventricular segmentation results 
 
Dice 
HD 
CD U-Net 
0.9091 
10.3 
E- CD U-Net 
0.9144 
9.5 
A-CD U-Net 
0.9115 
9.7 
EA U-Net 
0.9203 
9.1 



### 图片

![基于U-Net的超声左心室分析方法研究_文鑫_page60_img1.jpeg](images/基于U-Net的超声左心室分析方法研究_文鑫_page60_img1.jpeg)

## Page 61

第4 章 基于改进双解码端U-Net 的超声左心室分析 
51 
4.4.2.2 两腔四腔判别效果对比 
如表4.3 所示分别为上述网络的两腔四腔判别准确率结果，E-CD U-Net 网络的两
腔四腔判别准确率达到了87%，说明只改进编码端即可使得两腔四腔准确判别功能取
得较大进步，因为特征信息提取效果的提高，使得左心室和右心房轮廓的寻找更为准
确。A-CD U-Net 的两腔四腔判别准确率达到了90%，说明注意力机制的引入使得左心
室和右心房的轮廓寻找更为准确，加重了网络对左心室和右心房区域的注意力，从而
提高了准确性。EA U-Net 的两腔四腔判别准确率达到了92%，说明网络的改进大大提
高了判别功能的准确性，达到了改进网络的目标。 
 
表4.3 两腔四腔判别准确率对比 
Table 4.3 Comparison of discrimination accuracy between two cavities and four cavities 
 
Accuracy  
CD U-Net 
83% 
E- CD U-Net 
87% 
A-CD U-Net 
90% 
EA U-Net 
92% 
 
4.4.2.3 EF 值计算对比 
针对一例包含两腔四腔图像的具体个体为例，采用双平面辛普森法对两组相对应
一组连续帧进行EF 值的计算，其各网络计算结果以及与金标准的相关系数r 如表4.4
所示。结果表明改进网络的定量分析结果表现较原始网络更为突出。 
 
表4.4 EF 值对比 
Table 4.4 EF value comparison 
 
r  
CD U-Net 
0.9423 
E- CD U-Net 
0.9531 
A-CD U-Net 
0.9427 
EA U-Net 
0.9563 
 


## Page 62

基于U-Net 的超声左心室分析方法研究 
52 
4.4.3 CAMUS 公开数据集测试结果 
如下表4.5 所示分别为CAMUS 公开数据集在CD U-Net 网络、 E-CD U-Net 网络、 
A-CD U-Net 网络以及 EA U-Net 网络的Dice 系数以及HD 距离指数。 
 
表4.5 左心室分割结果的量化指标对比 
Table 4.5 Comparison of quantitative indexes of left ventricular segmentation results 
 
Dice 
HD 
CD U-Net 
0.9024 
8.7 
E- CD U-Net 
0.9223 
8.2 
A-CD U-Net 
0.9107 
8.0 
EA U-Net 
0.9313 
6.7 
 
由表可知，E-CD U-Net 的Dice 达到了0.9223，较上章CD U-NET 网络提高了
1.99%，HD距离降低了0.5，说明稠密链接的编码端提高了特征信息的提取效果，提高
了一定的分割精度。A-CD U-Net 的Dice 达到了0.9107，较上章CD U-NET 网络提高了
0.83%，HD距离降低了0.7，说明应用于左心室和右心房位置判断的融合模块对网络左
心室分割精度有一定提升，但效果不太明显。EA U-Net 的Dice 达到了0.9313，较上章
CD U-NET 网络提高了2.89%，HD 距离降低了2.0，说明对网络结构的改进达到了效
果，且具有一定的可迁移性。 
表4.6 所示为CAMUS 公开数据集在上述改进模型上的两腔/四腔判别精度。如表
所示，E-CD U-Net 网络的两腔/四腔判别准确率达到了83%，说明只改进编码端即可使
得两腔/四腔准确判别功能取得较大进步，因为特征信息提取效果的提高，使得左心室
和右心房轮廓的寻找更为准确。A-CD U-Net 的两腔/四腔判别准确率达到了87%，说
明注意力机制的引入使得左心室和右心房的轮廓寻找更为准确，加重了网络对左心室
和右心房区域的注意力，从而提高了准确性。EA U-Net 的两腔/四腔判别准确率达到了
94%，说明网络的改进大大提高了判别功能的准确性，达到了改进网络的目标，且注
意力机制的引入提高了判别功能的可迁移性。 
 
 
 
 


## Page 63

第4 章 基于改进双解码端U-Net 的超声左心室分析 
53 
表4.6 两腔四腔判别准确率对比 
Table 4.6 Comparison of discrimination accuracy between two cavities and four cavities 
 
Accuracy  
CD U-Net 
80% 
E- CD U-Net 
83% 
A-CD U-Net 
87% 
EA U-Net 
94% 
 
由于CAMUS 公开数据集每个病例超声检查都含有4 张图片：两张是心室收缩末
期(end systolic, ES)的心尖四室视图(apical four-chamber view, A4C)和心尖二室视图
(apical two-chamber view, A2C)；两张是心室舒张末期(end diastole, ED)的A4C 和A2C
视图。故不用再从序列图像中进行收缩和舒张末期图像的选取，根据双平面辛普森法
计算得到的EF 值与金标准的误差为5.6%，与第三章网络的6%相比降低了0.4%，提
升效果不明显。 
4.5 本章小结 
本章主要介绍了利用Dense Net 的Dense Block 模块和引入注意力机制的融合模块
结合的改进U-Net 网络。首先介绍了注意力机制融合模块的具体流程及方法，其次对
Dense Net 网络进行了介绍，重点介绍了Dense Block 模块结构以及如何对编码端进行
改进。以期完成对超声心动图像的更准确的两腔/四腔判别功能以及对左心室更精确的
分割工作。 
本章实验部分采用消融实验机制对改进模块效果进行验证。实验网络分别为：只
采用Dense Block 模块改进编码端的E-CD U-Net 网络；只在解码端2 引入注意力机制
融合模块的A-CD U-Net 网络；编码端与解码端2 均进行改进的EA U-Net 网络。 
实验结果表明，均改进的EA U-Net 网络的改进效果最好，但两改进模块的效果侧重不
同。其中，两种模块的单独改进均能提高分割的精度，E-CD U-Net 网络的Dice 系数达
到了0.9144，A-CD U-Net 网络的Dice 系数达到了0.9115，与CD U-Net 网络的0.9091
相比均有一定程度的提高，两种模块均改进的EA U-Net 网络效果最好，其Dice 系数达
到了0.9203。EF 值计算结果显示：E-CD U-Net 网络的相关系数为0.9531，与EA U-Net
网络的0.9563 较为接近，均明显高于CD U-Net 网络的0.9423，表明编码端的改进更能
提高网络的分割精度。两腔/四腔判别功能方面：A-CD U-Net 网络的准确率提高到了
90%，E-CD U-Net 网络的准确率提高到了87%，EA U-Net 网络的准确率提高到了92%，
较CD U-Net 网络的83%均有一定程度的提高，但注意力机制额引入显著提高了两腔/


## Page 64

基于U-Net 的超声左心室分析方法研究 
54 
四腔判别的准确率，表明了模型改进的有效性。基于CAMUS 数据集的测试结果指标
与上述变化趋势一致，表明了EA U-Net 网络具有良好的泛化性和鲁棒性。 
本章算法一定程度上以较高精度完成了心动图两腔/四腔的自动判别以及左心室分
割，辅助临床医生对指定切面结构的超声心动图进行采集，将量化指标的计算整合在
一个算法中，简化了临床诊断流程，降低了工作量，提高临床诊断结果的客观性和可
重复性，具有一定的应用价值。 
 
 
 
 
 
 
 
 


## Page 65

第5 章 结论与展望 
55 
第5 章 结论与展望 
5.1 本文工作总结 
心血管疾病的发病率和死亡率愈来愈高，并越来越趋向于年轻化，所以准确诊断
心脏功能十分关键。超声心动图是心脏功能诊断的重要手段，但目前超声诊断的计算
机辅助手段大多是对超声图像进行分割然后由临床医生手动进行定性和定量分析。针
对超声心动图左心室的准确分割和EF 的计算，本文针对Snake 及其改进模型在不同数
据集表现的不稳定性，提出了分别由包含左心尖与二尖瓣中心点位置的空间信息和两
腔四腔分类的结构信息进行特征标注的改进U-Net 网络，以此对超声心动图进行定性
和定量分析，其次对网络结构进行改进，提高了其功能的准确性。具体成果如下： 
(1) 本文验证了一些 Snake 及其改进模型在本文数据集上的表现，传统模型均需要
人工设置参数，对影像的先验信息依赖程度高，总结了传统方法在左心室分割工作表
现上的局限性。 
(2) 本文提出了结合左心尖和二尖瓣中心点位置特征信息左心室分割区域特征信息
作为标签进行标注的改进U-Net 网络算法 ( AMD U-Net )。该算法通过对左心尖和二尖
瓣中心点的标注，直接得到了左心室分割区域的长轴维度信息，从而通过长轴维度信
息与分割区域面积信息对左心室超声图像进行直接量化分析。经过实验表明，本算法
对左心室量化指标的直接计算具有良好的精度，长轴维度和面积平均相对误差分别为
7.8%和9.33%。已达到了一个比较好的结果。对于临床医生的诊断具有重大参考意义。 
(3) 本文提出了结合两腔\四腔分类的特征信息和左心室分割区域特征信息作为标
签进行标注的改进U-Net 网络算法 ( CD U-Net ) 。该算法对心动图两腔\四腔分类的同
时对左心室进行分割。且两腔\四腔分类信息的标注进一步提高了左心室分割的准确性。
另外，该算法网络输出结果作为输入，进行了一系列后处理对左心室面积、EF 等指标
进行计算。实验结果表明，两腔\四腔的判别虽然效果不佳，其准确率仅有83%左右，
但左心室分割的Dice 系数达到了90.91%。相较于AMD U-Net 网络分割准确度提高了
1.67%，且EF 值计算更为准确，误差较AMD U-Net 网络降低了2%，仅为6%。表明
对于结构复杂的心脏来说，两腔\四腔结构信息相较于左心尖和二尖瓣中心点位置的空
间信息对左心室的准确分割更为重要。 
(4) 本文通过引入Dense Block 模块和基于注意力机制的融合模块，提高了网络的
两腔/四腔判别准确性，判别准确率提高到了92%，提高了一定的左心室分割精度，其
Dice 系数达到了0.9203，EF 值误差仅为4~5%。 
简而言之，本文首先通过两种不同特征标注的双解码端U-Net 网络解决了超声心


## Page 66

基于U-Net 的超声左心室分析方法研究 
56 
动图左心室准确分割和EF 值的准确估算问题，其次通过对双解码端U-Net 网络进行一
定改进，提高了网络分割和判别精度。目前关于超声左心室直接量化分析的研究还较
少，因此本文的工作对这一领域作了补充参考。本文提出的方法能够直接给出一个可
参考的EF 估算结果，且两腔/四腔判别功能辅助临床医生采取指定截面超声图像，进
行诊断，以获得更准确、更客观、可重复的诊断结果，在临床诊断上具有重要应用价
值。 
5.2 未来工作展望 
左心室的准确分割是超声心动图量化分析的重要前提，本文通过双解码端U-Net
及其改进网络对超声心动图的左心室容积进行计算从而对左心室EF 值进行定量分析。
虽然已经达到一定的准确率，但仍有部分工作尚未完善，未来可以从以下几个方面进
行进一步的研究： 
(1) 本文网络的参数量均较大，训练时间也较长，后续可对网络的轻量化方面进行
相应研究。 
(2) 本文网络均是对二维心脏图像连续帧的平面分析，在计算左心室EF 值时对其
容积的计算仍会存在一定的误差，后续可考虑对左心室三维图像的重组，以便更准确
的计算其EF 值。 
(3) 本文研究工作根据轮廓线的像素点数量对两腔/行判别，较依赖所采集心脏图
像的边缘完整性，整体方法仍较为粗糙，未来可采取更为独立的两腔/腔分类特征标注
或对解码端的结构进行改进，以提高两腔\四腔判别的准确率。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 


## Page 67

参考文献 
 
57 
参考文献 
[1] 《中国心血管健康与疾病报告》编写组.《中国心血管健康与疾病报告2020》概述[J].中国心血
管病研究,2021,19(7):582-590. DOI:10.3969/j.issn.1672-5301.2021.07.002. 
[2] 国家卫生健康委员会. 中国卫生健康统计年检2019[M]. 北京：中国协和医科大学出版社,2019. 
[3] Lang. Recommendations for Cardiac Chamber Quantification by Echocardiography in Adults: An Update 
from the American Society of Echocardiography and the European Association of Cardiovascular 
Imaging (vol 28, pg 1, 2015)[J]. Journal of the American Society of Echocardiography: official 
publication of the American Society of Echocardiography, 2016, 29(3):276-276. 
[4] Noble J A ,  Boukerroui D . Ultrasound image segmentation: A survey[J]. IEEE Transactions on Medical 
Imaging, 2006, 25(8):987-1010. 
[5] Schiller N B ,  Shah P M ,  Crawford M , et al. Recommendations for quantitation of the left ventricle by 
two-dimensional echocardiography. American Society of Echocardiography Committee on Standards, 
Subcommittee on Quantitation of Two-Dimensional Echocardiograms[J]. Journal of the American 
Society of Echocardiography : official publication of the American Society of Echocardiography, 1989, 
2.  
[6] Dantas R G ,  Costa E T ,  Leeman S . Ultrasound speckle and equivalent scatterers[J]. Ultrasonics, 2005, 
43(6):405-420. 
[7] Aldrich, John E . Basic physics of ultrasound imaging. [J]. Critical Care Medicine, 2007, 35(Suppl):131-
7. 
[8] Szabo T L. Diagnostic ultrasound imaging: inside out[M]. ACDemic Press, 2004:3-5. 
[9] Leighton T G . What is ultrasound?[J]. Progress in Biophysics & Molecular Biology, 2007, 93(1-3):3-83. 
[10] 葛荣骏.基于深度学习的成对心尖观超声图像序列左心室分析[D].东南大学, 
2020.DOI:10.27014/d.cnki.gdnau.2020.002866 
[11] Otsu N . A Threshold Selection Method from Gray - Scale Histograms[J]. IEEE Trans.on SMC, 1979, 
9. 
[12] Kaur E N ,  Kaur E R . A review on various methods of image thresholding[J]. International Journal on 
Computer Science & Engineering, 2011, 3(10). 
[13] Kass M . snake Active contour models[J]. Proc.first Intl Conf.computer Vision, 1988, 4. 
[14] Mishra A ,  Dutta P K ,  Ghosh M K . A GA based approach for boundary detection of left ventricle with 
echocardiographic image sequences[J]. Image & Vision Computing, 2003, 21(11):967-976. 
[15] Ning L ,  Yu W ,  Duncan J S . Combinative multi-scale level set framework for echocardiographic image 
segmentation[J]. Medical Image Analysis, 2003, 7(4):529-537. 
[16] Boukerroui D ,  Baskurt A ,  Noble J A , et al. Segmentation of ultrasound images––multiresolution 2D 
and 3D algorithm based on global and local statistics[J]. Pattern Recognition Letters, 2003, 24(4/5):779-
790. 
[17] Belaid A ,  Boukerroui D ,  Maingourd Y , et al. Phase Based Level Set Segmentation of Ultrasound 
Images[C]// Information Technology and Applications in Biomedicine, 2009. ITAB 2009. 9th 
International Conference on. 2009. 
[18] Chen Y ,  Tagare H D ,  Thiruvenkadam S , et al. Using Prior Shapes in Geometric Active Contours in a 


## Page 68

基于U-Net 的超声左心室分析方法研究 
58 
Variational Framework[J].  2002. 
[19] Leventon M E ,  Grimson W ,  Faugeras O . Statistical shape influence in geodesic active contours[C]// 
Biomedical Imaging, 2002. 5th IEEE EMBS International Summer School on. IEEE, 2002. 
[20] Chen Y, Huang F, Tagare H D, et al. A coupled minimization problem for medical image segmentation 
with priors [J]. International Journal of Computer Vision, 2007, 71(3): 259-272. 
[21] Xiao G ,  Brady M ,  Noble J A , et al. Segmentation of ultrasound B-mode images with intensity 
inhomogeneity correction.[J]. IEEE Transactions on Medical Imaging, 2002, 21(1):48-57. 
[22] Chen H ,  Zheng Y ,  Park J H , et al. Iterative Multi-domain Regularized Deep Learning for Anatomical 
Structure Detection and Segmentation from Ultrasound Images[J]. Springer, Cham, 2016. 
[23] Moradi S ,  Alizadehasl A ,  Dhooge J , et al. MFP-Unet: A Novel Deep Learning Based Approach for 
Left Ventricle Segmentation in Echocardiography[J].  2019. 
[24] Fei L ,  Kwab C ,  Dan L D , et al. Deep pyramid local attention neural network for cardiac structure 
segmentation in two-dimensional echocardiography[J]. Medical Image Analysis, 2020, 67. 
[25] Hamila O ,  Ramanna S ,  Henry C J , et al. Fully Automated 2D and 3D Convolutional Neural Networks 
Pipeline for Video Segmentation and Myocardial Infarction Detection in Echocardiography[J].  2021. 
[26] Krishnaswamy D ,  Hareendranathan A R ,  Suwatanaviroj T , et al. A New Semi-Automated Algorithm 
for Volumetric Segmentation of the Left Ventricle in Temporal 3D Echocardiography Sequences[J].  
2021. 
[27] Xu L, Liu M, Shen Z, et al. DW-Net: A casCDed convolutional neural network for apical four-chamber 
view segmentation in fetal echocardiography[J]. Computerized Medical Imaging and Graphics, 2020, 
80: 101690. 
[28] Dong S ,  Luo G ,  Wang K , et al. A Combined Fully Convolutional Networks and Deformable Model 
for Automatic Left Ventricle Segmentation Based on 3D Echocardiography[J]. BioMed Research 
International, 2018, 2018:1-16. 
[29] Degel M A ,  Navab N ,  Albarqouni S . Domain and Geometry Agnostic CNNs for Left Atrium 
Segmentation in 3D Ultrasound[J].  2018. 
[30] F  Milletari,  Navab N ,  AhAMDi S A . V-Net: Fully Convolutional Neural Networks for Volumetric 
Medical Image Segmentation[J]. IEEE, 2016. 
[31] PurangAbolmaesumi, TerasaTsang, KenGin, et al. Echocardiography Segmentation by Quality 
Translation Using Anatomically Constrained CycleGAN[M].  2019. 
[32] Veni G ,  Moradi M ,  Bulu H , et al. Echocardiography segmentation based on a shape-guided 
deformable model driven by a fully convolutional network prior[C]// 2018:898-902. 
[33] Yujin, Libao, Guo, et al. Fully Automatic Pediatric Echocardiography Segmentation Using Deep 
Convolutional Networks Based on BiSeNet.[C]// 2019 41st Annual International Conference of the 
IEEE Engineering in Medicine & Biology Society (EMBC). IEEE, 2019:6561-6564. 
[34] Dong S ,  Luo G ,  Tam C , et al. Deep Atlas Network for Efficient 3D Left Ventricle Segmentation on 
Echocardiography[J]. Medical Image Analysis, 2020, 61:101638-. 
[35] Hansegard J ,  Urheim S ,  Lunde K , et al. Constrained Active Appearance Models for Segmentation of 
Triplane Echocardiograms[J]. IEEE Transactions on Medical Imaging, 2007, 26(10):1391. 
[36] Allan G ,  Nouranian S ,  Tsang T , et al. Simultaneous Analysis of 2D Echo Views for Left Atrial 
Segmentation and Disease Detection[J]. IEEE Transactions on Medical Imaging, 2016, 36(1):40-50. 
[37] Zi Y,Jaya Y K,Fengyan S, et al. Bi-DCNet: Bilateral Network with Dilated Convolutions for Left 
Ventricle Segmentation.[J]. Life (Basel, Switzerland),2023,13(4). 


## Page 69

参考文献 
 
59 
[38] Wanjun Z,Xiaohua D,Yang L, et al. Slide deep reinforcement learning networks: Application for left 
ventricle segmentation[J]. Pattern Recognition,2023,141. 
[39] Afshin M ,  Ayed I B ,  Islam A , et al. Global assessment of cardiac function using image statistics in 
MRI.[C]// International Conference on Medical Image Computing & Computer-assisted Intervention. 
Med Image Comput Comput Assist Interv, 2012.  
[40] Wang Z ,  Salah M B ,  Gu B , et al. Direct Estimation of Cardiac Biventricular Volumes With an Adapted 
Bayesian Formulation[J]. IEEE Transactions on Biomedical Engineering, 2014, 61(4):1251-1260. 
[41] Zhen X ,  Wang Z ,  Islam A , et al. Direct Estimation of Cardiac Bi-ventricular Volumes with Regression 
Forests[C]// International Conference on Medical Image Computing & Computer-assisted Intervention. 
Springer International Publishing, 2014. 
[42] Zhen X ,  Islam A ,  Bhaduri M , et al. Direct and Simultaneous Four-Chamber Volume Estimation by 
Multi-Output Regression[C]// International Conference on Medical Image Computing & Computer-
assisted Intervention-miccai. Springer-Verlag New York, Inc.  2015. 
[43] Xue W ,  Islam A ,  Bhaduri M , et al. Direct Multitype Cardiac Indices Estimation via Joint 
Representation and Regression Learning[J]. IEEE Transactions on Medical Imaging, 2017, 
36(10):2057-2067. 
[44] Xue W ,  Nachum I B ,  Pandey S , et al. Direct Estimation of Regional Wall Thicknesses via Residual 
Recurrent Neural Network[J]. Springer, Cham, 2017. 
[45] Xue W ,  Lum A ,  MerCDo A , et al. Full Quantification of Left Ventricle via Deep Multitask Learning 
Network Respecting Intra- and Inter-Task Relatedness[C]// 2017. 
[46] Silva J F ,  Silva J M ,  Guerra A , et al. Ejection Fraction Classification in Transthoracic 
Echocardiography Using a Deep Learning Approach[C]// 2018 IEEE 31st International Symposium on 
Computer-Based Medical Systems (CBMS). IEEE, 2018. 
[47] Rgac D ,  Gyac D ,  Yang C , et al. PV-LVNet: Direct left ventricle multitype indices estimation from 
2D echocardiograms of paired apical views with deep neural networks[J]. Medical Image Analysis, 58. 
[48] Smistad E ,  Bernard O ,  Grenne B , et al. Real-time automatic ejection fraction and foreshortening 
detection using deep learning[J]. IEEE Transactions on Ultrasonics Ferroelectrics and Frequency 
Control, 2020, PP(99):1-1. 
[49] Xu C ,  Prince J L . Gradient vector flow deformable models[J]. Handbook of Medical Imaging, 
2000:159-169. 
[50] Yuwei Wu,Yuanquan Wang,Yunde Jia. Adaptive diffusion flow active contours for image 
segmentation[J]. Computer Vision and Image Understanding,2013,117(10). 
[51] Rodtook A, Kirimasthong K. Circular Vector Field Analysis for the Adaptive Diffusion Flow Snakes 
Applied to Ultrasound Images of Breast Cancer[C]//2019 16th International Joint Conference on 
Computer Science and Software Engineering (JCSSE). IEEE, 2019: 6-10. 
[52] Ronneberger O , Fischer P , Brox T . U-Net: Convolutional Networks for Biomedical Image 
Segmentation[J]. Springer International Publishing, 2015. 
[53] 邢恩铭,王文赛,周榴,等.基于改进U-Net 的皮肤超声图像自动分割算法[J].生物医学工程与临床, 
2021, 25(2):8.DOI:10.13339/j.cnki.sglc.20210226.016. 
[54] Dr, Sergio, Schabelman, et al. Left atrial volume estimation by two-dimensional echocardiography[J]. 
Catheterization & Cardiovascular Diagnosis, 1981. 
[55] Lang R M ,  Badano L P ,  Mor-Avi V , et al. Recommendations for chamber quantification[J]. Journal 


## Page 70

基于U-Net 的超声左心室分析方法研究 
60 
of the American Society of Echocardiography: official publication of the American Society of 
Echocardiography, 2015, 28:1-39. 
[56] Suzuki S ,  Be K . Topological structural analysis of digitized binary images by border following[J]. 
Computer Vision Graphics & Image Processing, 1985, 30(1):32-46. 
[57] Pirzadeh H . Computational geometry with the rotating calipers[J]. master's thesis mcgill u, 1999. 
[58] Shelhamer E , Long J , Darrell T .Fully Convolutional Networks for Semantic Segmentation[J].  
2016.DOI:10.1109/cvpr.2015.7298965. 
[59] 刘金辉,童晶,倪佳佳,黎学飞,张旭.基于改进U-Net 的下肢骨骼CT 图像分割.计算机系统应
用,2022,31(10):134-141 
[60] Jie,Shen,Samuel,et al.Squeeze-and-Excitation Networks.[J].IEEE transactions on pattern analysis and 
machine intelligence, 2019.DOI:10.1109/TPAMI.2019.2913372. 
[61] Huang G , Liu Z , Laurens V D M ,et al.Densely Connected Convolutional Networks[J].IEEE Computer 
Society, 2016.DOI:10.1109/CVPR.2017.243. 
[62] 林天予,宋亮,高智凡等.基于深度学习的二维心脏超声图像分割模型在小规模数据集上的性能评
估[J].暨南大学学报(自然科学与医学版),2022,43(02):191-198. 
 
 
 
 
 
 
 
 
 
 

