## Page 1

 
 
 
电子科技大学
 
UNIVERSITY OF ELECTRONIC SCIENCE AND TECHNOLOGY OF CHINA 
专业学位硕士学位论文 
MASTER THESIS FOR PROFESSIONAL DEGREE 
论文题目 
面向胎儿心脏的分割分类辅助 
诊断系统的设计与实现 
专业学位类别 
电子信息 
学  号 
202252090715 
作者姓名 
许志诚 
指导教师 
秦臻 教授 
学  院 
信息与软件工程学院 
 
 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page1_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page1_img1.png)

## Page 2

 
 
分类号 
TP311.5 
密级 
公开 
UDC
注1 
004.41 
学 位 论 文 
面向胎儿心脏的分割分类辅助诊断系统的设计与实现 
（题名和副题名） 
许志诚 
（作者姓名） 
指导教师 
秦 臻 
教  授 
电子科技大学 
成 都 
申请学位级别 
硕士 
专业学位类别 
电子信息 
专业学位领域 
软件工程 
提交论文日期 
2025 年3 月20 日 论文答辩日期 
2025 年5 月23 日 
学位授予单位和日期 
电子科技大学 
2025 年6 月 
答辩委员会主席 
 
评阅人  
注1：注明《国际十进分类法UDC》的类号。 
 
 


## Page 3

 
 
Design and Implementation of a Computer-Aided 
Diagnosis System for Fetal Cardiac Segmentation and 
Classification 
A Master Thesis Submitted to 
University of Electronic Science and Technology of China 
Discipline 
Electronic Information 
Student ID 
202252090715 
Author 
Xu Zhicheng 
Supervisor 
Prof. Qin Zhen 
School School of Information and Software Engineering 
 
 


## Page 4

摘 要 
I 
摘 要 
先天性心脏病是全球疾病负担排名首位的出生缺陷，其诊断和治疗难度大，已
成为婴幼儿死亡的主要因素之一。胎儿期筛查对降低先天性心脏病并发症和死亡
率具有重要意义。超声检查是胎儿期先心病筛查的主要手段，但采集图像质量不佳
会导致检出率显著下降。心电图作为无创便捷的诊断工具，对某些先天性心脏病的
诊断能力仍有局限。CT 和MRI 等三维医学成像技术可提供高分辨率解剖信息，通
过心脏分割后的三维重建有助于先天性心脏畸形研究。这些筛查方式各有优势与
局限，需综合应用以互为补充。随着人工智能技术快速发展，计算机辅助诊断系统
在医学领域展现出巨大潜力，但现有系统在临床应用中仍面临多模态数据关联困
难、系统性能不足及可扩展性差等挑战。 
本论文设计并实现了一套面向胎儿心脏的分割分类辅助诊断系统，采用微服
务架构构建，集成了超声图像增强、全心脏分割和基于心电的先心病预测等功能。
系统主要工作包括： 
（1）构建了关系型数据库、内存型数据库与对象型数据库相结合的混合存储架
构，实现了心电、超声、CT、MRI 等多模态医疗数据的高效管理和关联，为数据
预处理和辅助诊断提供了完整的数据支持。 
（2）提出了一种基于微服务组件的全模块容器化系统部署方案，并建立了分布
式网关对业务端向算法模块的请求进行统一管理，有效解决了传统系统中算法环
境冲突和扩展性不足的问题。通过设计标准化的网关请求响应模板，在系统中整合
了两种远程调用方案实现业务端与算法模块间通信。经测试，根据接口运行时环境
合理选择远程调用框架，可使微服务接口响应速度有不同程度提升。 
（3）建立了基于医院组织架构的系统权限控制体系，开发了基于路由及接口资
源的双重校验机制，实现了多维访问控制。同步构建了系统操作记录与算法调用记
录的双轨日志采集体系，并针对高频访问图像资源设计独立缓存系统。最终形成涵
盖患者管理、数据录入、预处理及辅助诊断的可扩展辅助诊断系统。 
本文面向胎儿先天性心脏病诊断领域提供了一套基于人工智能的辅助诊断系
统，并提供了从软件系统到硬件部署的架构设计和代码实现。通过将本系统应用于
胎儿心脏疾病的筛查流程中，不仅能够提升医生对患者多模态数据的管理效率，还
能提供有效的辅助诊断建议，从而减轻医生的诊断负担。 
关键词：先天性心脏病，多模态数据，计算机辅助诊断，人工智能 


## Page 5

ABSTRACT 
II 
ABSTRACT 
Congenital heart disease ranks as the leading birth defect in global disease burden, 
presenting significant diagnostic and treatment challenges that have made it a major 
contributor to infant mortality. Prenatal screening plays a crucial role in reducing 
complications and mortality associated with congenital heart disease. Ultrasound 
examination serves as the primary method for fetal cardiac screening; however, poor 
image quality significantly reduces detection rates. Electrocardiography, despite being a 
non-invasive and convenient diagnostic tool, still has limitations in diagnosing certain 
congenital heart conditions. Three-dimensional medical imaging technologies such as CT 
and MRI provide high-resolution anatomical information, and three-dimensional 
reconstruction following cardiac segmentation aids in the study of congenital cardiac 
malformations. These screening methods each have their advantages and limitations, 
necessitating integrated application to complement one another. With the rapid 
development of artificial intelligence technology, computer-assisted diagnostic systems 
have demonstrated enormous potential in the medical field. However, existing systems 
still face challenges in clinical applications, including difficulties in multimodal data 
correlation, insufficient system performance, and poor scalability. 
This thesis presents the design and implementation of a segmentation and 
classification-assisted diagnostic system for fetal hearts, constructed using microservice 
architecture and integrating functionalities such as ultrasound image enhancement, 
whole-heart segmentation, and ECG-based prediction of congenital heart disease. The 
main contributions of this work include: 
(1) A hybrid storage framework combining relational, in-memory, and object-
oriented databases was developed to efficiently manage and associate multimodal 
medical data (including Electrocardiography, ultrasound, CT, and MRI), thereby 
providing comprehensive data support for preprocessing and auxiliary diagnosis. 
(2) A fully modular containerized deployment solution based on microservice 
components was proposed, incorporating a distributed gateway to manage service-to-
algorithm module requests. This approach effectively resolves environment conflicts and 
scalability limitations inherent in traditional systems. Through the implementation of 
standardized gateway request-response templates and the integration of dual remote 


## Page 6

ABSTRACT 
III 
invocation protocols, high-efficiency system-algorithm communication was achieved. 
Tests demonstrated that selecting appropriate remote invocation frameworks based on 
interface runtime environments can significantly improve microservice interface response 
speeds. 
(3) A permission control system based on the hospital's organizational structure was 
established, along with a dual-verification mechanism based on routing and interface 
resources to achieve multidimensional access control. In parallel, a dual-track logging 
system was implemented to record both system operations and algorithm invocations, and 
an independent caching system was designed specifically for high-frequency access to 
image resources. Ultimately, this work resulted in an extensible auxiliary diagnosis 
system that encompassed patient management, data entry, preprocessing, and diagnostic 
assistance. 
This thesis provides an artificial intelligence-based assisted diagnostic system for 
fetal congenital heart disease diagnosis, offering architectural design and code 
implementation from software systems to hardware deployment. By applying this system 
to fetal cardiac disease screening procedures, it not only enhances physicians' efficiency 
in managing patients' multimodal data but also provides effective diagnostic assistance, 
thereby reducing the diagnostic burden on physicians. 
Keywords: Congenital heart disease, Multimodal data, Computer-aided diagnosis, 
Artificial Intelligence 


## Page 7

目  录 
第一章 绪论............................................................................................... 1 
1.1 研究背景与意义 ............................................................................... 1 
1.2 国内外研究现状 ............................................................................... 3 
1.3 本文的主要工作 ............................................................................... 5 
1.4 本文层次结构安排 ........................................................................... 6 
第二章 面向胎儿心脏的分割分类辅助诊断系统相关技术 .................. 7 
2.1 WEB 开发技术 .................................................................................. 7 
2.1.1 Spring Boot 框架 ........................................................................ 7 
2.1.2 Shiro 安全框架 ............................................................................ 8 
2.1.3 Netty 框架 .................................................................................... 8 
2.2 数据库管理技术 ............................................................................... 9 
2.2.1 关系型数据库MySQL............................................................... 9 
2.2.2 内存型数据库Redis ................................................................. 10 
2.2.3 文件服务器MinIO ................................................................... 11 
2.3 容器化和远程过程调用技术 ........................................................ 11 
2.3.1 Docker 技术 .............................................................................. 11 
2.3.2 Fast API 框架 ............................................................................ 12 
2.3.3 gRPC 框架 ................................................................................. 12 
2.3.4 Gunicorn 服务器 ....................................................................... 13 
2.4 日志和监控技术 ............................................................................. 13 
2.4.1 Prometheus 数据采集系统 ....................................................... 13 
2.4.2 Grafana 可视化框架 ................................................................. 14 
2.4.3 Mongo DB 文档型数据库 ....................................................... 14 
2.5 本章小结 ......................................................................................... 14 
第三章 面向胎儿心脏的分割分类辅助诊断系统需求分析 ................ 15 
3.1 核心功能需求 ................................................................................. 15 
3.1.1 患者管理 ................................................................................... 15 
3.1.2 数据录入 ................................................................................... 18 
3.1.3 数据预处理 ............................................................................... 21 
3.1.4 辅助诊断 ................................................................................... 24 
3.2 基本功能需求 ................................................................................. 27 
3.2.1 系统用户管理 ........................................................................... 27 
3.2.2 系统角色管理 ........................................................................... 32 
3.2.3 系统数据管理 ........................................................................... 35 


## Page 8

3.3 非功能需求 ..................................................................................... 38 
3.4 本章小结 ......................................................................................... 39 
第四章 面向胎儿心脏的分割分类辅助诊断系统架构设计 ................ 40 
4.1 体系结构设计 ................................................................................. 40 
4.1.1 技术架构 ................................................................................... 40 
4.2 模块概要设计 ................................................................................. 41 
4.3 接口设计 ......................................................................................... 43 
4.4 数据库设计 ..................................................................................... 45 
4.4.1 系统权限表设计 ....................................................................... 46 
4.4.2 数据库表设计 ........................................................................... 51 
4.4.3 文件服务器设计 ....................................................................... 53 
4.5 本章小结 ......................................................................................... 56 
第五章 面向胎儿心脏的分割分类辅助诊断系统详细设计与实现 .... 57 
5.1 开发环境 ......................................................................................... 57 
5.1.1 硬件环境 ................................................................................... 57 
5.1.2 软件环境 ................................................................................... 57 
5.1.3 开发工具 ................................................................................... 58 
5.2 系统架构设计 ................................................................................. 58 
5.2.1 系统技术架构 ........................................................................... 58 
5.2.2 分布式网关交互设计 ............................................................... 60 
5.2.3 容器化部署设计 ....................................................................... 61 
5.3 数据存储与管理 ............................................................................. 63 
5.3.1 元数据管理 ............................................................................... 64 
5.3.2 数据操作管理 ........................................................................... 65 
5.4 系统日志与缓存机制 ..................................................................... 66 
5.4.1 操作日志记录机制 ................................................................... 66 
5.4.2 系统缓存机制 ........................................................................... 70 
5.5 预处理模块 ..................................................................................... 73 
5.5.1 超声图像增强 ........................................................................... 73 
5.6 辅助诊断模块 ................................................................................. 75 
5.6.1 基于心电的先心病预测 ........................................................... 75 
5.6.2 全心脏分割 ............................................................................... 77 
5.7 统计分析 ......................................................................................... 80 
5.7.1 首页大盘 ................................................................................... 80 
5.8 用户认证与权限管理 ..................................................................... 81 
5.8.1 用户管理 ................................................................................... 82 
5.8.2 角色创建与权限配置 ............................................................... 83 
5.8.3 用户角色分配 ........................................................................... 83 


## Page 9

5.8.4 用户登录 ................................................................................... 84 
5.8.5 用户注册 ................................................................................... 85 
5.9 本章小结 ......................................................................................... 86 
第六章 面向胎儿心脏的分割分类辅助诊断系统测试 ........................ 87 
6.1 软硬件测试环境 ............................................................................. 87 
6.2 系统功能测试 ................................................................................. 88 
6.2.1 系统功能测试策略 ................................................................... 89 
6.2.2 用户认证与权限管理测试 ....................................................... 89 
6.2.3 数据管理测试 ........................................................................... 92 
6.2.4 超声图像增强模块测试 ........................................................... 94 
6.2.5 基于心电的先心病预测模块测试 ........................................... 95 
6.2.6 全心脏分割模块测试 ............................................................... 97 
6.3 性能测试 ......................................................................................... 98 
6.3.1 系统基本接口测试 ................................................................... 99 
6.3.2 FastAPI 和 gRPC 框架接口对比测试 ................................. 100 
6.3.3 系统核心功能接口测试 ......................................................... 102 
6.4 本章小结 ....................................................................................... 103 
第七章 总结与展望 .............................................................................. 104 
7.1 工作总结 ....................................................................................... 104 
7.2 未来展望 ....................................................................................... 105 
参考文献 ................................................................................................. 106 


## Page 10

图目录 
VII 
图目录 
图2-1 Spring Boot数据流图 ······································································ 7 
图2-2 Shiro认证流程··············································································· 8 
图2-3 Netty事件处理流程图 ····································································· 9 
图2-4 MySQL数据库架构设计图 ····························································· 10 
图2-5 Docker容器化部署架构图 ······························································ 12 
图3-1 患者管理模块用例图 ··································································· 16 
图3-2 数据录入模块用例图 ··································································· 19 
图3-3 数据预处理模块用例图 ································································ 21 
图3-4 辅助诊断模块用例图 ··································································· 24 
图3-5 系统用户管理模块用例图 ····························································· 27 
图3-6 系统角色管理用例图 ··································································· 32 
图3-7 系统数据管理用例图 ··································································· 36 
图4-1 系统整体架构图 ········································································· 40 
图4-2 系统模块结构图 ········································································· 42 
图4-3 系统权限E-R图 ·········································································· 46 
图4-4 患者模块E-R图 ·········································································· 51 
图4-5 文件服务器E-R图 ······································································· 54 
图5-1 系统整体架构图 ········································································· 59 
图5-2 元数据管理实现图 ······································································ 63 
图5-3 患者数据管理实现图 ··································································· 63 
图5-4 元数据管理活动图 ······································································ 64 
图5-5 数据操作管理活动图 ··································································· 65 
图5-6 日志管理活动图 ········································································· 67 
图5-7 系统权限缓存活动图 ··································································· 70 
图5-8 系统图片资源访问缓存活动图 ······················································· 72 
图5-9 超声图增强模块实现图 ································································ 73 
图5-10 超声图像增强模块活动图 ···························································· 74 
图5-11 基于心电的先心病预测模块实现图 ················································ 75 
图5-12 基于心电的先心病预测模块活动图 ··············································· 76 
图5-13 全心脏分割模块实现图 ······························································· 77 


## Page 11

图目录 
VIII 
图5-14 原始图像 ················································································· 78 
图5-15 分割结果 ················································································· 78 
图5-16 全心脏分割模块活动图 ······························································· 79 
图5-17 统计分析实现图 ········································································ 80 
图5-18 用户管理实现图 ········································································ 81 
图5-19 角色管理实现图 ········································································ 82 
图5-20 用户管理活动图 ········································································ 82 
图5-21 角色创建活动图 ········································································ 83 
图5-22 角色分配活动图 ········································································ 84 
图5-23 用户登陆活动图 ········································································ 85 
图5-24 用户注册活动图 ········································································ 86 
图6-1 对比测试结果折线图 ·································································· 101 
 


## Page 12

表目录 
IX 
表目录 
表3-1 系统角色权限表 ········································································· 15 
表3-2 “患者信息同步”用例规约 ······························································ 17 
表3-3 “患者信息维护”用例规约 ······························································ 17 
表3-4 “患者信息查询”用例规约 ······························································ 18 
表3-5 “患者权限管理”用例规约 ······························································ 18 
表3-6 “查看数据”用例规约 ···································································· 19 
表3-7 “搜索数据”用例规约 ···································································· 20 
表3-8 “选择数据类型”用例规约 ······························································ 20 
表3-9 “数据上传提交”用例规约 ······························································ 21 
表3-10 “超声图像增强”用例规约 ····························································· 22 
表3-11 “结果审核”用例规约 ··································································· 22 
表3-12 “查看历史结果”用例规约 ····························································· 23 
表3-13 “患者数据录入”用例规约 ····························································· 23 
表3-14 “基于心电的先心病预测”用例规约 ················································· 24 
表3-15 “全心脏分割”用例规约 ································································ 25 
表3-16 “患者数据录入”用例规约 ····························································· 25 
表3-17 “结果审核”用例规约 ··································································· 26 
表3-18 “查看历史结果”用例规约 ····························································· 26 
表3-19 “用户管理”用例规约 ··································································· 28 
表3-20 “账户信息管理”用例规约 ····························································· 29 
表3-21 “登出”用例规约 ········································································· 29 
表3-22 “登录”用例规约 ········································································· 30 
表3-23 “登出”用例规约 ········································································· 30 
表3-24 “注册”用例规约 ········································································· 31 
表3-25 “密码找回”用例规约 ··································································· 31 
表3-26 “角色信息查看”用例规约 ····························································· 33 
表3-27 “删除角色”用例规约 ··································································· 33 
表3-28 “角色权限配置”用例规约 ····························································· 34 
表3-29 “新建角色”用例规约 ··································································· 34 
表3-30 “删除角色”用例规约 ··································································· 35 


## Page 13

表目录 
X 
表3-31 “数据类别查询”用例规约 ····························································· 37 
表3-32 “数据类别维护”用例规约 ····························································· 37 
表3-33 “算法映射管理”用例规约 ····························································· 38 
表4-1 系统主模块介绍 ········································································· 42 
表4-2 接口概要设计元素 ······································································ 43 
表4-3 电子病历系统对接接口 ································································ 44 
表4-4 医学影像上传接口 ······································································ 44 
表4-5 辅助诊断接口 ············································································ 45 
表4-6 医学影像预处理接口 ··································································· 45 
表4-7 用户表 ····················································································· 47 
表4-8 角色表 ····················································································· 47 
表4-9 路由权限表 ··············································································· 48 
表4-10 接口资源权限表 ········································································ 48 
表4-11 用户-角色关系表 ······································································· 49 
表4-12 角色-路由权限关系表 ································································· 49 
表4-13 角色-接口资源关系表 ································································· 49 
表4-14 医院表 ···················································································· 50 
表4-15 科室表 ···················································································· 50 
表4-16 组别表 ···················································································· 50 
表4-17 患者基本信息表 ········································································ 52 
表4-18 就诊记录表 ·············································································· 52 
表4-19 医学影像表 ·············································································· 53 
表4-20 算法记录表 ·············································································· 53 
表4-21 算法定义表 ·············································································· 55 
表4-22 数据格式定义表 ········································································ 55 
表4-23 MinIO文件关联表 ······································································ 55 
表4-24 Redis缓存格式表 ········································································ 55 
表5-1 系统硬件开发环境 ······································································ 57 
表5-2 系统软件开发环境 ······································································ 57 
表5-3 系统开发工具 ············································································ 58 
代码5-1 请求泛化核心逻辑 ··································································· 61 
代码5-2 网关Dockerfile核心配置项 ························································· 62 
代码5-3 FastAPI框架Dockerfile核心配置项 ················································ 62 


## Page 14

表目录 
XI 
表5-4 系统数据类目数据格式 ································································ 64 
表5-5 系统管理日志核心内容 ································································ 66 
表5-6 算法操作日志核心内容 ································································ 67 
代码5-4 算法调用切面核心逻辑 ····························································· 68 
代码5-5 日志采集核心配置项 ································································ 69 
代码5-6 基于缓存的权限验证核心逻辑 ···················································· 71 
代码5-7 图片访问缓存核心逻辑 ····························································· 72 
表6-1 测试服务器硬件配置 ··································································· 87 
表6-2 测试客户端硬件配置 ··································································· 87 
表6-3 测试服务器软件配置 ··································································· 88 
表6-4 测试客户端软件配置 ··································································· 88 
表6-5 核心容器部署情况 ······································································ 88 
表6-6 用户认证与权限管理测试用例 ······················································· 90 
表6-6 用户认证与权限管理测试用例（续） ·············································· 91 
表6-6 用户认证与权限管理测试用例（续） ·············································· 92 
表6-7 数据管理测试用例 ······································································ 93 
表6-8 超声图像增强模块测试用例 ·························································· 94 
表6-8 超声图像增强模块测试用例（续） ················································· 95 
表6-9 基于心电的先心病预测模块测试用例 ·············································· 95 
表6-9 基于心电的先心病预测模块测试用例（续） ····································· 96 
表6-10 全心脏分割模块测试用例 ···························································· 97 
表6-10 全心脏分割模块测试用例（续）··················································· 98 
表6-11 基础查询接口测试结果 ······························································· 99 
表6-12 数据上传接口测试结果 ······························································ 100 
表6-13 基于FastAPI框架实现的接口测试结果 ··········································· 101 
表6-14 基于gRPC框架实现的接口测试结果 ············································· 101 
表6-15 系统核心功能接口测试结果 ························································ 102 
 


## Page 15

第一章 绪论 
1 
绪论 
本章主要阐述基于人工智能的面向胎儿心脏的分割分类辅助诊断系统的实现
及应用的研究背景与意义，集中探讨国内外辅助诊断系统的相关研究，之后介绍本
文的研究内容和层次结构。 
 研究背景与意义 
先天性心脏病（Congenital Heart Disease, CHD）是全球范围内疾病负担排名首
位的出生缺陷，也是胎儿先天性缺陷中最常见的疾病类型[1]。流行病学研究显示，
在美国，CHD 患病率为4%-10%，其中胎儿CHD 患病率约为1%[2]，而亚洲胎儿
CHD 出生缺陷率最高，达到9.3%[3]，在欧洲，2000-2005 年CHD 的死亡率（包括
围产期死亡和终止妊娠）为0.7%[4]。在中国，先天性心脏病的发病率约为0.8%[5]。
由以上数据可知，CHD 已成为婴儿和儿童死亡的主要因素之一。我国先天性心脏
病患儿每年的治疗费高达120 亿元[6]，先天性心脏病患儿的治疗不仅给患儿带来痛
苦，也给社会和家庭造成沉重的精神和经济负担。因此，有效预防和控制胎儿CHD
对于降低出生缺陷和死亡率，以及最终提升人口出生质量至关重要[7]。 
胎儿期筛查对于早期发现和治疗先天性心脏病具有重要意义，可有效降低并
发症发生率和死亡率[8]。超声检查是胎儿期进行先天性心脏病筛查的主要方法，但
二维超声图像对先天性疾病的检测率仅有65%-81%[9]。据Mozumdar 等人的研究
显示，在222 例胎儿的17,096 份胎儿超声心动图中，出现了30 例诊断差异，占胎
儿总数约13.5%[10]。更为普遍的统计表明，当前医学影像诊断的误诊率高达10%～
30%[11]。这些数据反映出传统超声诊断方法在准确性上的局限。更为严峻的是，我
国近年来出生人口约为900-1200 万，按照每个孕妇整个孕期共进行5 次超声检查
计算，每年超声检查工作量约为4500-6000 万检查人次。若一位医生每周最多检查
150 例，则共需6000-13000 名产科超声医生。然而，截至2019 年末，全国注册的
超声医生总数仅为12 万人，而其中具有产前筛查与诊断资质的超声医师不足5000
人[12]，远不能满足临床实际需求。这种专业医师资源的严重短缺进一步加剧了胎
儿心脏疾病诊断的困难。 
与超声检查类似，心电图（Electrocardiogram, ECG）作为用于诊断心脏病的主
要技术之一[13]，自1903 年荷兰医师兼生理学家Einthoven 采用弦线式电流计首次
测出[14]以来，ECG 至今已有百年历史。心电检查作为一种非侵入性检查方法，凭
借其可靠的诊断价值、便捷的操作流程以及良好的安全性等显著优势，已是心血管



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page15_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page15_img1.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page15_img2.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page15_img2.png)

## Page 16

电子科技大学硕士学位论文 
2 
疾病诊疗领域中不可或缺的重要手段[15]，也已经成为胎儿监护的重要项目之一[16]。
该方法可以辅助超声检查进行预筛查，用于诊断多种胎儿先天性心脏问题，特别是
对于某些以功能异常为主的先心病，心电分析可以提供超声检查难以获取的关键
诊断信息[17]。 
基于不同的成像机制，人体内部器官及组织在影像呈现上存在显著差异，且各
具独特的显影特点，这种差异性使得多种成像技术能够相互补充，弥补单一成像方
式的局限性。超声检查作为一种无创性诊断技术，因其显著的实时成像优势、经济
性以及安全性，在介入性操作如组织活检和病灶切除的引导中发挥着重要作用。然
而，超声影像在分辨率和清晰度方面存在局限性，难以准确呈现病灶特征及精确定
位。在当前，人们广泛使用电子计算机断层扫描（CT）、磁共振成像（MRI）等三
维医学成像技术来获取病人的病理信息和解剖学信息，这些3D 数据具有更好的对
比度，能够更详细的描述心脏解剖信息。在急性或重症心脏病的诊疗过程中，CT
影像学检查因其快速、准确的诊断特性，通常被临床列为优先考虑的检查方案[18]。
全心脏分割技术便是基于CT 和MRI 图像，目标是从图像中提取心脏所有子结构
的体积和形状[19]。在临床中，如果能方便地利用该技术生成的分割结果进行3D 建
模，能让医生能更加准确地研究先天性心脏畸形问题。 
随着人工智能、深度学习等技术的飞速发展，机器视觉集合人工智能等技术，
逐渐应用到医疗影像诊断中。由于医师间对影像表现的理解存在差异，通过人工智
能算法对大规模影像数据和诊断数据进行分析，可为临床医师提供多维度的病理
解读依据，从而提升诊断水平[11]。近年来已经有多种研究表明通过使用人工智能技
术处理和分析医学影像，可以有效提高胎儿心脏疾病的诊断准确性和效率[20]。然
而，现有的心脏医疗系统仍存在显著瓶颈。在数据层面，单一模态影像难以全面评
估心脏功能状态。多模态数据[21]的融合不仅能提供更全面的诊断依据，还能有效
降低单一检查方法的局限性[22]。在技术层面，传统的系统采用“黑箱”架构，缺乏
模块化设计，导致算法更新需重构系统部件过多或系统运行阻塞。 
目前，基于人工智能的计算机辅助诊断（Computer-aided Diagnosis, CAD）系
统的开发已成为主流，但其临床应用过程中仍然面临多模态数据关联构建困难、算
法稳定性、可扩展性差等挑战。因此本论文拟研究基于人工智能的CAD 系统内多
模态数据关联构建和能快速调用人工智能算法的系统架构设计，重点解决其在临
床应用过程中出现的问题。 


## Page 17

第一章 绪论 
3 
 国内外研究现状 
CAD 可有效提升诊断准确性并降低假阳性率，为医生提供第二诊断意见。该
领域的研究始于1963 年Lodwick 等人提出的X 射线影像数字化方法[23, 24]，随后
在1998 年第一台获得美国食品药品管理局批准的乳腺X 线摄影CAD 设备诞生，
这一年被很多人称为“CAD 元年”。传统CAD 系统从功能划分来看，包括计算机
辅助检测（Computer-aided Detection, CADe）和计算机辅助诊断（Computer-aided 
Diagnosis, CADx）两个分支。CADe 主要用于医学影像中病变的检测与定位，而
CADx 则侧重于疾病的诊断与表征。在最初的传统CAD 模型中，其主要目的是让
计算机代替医生进行二次阅片，其身份是第二读者。当前CAD 系统在临床上的应
用虽能有效减轻医师工作负担，但尚未达到取代临床医师诊断的水平。 
目前，人工智能技术在医学影像领域的应用以肿瘤影像最为成熟[25]。尽管CAD
商业化从“CAD 元年”开始已经过去了20 年，但毫不夸张地说，美国临床实践中
最成功的CAD 示例仍然是乳房X 线摄影CAD，也就是最初CAD 诞生的临床应用
领域。另一方面，在日本，截至2018 年底，唯一获得监管部门批准的CAD 系统
也是乳房X 线摄影CAD[26]。尽管人们已充分认识到临床环境中对CAD 的需求，
但传统CAD 仍存在诸多局限性：开发成本高、假阳性率高、可能增加不必要的召
回和活检、临床评估效果不稳定、工作流程欠佳、成本效益不理想，且仅适用于特
定病变类型[27]。 
在传统CAD 系统的开发中，开发者总是致力于设计或创建系统能够在图像中
识别的特征量，比如癌症病变区域的形状或密度信息。但随着人工智能技术的日趋
成熟，深度学习等新的人工智能办法出现，其优势在于它可以通过学习过程自行创
建这些特征，从而大量节省了开发人员的时间和精力。基于深度学习的CAD 在特
征提取和模式识别方面已经表现出显著优势。在很多医疗影像诊断领域中，基于人
工智能技术的CAD 系统已经表现出了与人类医生相当甚至更好的效果。比如皮肤
癌诊断领域内对人工智能和皮肤科医生进行了评估，以从100,000 多张显影图像中
区分黑色素瘤，皮肤科医生准确率为87%而人工智能为95%[28]；同样在病理图像
领域内，即便是在病理学家查看图像的时间不受限制的情况下也出现了低于人工
智能的准确度[29]。在过去，开发需要数年才能完成，但通过深度学习，开发任务则
可以在数月内完成。 
如上所述，基于人工智能的新一代CAD 系统已展现出优异的临床效果。根据
近期学术机构与企业研究成果，CAD 系统的发展路径可归纳为三个阶段：首先基
于大量案例构建系统，其次通过更多数据优化性能，最后实现临床应用目标。无论
是人工智能还是CAD 系统的发展，都依赖于海量数据支持[30]。然而，医学临床数



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page17_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page17_img1.png)

## Page 18

电子科技大学硕士学位论文 
4 
据因涉及患者隐私问题，公开可用的数据规模远小于普通自然数据[31]。值得关注
的是，公共医学图像数据库正在持续扩展。例如，美国国立卫生研究院建立的
ChestX-ray8[32]数据库包含约11 万张胸部X 光图像。此外，NIH 临床中心还开发了
DeepLesion 数据库，涵盖约1.06 万张躯干CT 图像及超过4400 名独立患者的数
据。这些数据库均已公开，为医疗算法开发与测试提供了重要支持。需要特别说明
的是，本研究数据除来源于公开网络数据集外，还获得了本市多家医院的临床数据
支持。 
随着美国国会通过《21 世纪健康法案》，美国医疗产业加大了对人工智能产品
的研发投入。2019 年2 月，美国政府颁布《美国人工智能倡议》行政令[33]，进步
强化了对该产业的政策支持。我国在十九大报告中明确提出要“加快建设制造强国，
加快发展先进制造业，推动互联网、大数据、人工智能和实体经济深度融合”[34]。
由此可见，人工智能医疗器械产业已成为全球战略发展的重要组成部分。 
近年来，人工智能在医学领域的应用取得显著进展。国际上，多家企业在深度
学习医学影像诊断方面进行了积极探索：IBM 研发的Watson 系统[35]成功诊断罕见
白血病并制定治疗方案；美国Enlitic 公司开发的癌症检测系统[36]实现了超越放射
技师的检出率。相较而言，我国CAD 系统研究起步较晚，与国际先进水平存在一
定差距。然而，近年来国内高校和企业在CAD 系统研发方面取得了显著进展，其
中浙江大学、DeepCare、推想科技等机构的研究成果较为突出。 
另外，在当前医疗诊断系统中，不论是基于医学深度学习技术为影像数据的分
析处理提供依据的辅助诊断系统，或是基于电子病历等医疗信息数据进行挖掘和
分析的辅助诊断系统，均会出现但由于医疗数据获取渠道受限，难以与医院信息中
心建立数据共享机制的问题。随着医疗信息化的发展，电子病历（Electronic medical 
records, EMR）在医院得到广泛应用，日常诊疗工作中产生了大量的临床数据并被
记录下来[37]，现代CAD 系统中对EMR 的接入变得至关重要。 
考虑到现代医疗系统中医学信息模态[21]众多，多模态数据库建设也成为了
CAD 系统实现的核心要素。此类数据库不仅需要整合CT、MRI、X 射线等多种医
学影像数据，还需要包含患者临床资料、实验室检验结果及病理报告等综合信息。
其构建过程要求具备强大的数据处理能力和先进的数据整合技术，同时需要对数
据实施严格的预处理和标准化流程，以确保数据质量和系统准确性[38]。 
尽管人工智能在医学领域的研究方向广泛，但真正进入临床应用的比例较低。
其主要制约因素在于人工智能系统难以在复杂的临床环境中获取高质量的有效数
据，导致分析结论可靠性不足，且难以在实际测试数据集上保持稳定的高准确率。 


## Page 19

第一章 绪论 
5 
 本文的主要工作 
本文的主要工作在于对胎儿心脏辅助诊断系统的构建需求进行深入分析，针
对患者的多模态数据处理、算法集成、算法扩展及系统业务流程等问题提出了解决
方案。最终在应用层面实现了符合临床诊断需求的业务流程闭环。通过硬件设备选
型与软件系统开发相结合的方式，最终构建出可扩展的胎儿心脏辅助诊断平台。本
文主要完成的工作内容如下： 
（1）针对胎儿CHD 多种筛查方式的临床场景进行系统性需求分析，从患者多
模态数据关联构建、算法服务部署和临床业务流程三个维度展开功能需求梳理。通
过调研医疗机构实际工作流程，抽象出系统用户权限管理、患者数据管理、数据预
处理和辅助诊断等核心功能模块，通过用例图和用例规约详细描述了各模块功能
点，明确了系统不同角色的权限划分。同时，从性能、环境、可靠性、可维护性、
可扩展性、安全性和权限管理等七个维度提出了系统的非功能性需求，为后续系统
设计与实现奠定了基础。 
（2）根据需求分析结果，设计完成系统的整体架构设计，将需求转化为分层技
术方案，明确了系统的体系结构、模块设计和接口设计。在体系结构方面，系统被
组织为用户接入层、网络防护层、负载均衡层和应用层四个层次；在模块设计方面，
将系统划分为七个功能模块，每个模块内部又包含多个子功能模块；在接口设计方
面，详细规划了外部系统调用接口、内部组件交互接口和人机交互接口。针对数据
管理的需求，设计了完整的数据库结构，包括基于RBAC 模型的系统权限表、患
者信息表和文件服务器相关表。 
（3）基于微服务分布式架构思想，系统设计了分布式网关交互机制及容器化部
署方案。在核心功能实现方面，完成了超声图像增强、基于心电的先心病预测以及
全心脏分割三个已有成熟算法的编码实现与容器化集成。同时编码实现了系统管
理功能，涵盖用户认证、角色管理、权限配置及数据分类等基础模块。各模块通过
部署后的前端界面示意图直观展示了页面布局与用户操作流程。最后搭建测试环
境并开展系统业务接口的功能与性能测试，同时对两种远程调用框架进行了对比
分析。 
通过本论文的工作所实现的面向胎儿心脏的分割分类辅助诊断系统能够辅助
医生进行胎儿先心病的诊断工作，减轻医生的工作负担，为CAD 系统的临床诊疗
提供重要的数据支撑和理论基础。系统的模块化设计和微服务架构也为未来功能
增加和优化提供了良好的可扩展性。 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page19_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page19_img1.png)

## Page 20

电子科技大学硕士学位论文 
6 
 本文层次结构安排 
本文第一章绪论部分介绍了基于人工智能的医学辅助诊断系统的发展背景及
其在胎儿先天性心脏病诊断中的重要意义，分析了目前国内外在计算机辅助诊断
系统方面的研究现状，并明确了本文的主要研究内容。 
第二章介绍了系统所涉及的关键技术。首先详细阐述了系统采用的Web 开发
技术，包括Spring Boot 框架、Shiro 安全框架和Netty I/O 框架；其次介绍了数据
库管理技术，包括MySQL、Redis 和MinIO 的应用；然后对容器化和远程过程调
用技术进行了说明，包括Docker 技术、FastAPI 框架和gRPC 框架；最后介绍了
Prometheus、Grafana 和MongoDB 等日志和监控技术。 
第三章主要进行系统需求分析。首先对系统的业务需求进行分析，包括患者管
理、数据录入、数据预处理和辅助诊断等核心功能；其次分析了系统的基本需求，
包括系统用户管理、角色管理和数据管理；最后详细阐述了系统的非功能性需求，
包括性能需求、环境需求、可靠性需求等方面。 
第四章介绍系统的架构设计。包括系统的体系结构设计、模块概要设计、接口
设计和数据库设计。重点阐述了系统的技术架构、各功能模块的设计思路，以及权
限管理设计。 
第五章详细介绍系统的具体实现，展示了系统的总体成果，并对各核心模块的
实现效果进行了介绍。首先说明了系统的开发环境配置，包括硬件环境、软件环境
和开发工具；然后详细描述了系统架构的实现细节，包括系统技术架构、微服务组
件设计和容器化部署方案；接着介绍了基础功能模块的实现，包括数据存储与管理
等；随后重点阐述了系统中涉及到算法应用的相关模块，包括预处理模块下超声图
像增强模块、辅助诊断模块下基于心电的先行并预测和全心脏分割等核心功能的
具体实现方案；最后对系统的用户认证与权限管理模块进行了介绍。 
第六章是系统测试。介绍了系统的软件测试方法、测试环境配置，并详细描述
了功能性测试和性能测试的过程与结果，验证了系统的可靠性和实用性。 
第七章是总结与展望。总结了本文的主要工作和创新点，分析了系统目前存在
的不足，并对基于人工智能的辅助诊断系统未来的改进方向进行了展望。 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page20_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page20_img1.png)

## Page 21

第二章 面向胎儿心脏的分割分类辅助诊断系统相关技术 
7 
面向胎儿心脏的分割分类辅助诊断系统相关技术 
 WEB 开发技术 
本研究构建了一套基于现代Web 技术的医疗辅助诊断平台。该平台的技术选
型充分考虑了数据安全性、实时性与可靠性等多维度需求，形成了高效、安全且具
有可扩展性的系统架构。 
2.1.1 Spring Boot 框架 
Spring Boot 是一个基于Spring 框架的快速开发平台，它通过约定优于配置的
理念简化了Spring 应用的开发过程。这种特性使得开发团队可以将更多精力集中
在业务逻辑的实现上，而不是繁琐的配置工作。 
在本系统中，Spring Boot 的应用主要体现在三个方面。首先，它提供了完整的
Web 开发环境，包括内嵌的Tomcat 服务器、RESTful API 支持等功能，这些功能
为系统的Web 层提供了坚实的基础。其次，Spring Boot 的自动配置特性使得系统
能够快速集成各种第三方库和工具，如数据库连接池、缓存框架等。最后，Spring 
Boot 提供的监控和管理功能，使得系统运行状态的监控和维护变得更加简单高效。 
Spring Boot 采用分层架构，其中每一层都与它的下层或上层（层次结构）直接
通信。表现层：表现层处理Http 请求、将JSON 参数转换为对象、验证请求并将
其传输到业务层。简而言之，它由视图组成。Spring Boot 的工作流如图2-1 所示： 
 
图2-1 Spring Boot 数据流图 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page21_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page21_img1.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page21_img2.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page21_img2.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page21_img3.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page21_img3.png)

## Page 22

电子科技大学硕士学位论文 
8 
2.1.2 Shiro 安全框架 
在医疗信息系统中，安全性是最重要的考虑因素之一。Apache Shiro 作为一个
功能完善的安全框架，在本系统中承担着身份验证、访问控制、会话管理等重要职
责。Shiro 的设计理念是通过简单易用的API 提供完整的安全功能，这使得开发团
队能够轻松实现复杂的安全需求。 
Shiro 的核心是SecurityManager，它作为系统安全功能的管理者，协调各个安
全组件的工作。当用户访问系统时，所有的安全操作都要经过SecurityManager 的
处理。在认证过程中，Shiro 通过Realm 组件与系统的安全数据源进行交互，验证
用户身份的合法性。在授权过程中，Shiro 根据预定义的安全策略，控制用户对系
统资源的访问权限。Shiro 的认证流程如图2-2 所示： 
 
图2-2 Shiro 认证流程 
本系统将Shiro 整合于网关层，构建统一的安全控制中心来确保所有外部请求
必须通过安全验证才能访问系统资源。同时系统开启了Shiro 的缓存管理功能，以
降低重复安全验证的系统开销。 
2.1.3 Netty 框架 
在实时数据传输方面，本系统选择了Netty 作为网络应用框架。Netty 是一个
基于NIO 的异步事件驱动框架，特别适合处理大量并发连接和高速数据传输场景。
在医疗诊断系统中，心音数据、超声影像等需要实时传输和处理，Netty 的高性能
特性保证了数据传输的实时性和可靠性。 
Netty 的核心是Channel 和ChannelPipeline，它们组成了数据传输和加工的管
道。其事件处理流程围绕事件循环（EventLoop）展开：服务端启动时，BossGroup 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page22_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page22_img1.png)

## Page 23

第二章 面向胎儿心脏的分割分类辅助诊断系统相关技术 
9 
的事件循环负责监听并接受客户端连接，创建对应的Channel 后将其注册到Worker
线程组的某个事件循环上，后续该Channel 的所有I/O 事件均由绑定的线程处理；
数据在Channel 的ChannelPipeline 中流动，由一系列Handler 组成的责任链依次处
理入站（如解码、业务逻辑）和出站（如编码）事件，最终完成异步非阻塞的高效
通信。Netty 事件数据流如图2-3 所示： 
 
图2-3 Netty 事件处理流程图 
 数据库管理技术 
2.2.1 关系型数据库MySQL 
在数据持久化层面，MySQL 数据库承担着存储结构化医疗数据的重要使命。
本系统选择MySQL 作为主数据库，主要基于其卓越的性能表现、高度可靠性以及
广泛而活跃的社区支持。MySQL 的InnoDB 存储引擎提供了完整的事务支持，有
效保障了医疗数据操作的原子性、一致性、隔离性和持久性事务特性。在数据库设
计方面，系统采用了规范化的设计原则，合理划分各类表结构，并建立了完整而高
效的索引体系，这些精心设计的措施为医疗数据的高效访问提供了坚实保障。 
MySQL 的主从复制功能为系统提供了数据备份和负载均衡的能力。通过配置
主从复制，可以使系统将读操作分散到从库上，减轻主库的压力，同时也提供数据
的热备份。此外，医疗数据中存在大量有时间标签的数据，MySQL 的分区表功能
可以被用于处理大容量的历史数据，通过按时间范围分区，提高查询效率。系统还
利用MySQL 的视图功能封装复杂的查询逻辑，简化了应用层的数据访问代码。 
MySQL 数据库系统对查询请求的处理流程是一个精细设计的多阶段过程。当
客户端发送SQL 查询请求后，首先由连接器负责建立与数据库的连接，进行身份
验证并检查用户权限，确保请求者具有执行相关操作的资格。连接成功后，查询请



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page23_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page23_img1.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page23_img2.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page23_img2.png)

## Page 24

电子科技大学硕士学位论文 
10 
求会传递给查询缓存模块，该模块会检查是否有与当前查询完全相同的缓存结果，
如果命中缓存，则直接返回结果，避免重复计算，显著提升响应速度。若未命中缓
存，查询请求进入分析器阶段，此处进行词法分析和语法分析，将SQL 语句转换
为数据库可理解的内部结构，并检查SQL 语法的正确性。语法检查通过后，优化
器接手处理，负责制定最佳执行计划。优化器会分析表结构、索引情况和统计信息，
评估多种可能的执行路径，选择成本最低的方案，如确定访问表的顺序、选择合适
的索引等关键决策。执行计划确定后，执行器根据优化器生成的执行计划开始执行
查询，与存储引擎交互获取数据。执行器会调用存储引擎提供的接口，进行表数据
的读取或写入操作。最后，存储引擎负责实际的数据存取工作，根据其特定的数据
组织方式和索引结构，从磁盘或内存中检索或修改数据，并将结果返回给客户端。
整个流程体现了MySQL 处理查询请求的高效性和可靠性。MySQL 数据库架构设
计如图2-4 所示： 
 
图2-4 MySQL 数据库架构设计图 
2.2.2 内存型数据库Redis 
Redis 作为高性能的内存数据库，在本系统中主要用于缓存和会话管理。Redis
的数据存储在内存中，能够提供毫秒级的响应速度，这对于提升系统性能至关重要。



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page24_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page24_img1.png)

## Page 25

第二章 面向胎儿心脏的分割分类辅助诊断系统相关技术 
11 
在缓存策略设计上，系统采用了多级缓存架构，Redis 作为二级缓存，配合本地缓
存共同提供数据服务。 
Redis 的数据结构丰富，包括字符串、哈希、列表、集合等，能够满足不同场
景的数据存储需求。例如，使用Redis 的Sorted Set 存储实时监测数据的排序集合，
使用Hash 存储用户会话信息。Redis 的发布订阅功能被用于实现系统的消息通知
机制，而其原子操作特性则保证了并发场景下的数据一致性。为了确保数据安全，
系统配置了Redis 的持久化机制，通过RDB 和AOF 两种方式实现数据的持久化存
储。 
2.2.3 文件服务器MinIO  
对于医疗影像、心音文件等大容量二进制数据的存储，系统采用了MinIO 对
象存储服务器。MinIO 采用分布式架构，支持对存储进行水平扩展，提供了高可用
性和可扩展性。它的S3 兼容API 使得系统能够像使用云存储一样操作本地存储资
源，同时保持了数据的私密性和安全性。 
MinIO 的纠删码技术，使得其在部分数据丢失的情况下仍能通过剩余数据进
行恢复，保证了数据存储的可靠性和完整性。同时，系统通过MinIO 的分片上传
功能可以实现大文件的断点续传，提高文件上传的可靠性。在权限控制方面，MinIO
的基于策略的访问控制确保了只有授权用户才能访问敏感的医疗数据文件。 
 容器化和远程过程调用技术 
2.3.1 Docker 技术 
Docker 作为容器化技术的代表，在本系统的部署中起着关键作用。Docker 通
过容器化技术实现了应用及其依赖环境的封装，使得应用能够在不同的环境中保
持一致的运行状态。这种特性极大地解决了传统部署中跨平台不可移植性的问题。
在本系统中，每个微服务组件都被打包为独立的Docker 镜像，包含其运行时需要
的所有依赖。 
Docker 架构呈现为一个分层结构，从上至下清晰划分职责与边界。最上层是
容器化应用层，包含用户开发的应用程序、所需依赖库和执行环境，每个应用被封
装在独立容器中，实现了应用间的隔离与资源限制。其下是Docker 引擎层，由
Docker 守护进程等组件构成，负责容器的创建、运行和管理，并通过API 提供容
器生命周期管理能力。Docker 引擎之下是主机操作系统层，Docker 采用轻量级虚
拟化技术，直接利用宿主机操作系统内核，通过命名空间（Namespace）实现进程



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page25_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page25_img1.png)

## Page 26

电子科技大学硕士学位论文 
12 
隔离，通过控制组（Control Groups）进行资源限制，通过联合文件系统（Union File 
System）管理镜像分层，无需额外的虚拟机层，显著提高了性能与资源利用率。最
底层是基础设施层，包括物理服务器或云端虚拟机，提供计算、存储和网络资源。
Docker 的这种分层架构使应用部署更加灵活高效，实现了“一次构建，到处运行”
的目标，大幅简化了现代软件交付流程。Docker 容器化部署架构如图2-5 所示： 
 
图2-5 Docker 容器化部署架构图 
2.3.2 FastAPI 框架 
FastAPI 是一个现代化的Python Web 框架，在本系统的医疗数据处理服务中
发挥重要作用。FastAPI 基于Python 3 的类型提示功能构建，能够在开发阶段就发
现潜在的类型错误，提高了代码的可靠性。系统利用FastAPI 的异步特性处理耗时
的数据分析任务，避免阻塞主线程，提高了系统的并发处理能力。 
FastAPI 自动生成的交互式API 文档极大地方便了前后端的协作开发。文档中
包含了每个接口的详细信息，包括参数说明、请求示例和响应示例，这些信息都是
基于代码自动生成的，始终保持同步更新。FastAPI 的依赖注入系统简化了服务间
的解耦，使得代码更容易测试和维护。同时，其内建的安全机制提供了JWT（JSON 
Web Token）认证、OAuth2 等多种安全选项。 
2.3.3 gRPC 框架 
在微服务间的通信中，系统采用gRPC（google Remote Procedure Calls）框架
实现高效的远程过程调用。相比传统的REST（Representational State Transfer）风



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page26_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page26_img1.png)

## Page 27

第二章 面向胎儿心脏的分割分类辅助诊断系统相关技术 
13 
格接口，gRPC 基于Http 2.0 协议，支持双向流式通信，特别适合医疗数据的实时
传输场景。gRPC 使用Protocol Buffers 作为接口定义语言（Interface Definition 
Language, IDL），使得服务接口的定义更加规范和清晰。通过IDL 生成的代码确保
了客户端和服务端的类型安全，减少了运行时错误。 
gRPC 的流式传输特性被用于实现心音数据的实时传输，服务器能够持续向客
户端推送数据，而不需要建立多个连接。压缩传输和多路复用等特性显著提高了数
据传输效率。此外，gRPC 的拦截器机制便于实现统一的日志记录、认证授权等横
切关注点。 
2.3.4 Gunicorn 服务器 
Gunicorn 是一个用于Python WSGI（Web Server Gateway Interface）应用的高
性能HTTP 服务器，在本系统中作为FastAPI 应用的生产环境部署工具。Gunicorn
采用预分叉（pre-fork）工作模型，能够同时处理多个并发连接，显著提高了系统
的并发处理能力和稳定性。Gunicorn 的主进程负责管理多个工作进程，当接收到请
求时，会将其分发给可用的工作进程处理。这种架构使得系统能够充分利用多核处
理器，提高资源利用率。同时，如果某个工作进程出现问题，Gunicorn 能够自动重
启该进程，保证服务的高可用性，这对医疗系统的稳定运行至关重要。Gunicorn 提
供了丰富的配置选项，允许根据服务器硬件资源和应用特性进行精细调优。系统可
以根据实际负载情况调整工作进程数量、连接超时时间、最大请求数等参数，优化
性能和资源使用。 
 日志和监控技术 
2.4.1 Prometheus 数据采集系统 
Prometheus 作为开源的监控系统，负责收集和存储系统的各项性能指标。它采
用拉取式的数据采集模型，定期从被监控的服务中抓取指标数据。Prometheus 的多
维数据模型使得系统可以灵活地定义和组合监控指标，通过标签（Label）实现了
丰富的数据分类和查询能力。其强大的查询语言PromQL 支持复杂的数据分析和
告警规则定义。 
在本系统中，Prometheus 用来监控服务器资源使用情况。通过配置服务发现机
制，Prometheus 能够自动发现和监控新增的服务实例。系统通过配置告警管理器
（Alert Manager）来处理和分发告警信息，确保运维团队能够及时发现和处理系统
异常。 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page27_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page27_img1.png)

## Page 28

电子科技大学硕士学位论文 
14 
2.4.2 Grafana 可视化框架 
Grafana 提供了强大的数据可视化能力，是系统监控大盘的核心组件。它能够
集成多种数据源，包括Prometheus、MySQL 等，将不同来源的数据整合在统一的
仪表板中展示。Grafana 的可视化组件丰富，包括折线图、热力图、仪表盘等，能
够直观地展示系统的运行状态和趋势分析。 
系统通过Grafana 构建了多个监控面板，包括系统概览、性能分析、错误追踪
等。面板支持动态刷新和时间范围选择，便于运维人员进行问题排查和性能优化。
Grafana 的告警功能为关键指标设置了阈值告警，通过邮件、Slack 等多种渠道通知
相关人员。 
2.4.3 MongoDB 文档型数据库 
MongoDB 作为文档型数据库，在本系统中主要用于存储非结构化和半结构化
的医疗数据。其灵活的文档模型适合存储格式多变的诊断记录。同时MongoDB 的
索引支持和聚合管道功能为复杂的数据查询和统计分析提供了强大支持，方便系
统维护人员后续对日志等文档进行查询。系统在部署时可以利用MongoDB 的分片
集群特性，实现数据的水平扩展，在提高数据处理规模的同时没有造成过高的扩展
损耗。MongoDB 的复制集机制和自动故障转移机制能确保维持服务的连续性和数
据的高可用。此外，MongoDB 的变更流功能被用于实现数据变更的实时通知，使
得系统能够及时响应数据的更新。以上相关特性都符合本系统对于日志存储的需
求。 
 本章小结 
本章节针对辅助诊断系统的业务后端系统、算法容器化技术和数据存储技术
做出了介绍分析。后端开发模块方面介绍了目前主流的后端开发技术，框架采用主
流的Spring Boot，利用其自动配置特性来提示系统的开发效率。系统为确保算法
模块的可扩展性，所有相关算法均使用了容器化技术来保证环境一致性和可移植
性，容器间通过FastAPI 和gRPC 框架实现了高效的服务间通信。在数据管理方面，
系统构建了多层次的数据存储架构：采用MySQL 数据库存储格式化医疗数据和系
统数据；引入Redis 作为高性能内存数据库，优化系统响应速度；使用MinIO 对象
存储服务器专门处理医疗影像、心电数据等不同规格的二进制数据。同时，为保证
系统的可靠运行和可追溯性，也对监控和日志技术进行了介绍。



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page28_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page28_img1.png)

## Page 29

第三章 面向胎儿心脏的分割分类辅助诊断系统需求分析 
15 
面向胎儿心脏的分割分类辅助诊断系统需求分析 
 核心功能需求 
面向胎儿心脏的分割分类辅助诊断系统主要是为了满足胎儿先天性心脏病的
智能化辅助诊断需求，可以支持医生和科研人员对胎儿心脏的多模态数据进行分
析、处理和诊断，提升胎儿先心病的辅助诊断能力。核心功能包括：系统管理、数
据预处理、多维重建和辅助诊断。 
系统管理模块主要面向系统管理员，提供用户管理、角色管理和数据类别管理
功能，实现对系统用户、角色和数据的精细化管理和权限控制。数据预处理模块包
含医学图像增强功能，能够对超声医学影像进行超分辨率增强。辅助诊断模块则包
含基于心电的先心病预测和心脏分割两大功能，可以预测先天性心脏病和心脏图
像分割。 
本系统采用模块化设计，各功能模块既相对独立又紧密协作。系统管理模块为
其他功能模块提供用户权限管理和数据管理支持；数据预处理模块可为后续的辅
助诊断提供高质量的处理后数据；辅助诊断模块为医生和科研人员提供辅助诊断
支持。整个系统通过对胎儿心脏的多模态数据进行智能化处理和分析，可以有效辅
助医生进行胎儿先心病的诊断工作，为临床诊疗提供重要的数据支撑和理论基础。
不同角色拥有不同的功能权限。系统管理员具有最高权限，可以管理所有功能；医
院管理员主要负责医院内部的管理工作；医生和科研人员则主要使用系统的核心
功能模块进行辅助诊断和研究工作。系统的主要角色如表3-1 所示： 
表3-1 系统角色权限表 
 
系统管理权限 
医院管理权限 
自定义功能权限 
功能使用权限 
系统管理员 
√ 
√ 
√ 
 
医院管理员 
 
√ 
√ 
 
医生 
 
 
 
√ 
科研人员 
 
 
 
√ 
3.1.1 患者管理 
患者管理是系统的基础功能模块之一，其在整体医疗信息系统中扮演着关键
角色。针对不同医疗单位的实际需求，系统设计了两种互斥的患者信息管理方式，
以满足不同场景下的信息处理需求。 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page29_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page29_img1.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page29_img2.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page29_img2.png)

## Page 30

电子科技大学硕士学位论文 
16 
系统实现了通过接口调用机制与现有医疗系统电子病历系统进行无缝对接，
通过标准化数据交换协议实现患者信息的实时同步获取。这种方式适用于已经拥
有成熟电子病历系统的医疗机构，避免了重复建设和数据冗余。但需要注意的是，
此时系统仅能查看患者信息，不能进行深度的信息维护和权限管理。用户也可以使
用系统独立开发的患者信息存储系统进行全方位管理。此管理模式为新建系统或
需要独立运行的场景提供了完整解决方案，系统可以全面地进行患者信息的维护、
更新和精细化权限管理，确保数据的完整性和可控性。 
无论采用哪种管理方式，患者信息均通过唯一身份识别码关联就诊记录、过往
病史、药物过敏史和医学影像检查资料等临床相关内容，构建完整的患者医疗数据
图谱，为临床诊疗决策提供全面支持。 
患者管理模块的主要功能用例如图3-1 所示： 
 
图3-1 患者管理模块用例图 
如上图所示，在患者管理模块的功能权限划分中，医生和科研工作者拥有相同
的功能用例范围，主要限定为对患者基本信息的录入、编辑和查询操作。值得注意
的是，在患者信息录入过程中，患者所属的医院和科室信息会被系统自动保存为操
作者所属的医院和科室，并设置为不可编辑状态，这一限制旨在保证数据的一致性
和医疗行政管理的规范性。系统管理员作为高级权限持有者，除了拥有医生和科研
工作者的全部基础功能外，还额外具备患者权限的编辑权限。这一特殊功能的设置
主要针对实际工作中可能出现的录入错误场景，允许管理员对患者所属医院和科
室的信息进行有针对性的修改和校正，从而确保系统数据的准确性和完整性。 
在患者信息录入这一功能用例中，系统的两种患者信息管理方式会互斥运行。
当选择与医院数据库中的电子病历系统同步方式时，系统仅提供信息查询功能，不
允许进行信息维护和权限管理，这一设计是为了避免对医院数据库产生侵入性操
作；当选择独立管理方式时，系统提供完整的患者信息维护和权限管理功能。这种
设计既保证了与现有医疗系统的兼容性，又为独立部署场景提供了完整的功能支
持。患者管理模块用例规约如表3-2 至表3-5 所示： 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page30_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page30_img1.png)

## Page 31

第三章 面向胎儿心脏的分割分类辅助诊断系统需求分析 
17 
表3-2 “患者信息同步”用例规约 
用例名称 
患者信息同步 
执行者 
医生、科研工作者 
用例简述 
通过接口从电子病历系统同步患者信息，选择此方式后系统将禁用信
息维护和权限管理功能 
前置条件 
用户具备相应权限且电子病历系统接口正常 
后置条件 
成功同步患者信息到系统，并自动切换为同步模式 
主事件流 
1. 医务人员请求使用同步管理方式 
2. 系统提示此操作将禁用信息维护和权限管理功能 
3. 医务人员确认切换 
4. 系统调用电子病历系统接口 
5. 获取患者信息 
6. 系统更新显示内容 
扩展事件流 
4a. 接口调用失败： 
4a1. 系统提示“接口连接失败” 
4a2. 返回步骤1 
 
5a. 信息获取失败： 
5a1. 系统提示“数据获取失败” 
5a2. 返回步骤1 
非功能需求 
 
优先级 
高 
表3-3 “患者信息维护”用例规约 
用例名称 
患者信息维护 
执行者 
医生、科研工作者 
用例简述 
对系统中的患者基本信息进行创建、修改和删除 
前置条件 
用户已登录且具备相应权限且系统处于独立管理模式 
后置条件 
患者信息更新成功 
主事件流 
1. 医务人员请求维护患者信息 
2. 系统显示患者信息维护界面 
3. 医务人员输入/修改患者信息 
4. 系统验证信息的完整性和合法性 
5. 系统保存患者信息 
扩展事件流 
4a. 信息验证失败： 
4a1. 系统提示具体的错误信息 
4a2. 返回步骤3 
非功能需求 
 
优先级 
高 


## Page 32

电子科技大学硕士学位论文 
18 
表3-4 “患者信息查询”用例规约 
用例名称 
患者信息查询 
执行者 
医生、科研工作者 
用例简述 
根据条件查询患者信息 
前置条件 
用户已登录且具备查询权限 
后置条件 
显示符合条件的患者信息 
主事件流 
1. 医务人员输入查询条件 
2. 系统根据权限范围和查询条件检索患者信息 
3. 系统显示查询结果 
4. 医务人员可查看详细信息 
扩展事件流 
2a. 无符合条件的结果： 
2a1. 系统提示“未找到相关患者信息” 
2a2. 返回步骤1 
非功能需求 
支持多条件组合查询 
优先级 
中 
表3-5 “患者权限管理”用例规约 
用例名称 
患者权限管理 
执行者 
系统管理员、医院管理员 
用例简述 
管理医务人员对患者信息的访问权限 
前置条件 
管理员已登录系统 
后置条件 
成功设置用户权限 
主事件流 
1. 系统管理员选择用户 
2. 系统显示当前权限设置 
3. 系统管理员修改权限设置 
4. 系统保存新的权限设置 
扩展事件流 
 
非功能需求 
 
优先级 
高 
3.1.2 数据录入 
数据录入是系统的核心功能模块之一，作为医疗信息化平台的基础组件，它主
要由医生和科研工作者协同完成患者相关数据的采集、整理和上传工作。系统针对
临床实际需求，精心设计了直观高效的可视化数据录入界面，提供了多种便捷的数
据检索与管理方式。用户可以通过患者姓名进行快速精确搜索，实现目标患者信息
的迅速定位；同时系统支持灵活的数据类型选择功能，便于分类管理各种临床资料。


## Page 33

第三章 面向胎儿心脏的分割分类辅助诊断系统需求分析 
19 
此外，系统还集成了标准化的文件上传工具，支持多种格式医学数据的批量导入，
大大提高了数据录入效率。数据录入模块的主要功能用例如图3-2 所示： 
 
图3-2 数据录入模块用例图 
如图所示数据录入工作主要由医生和科研工作者进行。而系统管理员和医院
管理员作为管理层角色，被系统设置为不直接参与具体数据录入这一实操性行为，
这种职责划分符合医疗信息系统的权限分级管理原则。值得特别说明的是，系统的
角色系统被设计为允许同一用户存在多种角色，角色之间的权限去并集，后续会在
角色需求章节进行详细说明。数据录入这一行为主要发生在患者的基本信息已经
成功录入本系统，用户将患者通过超声、ECG 等数据采集手段采集到的数据进行
录入，以便于后续调用系统的预处理和辅助诊断算法。数据查询行为发生在用户通
过患者数据页面主动对数据进行查看。数据录入用例规约如表3-6 至表3-9 所示： 
表3-6 “查看数据”用例规约 
用例名称 
查看患者数据 
执行者 
医生、科研工作者 
用例简述 
查看系统中已建档的患者信息数据列表 
前置条件 
用户已登录且具备数据录入权限 
后置条件 
显示患者信息列表 
主事件流 
1. 用户进入数据录入界面 
2. 系统显示患者信息列表 
3. 用户浏览数据 
扩展事件流 
2a. 系统中无数据： 
2a1. 系统提示“该患者无数据” 
2a2. 用户上传患者数据 
非功能需求 
 
优先级 
高 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page33_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page33_img1.png)

## Page 34

电子科技大学硕士学位论文 
20 
表3-7 “搜索数据”用例规约 
用例名称 
搜索数据 
执行者 
医生、科研工作者 
用例简述 
根据数据名或数据类型搜索数据 
前置条件 
已显示患者信息列表 
后置条件 
显示搜索结果 
主事件流 
1. 用户输入数据名或筛选数据类型 
2. 系统根据输入内容搜索匹配的数据 
3. 系统显示搜索结果 
扩展事件流 
2a. 未找到匹配的数据 
2a1. 系统提示“未找到相关数据” 
 
2b. 匹配数据结果过多： 
2b1. 分页展示数据类型 
非功能需求 
支持模糊搜索 
搜索响应时间不超过1 秒 
优先级 
高 
表3-8 “选择数据类型”用例规约 
用例名称 
选择数据类型 
执行者 
医生、科研工作者 
用例简述 
选择要上传的数据类型 
前置条件 
已选择目标患者 
后置条件 
确定数据类型 
主事件流 
1. 用户点击上传按钮 
2. 系统显示数据类型选择界面 
3. 用户选择数据类型 
4. 系统确认数据类型选择 
扩展事件流 
3a. 未选择数据类型： 
3a1. 系统提示“请选择数据类型” 
3a2. 返回步骤3 
 
3b. 数据类型不存在： 
3b1. 系统提示“请联系管理员添加对应数据类型” 
3b2. 返回步骤3 
非功能需求 
 
优先级 
高 


## Page 35

第三章 面向胎儿心脏的分割分类辅助诊断系统需求分析 
21 
表3-9 “数据上传提交”用例规约 
用例名称 
数据上传提交 
执行者 
医生、科研工作者 
用例简述 
上传并提交患者相关数据 
前置条件 
已选择数据类型 
后置条件 
数据上传成功 
主事件流 
1. 用户选择要上传的文件 
2. 系统验证文件格式 
3. 用户点击提交按钮 
4. 系统上传并保存数据 
扩展事件流 
2a. 文件格式验证失败： 
2a1. 系统提示“不支持的文件格式” 
2a2. 返回步骤1 
非功能需求 
支持批量上传 
优先级 
高 
系统的数据录入功能设计了选择数据类型的约束，如果不能匹配上传数据类
型的数据，会导致上传失败。系统通过预设的数据类型对上传数据进行分类管理，
这种分类是基于数据用途而非数据格式，确保了数据的规范性和可追溯性。同时，
系统提供了直观的可视化界面和完整的操作流程提示，保证了数据录入工作的高
效性和准确性。 
3.1.3 数据预处理 
数据预处理模块主要负责对医学影像数据进行图像增强处理。处理后的图像
可用于后续辅助诊断任务。数据预处理模块的主要功能用例如图3-3 所示： 
 
图3-3 数据预处理模块用例图 
如图所示数据预处理工作主要由医生和科研工作者进行。数据预处理这一行
为发生在用户对患者数据进行数据预处理时。医生和科研工作者需要先根据患者



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page35_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page35_img1.png)

## Page 36

电子科技大学硕士学位论文 
22 
列表选择对应患者，查询并查看患者的已有数据来确定需要被预处理的数据，选择
希望的预处理方法后，等待预处理结果完成，查看预处理结果效果后可以选择保存
本次预处理结果到患者数据，也可以对本次预处理结果进行审核。系统对预处理算
法的每次调用都会被存入系统日志，方便后续溯源。在历史处理结果中，已废弃数
据会做出特别标记，但不会从记录中删除。数据预处理模块用例规约如表3-10 至
表3-13 所示： 
表3-10 “超声图像增强”用例规约 
用例名称 
超声图像增强 
执行者 
医生、科研工作者 
用例简述 
对超声图像进行分辨率增强 
前置条件 
用户已登录系统 
已选择超声图像数据 
后置条件 
生成超声增强结果 
主事件流 
1. 用户选择患者数据 
2. 系统执行先心病预测算法 
3. 系统生成增强结果 
4. 展示增强结果 
5. 进行结果审核 
扩展事件流 
 
非功能需求 
 
优先级 
高 
表3-11 “结果审核”用例规约 
用例名称 
结果审核 
执行者 
医生、科研工作者 
用例简述 
对预处理的结果进行审核 
前置条件 
已存在预处理结果 
后置条件 
确定处理结果的使用状态 
主事件流 
1. 医生查看处理结果 
2. 医生对结果进行评估 
3. 医生选择废弃结果 
4. 系统更新处理结果状态 
扩展事件流 
 
非功能需求 
 
优先级 
高 


## Page 37

第三章 面向胎儿心脏的分割分类辅助诊断系统需求分析 
23 
表3-12 “查看历史结果”用例规约 
用例名称 
查看历史结果 
执行者 
医生、科研工作者 
用例简述 
查看并检索系统中已处理过的预处理结果 
前置条件 
用户已登录系统 
后置条件 
显示满足条件的历史处理结果 
主事件流 
1. 用户进入历史结果查询界面 
2. 用户设置查询条件（如日期范围、处理类型、审核状态等） 
3. 系统检索符合条件的历史结果 
4. 系统以列表形式展示历史结果 
5. 用户选择特定结果查看详情 
扩展事件流 
3a. 无符合条件的结果： 
3a1. 系统提示“未找到符合条件的历史结果” 
3a2. 返回步骤2 
 
5a. 结果详情查看： 
5a1. 系统显示预处理历史结果 
5a2. 系统显示审核状态 
非功能需求 
支持多种条件组合检索 
优先级 
中 
表3-13 “患者数据录入”用例规约 
用例名称 
患者数据录入 
执行者 
医生、科研工作者 
用例简述 
录入用于预处理的患者数据 
前置条件 
用户已登录且具备数据录入权限 
后置条件 
数据保存成功 
主事件流 
1. 用户选择数据类型 
2. 上传相关数据 
3. 系统验证数据格式 
4. 系统保存数据并记录操作日志 
扩展事件流 
3a. 数据格式错误： 
3a1. 系统提示“数据格式错误” 
3a2. 返回步骤2 
 
3b. 数据上传因网络原因中断： 
3b1. 系统提示“数据上传失败” 
3b2. 返回步骤2 
非功能需求 
支持批量上传 
优先级 
高 


## Page 38

电子科技大学硕士学位论文 
24 
3.1.4 辅助诊断 
指辅助诊断是系统的核心功能模块之一，主要包含基于心电的先心病预测和
全心脏分割两个智能诊断算法。辅助诊断模块的主要功能用例如图3-4 所示： 
 
图3-4 辅助诊断模块用例图 
如图所示，辅助诊断工作主要由医生和科研工作者进行。与数据预处理类似，
辅助诊断这一行为发生在用户对患者数据进行辅助诊断时。医生和科研工作者需
要先选择对应患者，通过查看患者的数据来确定输入数据，选择希望应用的辅助诊
断方法后，等待辅助诊断过程完成，查看辅助诊断结果后可以选择保存本次结果，
也可以对本次结果进行审核。系统对辅助诊断算法的调用都会被存入日志，方便后
续溯源。在历史记录中，已废弃结果会做出特别标记，但不会从记录中删除。辅助
诊断模块用例规约如表3-14 至表3-18 所示： 
表3-14 “基于心电的先心病预测”用例规约 
用例名称 
基于心电的先心病预测 
执行者 
医生、科研工作者 
用例简述 
通过心电数据进行先心病预测 
前置条件 
用户已登录系统 
已选择心电数据 
后置条件 
生成预测分析结果 
主事件流 
1. 用户选择患者数据 
2. 系统执行先心病预测算法 
3. 系统生成预测结果 
4. 展示预测结果 
5. 进行结果审核 
扩展事件流 
 
非功能需求 
 
优先级 
高 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page38_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page38_img1.png)

## Page 39

第三章 面向胎儿心脏的分割分类辅助诊断系统需求分析 
25 
表3-15 “全心脏分割”用例规约 
用例名称 
全心脏分割 
执行者 
医生、科研工作者 
用例简述 
对CT/MR 心脏图像进行全心脏分割 
前置条件 
用户已登录系统 
已选择患者CT/MR 影像数据 
后置条件 
生成心脏分割结果 
主事件流 
1. 用户选择CT/MR 影像数据 
2. 系统执行心脏分割算法 
3. 系统生成分割结果 
4. 展示结果 
5. 进行结果审核 
扩展事件流 
 
非功能需求 
 
优先级 
高 
表3-16 “患者数据录入”用例规约 
用例名称 
患者数据录入 
执行者 
医生、科研工作者 
用例简述 
录入用于辅助诊断的患者数据 
前置条件 
用户已登录且具备数据录入权限 
后置条件 
数据保存成功 
主事件流 
1. 用户选择数据类型 
 
2. 上传相关数据 
3. 系统验证数据格式 
4. 系统保存数据并记录操作日志 
扩展事件流 
3a. 数据格式错误： 
3a1. 系统提示“数据格式错误” 
3a2. 返回步骤2 
 
3b. 数据上传因网络原因中断： 
3b1. 系统提示“数据上传失败” 
3b2. 返回步骤2 
非功能需求 
支持批量上传 
优先级 
高 


## Page 40

电子科技大学硕士学位论文 
26 
表3-17 “结果审核”用例规约 
用例名称 
结果审核 
执行者 
医生、科研工作者 
用例简述 
对辅助诊断的结果进行审核 
前置条件 
已存在辅助诊断结果 
后置条件 
确定处理结果的使用状态 
主事件流 
1. 医生查看处理结果 
2. 医生对结果进行评估 
3. 医生选择废弃结果 
4. 系统更新处理结果状态 
扩展事件流 
 
非功能需求 
 
优先级 
高 
表3-18 “查看历史结果”用例规约 
用例名称 
查看历史结果 
执行者 
医生、科研工作者 
用例简述 
查看并检索系统中已处理过的辅助诊断结果 
前置条件 
用户已登录系统 
后置条件 
显示满足条件的历史处理结果 
主事件流 
1. 用户进入历史结果查询界面 
2. 用户设置查询条件（如日期范围、处理类型、审核状态等） 
3. 系统检索符合条件的历史结果 
4. 系统以列表形式展示历史结果 
5. 用户选择特定结果查看详情 
扩展事件流 
3a. 无符合条件的结果： 
3a1. 系统提示“未找到符合条件的历史结果” 
3a2. 返回步骤2 
 
5a. 结果详情查看： 
5a1. 系统显示辅助诊断历史记录 
5a2. 系统显示审核状态 
非功能需求 
支持多种条件组合检索 
优先级 
中 
本模块通过两个智能算法为医生提供辅助诊断支持：基于心电的先心病预测
算法可帮助医生更准确地确定病种；全心脏分割算法则有助于确定心脏病的位置
和程度。系统支持医生和科研工作者对诊断所需数据进行录入，但仅允许医生对已


## Page 41

第三章 面向胎儿心脏的分割分类辅助诊断系统需求分析 
27 
录入数据进行删除操作。所有的数据操作都会被系统记录在操作日志中，被删除数
据不会被物理删除，而是通过状态标记进行管理，这种设计既保证了数据的完整性
和可追溯性，又满足了临床使用的需求。 
 基本功能需求 
该系统需要建立完善的用户、角色和数据管理机制来支撑系统的正常运行。用
户管理确保系统使用者的身份认证与权限分配；角色管理实现不同用户群体的权
限划分和管理；数据管理则通过数据类别的维护来规范数据的使用和访问。这些基
础功能共同构建了系统安全可靠运行的基础架构。本小节将介绍系统基础用户需
求与系统的预期使用流程。 
3.2.1 系统用户管理 
随着网络快速发展，系统若在设计初期缺乏统一的用户管理功能，将会在用户
数量持续增长后面临管理混乱问题，因此一个完善的系统用户管理统一入口至关
重要。系统用户管理模块的主要功能用例如图3-5 所示： 
 
图3-5 系统用户管理模块用例图 
如图所示，系统用户管理模块分为三部分。医生和科研工作者作为系统普通参
与者，其用户管理权限仅限于账户登录、注册、个人信息修改和密码找回。医院管
理员在拥有普通参与者权限的同时，拥有添加和编辑所属医院下其他用户的信息



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page41_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page41_img1.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page41_img2.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page41_img2.png)

## Page 42

电子科技大学硕士学位论文 
28 
的权限，此外，还拥有对自己所属医院组织结构以下的医院管理权限。系统管理员
除拥有普通参与者和医院管理员的权限外，还具有医院整体组织架构的管理权限，
包括医院的新增删除和科室的新增删除。值得注意的是，只有在对应医院或科室下
无任何用户账户时，才能进行删除操作。以上所有角色对用户管理模块的任何修改
均会记录在后台日志中。系统用户管理模块用例规约如表3-19 至表3-25 所示： 
表3-19 “用户管理”用例规约 
用例名称 
用户管理 
执行者 
系统管理员、医院管理员 
用例简述 
该用例描述了系统管理员或医院管理员角色对用户信息的管理过程 
前置条件 
操作者账户被分配了系统管理员或者医院管理员角色 
后置条件 
 
主事件流 
账号查看： 
1. 管理员登录系统并请求用户管理页面 
2. 系统分页展示系统中存在的用户账号及部分系统必要属性，如用户
姓名、用户所属角色、账号创建时间和上次登陆时间等 
3. 管理员请求查看账号详情 
4. 系统跳转并完整展示该账号的信息，包括了非必填信息，比如用户
性别、用户年龄和个人描述等属性 
 
账号创建： 
1. 管理员登录系统并请求用户管理页面 
2. 系统分页展示系统中存在的用户账号部分系统必要属性 
3. 管理员请求创建新的账号 
4. 系统展示账号创建页面 
5. 管理员按照提示框填写账号、登录密码及其余必填用户属性后提交
创建 
6. 系统对新账号的属性进行校验 
 
账号删除： 
1. 管理员登录系统并请求用户管理页面 
2. 系统分页展示系统中存在的用户账号及部分系统必要属性 
3. 管理员请求删除某用户账号 
4. 系统提示管理员是否确认屏删除账号 
5. 管理员确认删除，系统标记该账号为删除状态，禁止该账号后续登
入系统 
扩展事件流 
账号创建： 
6a. 账号属性校验不通过： 
6a1. 系统提示对应有误属性并通过弹出框提示“请核对属性内容” 
6a2. 返回步骤4 
非功能需求 
 
优先级 
高 


## Page 43

第三章 面向胎儿心脏的分割分类辅助诊断系统需求分析 
29 
表3-20 “账户信息管理”用例规约 
用例名称 
账户信息管理 
执行者 
系统管理员、医院管理员 
用例简述 
该用例描述了系统管理员或者医院管理员角色对用户账户信息的编辑 
前置条件 
该用户具备系统管理员或者医院管理员角色 
后置条件 
 
主事件流 
账户信息查看： 
1. 管理员登录系统并请求查看用户管理页面 
2. 系统分页展示系统中存在的用户账号及部分系统必要属性 
3. 管理员请求查看账号详情 
4. 系统跳转并完整展示该账号的个人信息 
 
账户信息修改： 
1. 管理员登录系统并请求查看用户管理页面 
2. 系统分页展示系统中存在的用户账号及部分系统必要属性 
3. 管理员请求查看账号详情 
4. 系统跳转并完整展示该账号的相关账户信息 
5. 管理员请求修改账户信息 
6. 系统跳转到信息修改页面 
7. 管理员提交修改好的账户信息 
8. 系统校验新的账号个人信息，校验通过就保存新的账户信息，覆盖
原信息，同时记录修改的操作 
扩展事件流 
 
非功能需求 
 
优先级 
高 
表3-21 “登出”用例规约 
用例名称 
登出 
执行者 
全体用户 
用例简述 
该用例描述了用户登出系统的流程 
前置条件 
访问者已经完成了系统的登录流程 
后置条件 
删除用户登录缓存 
主事件流 
1. 用户在任意页面请求登出系统 
2. 系统提示用户是否确认登出账号 
3. 用户确认登出 
4. 系统跳转到登录页面 
扩展事件流 
 
非功能需求 
 
优先级 
中 


## Page 44

电子科技大学硕士学位论文 
30 
表3-22 “登录”用例规约 
用例名称 
登录 
执行者 
全体用户 
用例简述 
该用例描述了系统全体用户利用账号和密码登陆系统的过程 
前置条件 
访问者持有有效的系统账号密码 
访问者账号密码所属用户角色拥有登陆页面路由权限 
后置条件 
 
主事件流 
1. 用户请求访问系统 
2. 系统跳转到登录页面 
3. 用户输入账号和密码，并提交系统验证 
4. 系统对账号和密码进行验证，验证通过后，跳转到系统大盘首页 
扩展事件流 
2a. 用户没有登出账号，且在令牌过期时间内再次对系统进行访问： 
2a1. 用户将省略登陆流程，系统检查浏览器缓存中的用户令牌，用户
令牌信息有效则直接跳转到用户的角色对应首页 
 
4a. 账号或者密码验证不通过： 
4a1. 系统提示用户“账号或者密码有误” 
4a2. 返回步骤3 
 
4b. 手机验证码验证不通过： 
4b1. 系统提示用户“手机验证码有误” 
4b2. 返回步骤3 
非功能需求 
 
优先级 
高 
表3-23 “登出”用例规约 
用例名称 
登出 
执行者 
全体用户 
用例简述 
该用例描述了用户登出系统的过程 
前置条件 
访问者处于登陆状态 
后置条件 
删除用户的服务器令牌缓存 
主事件流 
1. 用户在任意页面通过“登出”按钮请求登出系统 
2. 系统提示用户是否确认登出账号 
3. 用户确认登出 
4. 系统跳转到登录页面 
扩展事件流 
3a. 用户在二次确认中点击“取消”按钮： 
3a1. 系统取消登出系统 
非功能需求 
 
优先级 
中 


## Page 45

第三章 面向胎儿心脏的分割分类辅助诊断系统需求分析 
31 
表3-24 “注册”用例规约 
用例名称 
注册 
执行者 
全体用户 
用例简述 
该用例描述了全体用户在系统中注册账号的过程 
前置条件 
用户处于未登录状态 
后置条件 
 
主事件流 
1. 访问者请求访问系统 
2. 系统没有检查到浏览器中存在有效令牌信息 
3. 跳转到登录/注册页面 
4. 访问者点击“注册”按钮进行账号注册 
5. 系统跳转到账号注册页面 
6. 用户完善所有注册所需的系统必要信息后提交 
7. 系统对提交的信息进行验证 
8. 验证通过后，系统保存提交信息，并创建相应的新用户账号 
扩展事件流 
7a. 用户提交信息验证不通过或者不匹配： 
7a1. 系统提示验证不通过的详情 
7a2. 返回步骤4 
非功能需求 
 
优先级 
中 
表3-25 “密码找回”用例规约 
用例名称 
密码找回 
执行者 
全体用户 
用例简述 
该用例描述了全体用户在访问系统时找回密码的过程 
前置条件 
 
后置条件 
 
主事件流 
1. 访问者请求访问系统 
2. 系统没有检查到浏览器中存在有效令牌信息 
3. 跳转到登录/注册页面 
4. 用户点击“忘记密码”请求密码找回 
5. 系统跳转到密码找回页面 
6. 用户按照提示输入自身账号信息并提交系统验证 
7. 用户提交新密码 
8. 系统保存新密码并覆盖原始密码，记录该密码修改操作 
扩展事件流 
7a. 系统验证不通过： 
7a1. 系统提示用户系统不通过的详情 
7a2. 返回步骤4 
非功能需求 
 
优先级 
高 


## Page 46

电子科技大学硕士学位论文 
32 
在这样多级权限的管理机制下，系统管理员和医院管理员可以在各自的权限
范围内对用户进行有效管理，而一般用户也能够通过完善的基础功能实现系统的
正常使用。系统通过严格的信息验证机制、完整的操作日志记录以及合理的权限分
配，有效防止了用户管理混乱和系统资源浪费的问题，确保了系统的安全性和可靠
性。 
3.2.2 系统角色管理 
系统角色管理是系统重要的基础功能之一，主要由管理员负责对系统角色进
行维护和管理。系统支持角色的直接创建和权限配置，确保系统运行的安全性和可
控性。此外，系统角色管理还支持角色继承和组合机制，大大降低了权限管理的复
杂度，提高了管理效率。角色变更记录的完整审计日志功能，则为系统安全提供了
可追溯性保障。系统角色管理模块的主要功能用例如图3-6 所示： 
 
图3-6 系统角色管理用例图 
系统的角色管理模块相关操作权限仅对系统管理员这一最高级别的角色开放。
系统管理员可查看系统中现有角色，并进行角色管理，包括新增、删除、禁用和启
用角色。值得特别说明的是，基于“最小权限原则”的安全设计理念，系统中新增
的角色初始状态下不具备任何路由和接口权限，这意味着该角色无法访问任何系
统页面或调用任何系统接口。这种“白名单”式的权限控制模式可以大大降低权限
配置错误带来的安全风险，确保每个角色只能获得经过明确授权的访问能力。系统
管理员拥有编辑现有角色路由权限和接口权限的完整能力。在实际应用中，管理员
可以根据业务需求和组织变化，动态调整各角色的权限边界，包括增加新的访问权
限或收回不再需要的权限。系统角色管理模块用例规约如表3-26 至表3-30 所示： 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page46_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page46_img1.png)

## Page 47

第三章 面向胎儿心脏的分割分类辅助诊断系统需求分析 
33 
表3-26 “角色信息查看”用例规约 
用例名称 
角色信息查看 
执行者 
系统管理员 
用例简述 
系统管理员查看系统中所有角色的相关信息 
前置条件 
系统管理员已登录系统 
后置条件 
显示角色信息列表 
主事件流 
1. 管理员进入角色管理界面 
2. 系统展示角色列表，包含角色名称、创建时间、权限配置等信息 
3. 管理员可通过角色名称和创建时间进行搜索 
4. 系统根据搜索条件过滤并显示结果 
扩展事件流 
4a. 无匹配结果： 
4a1. 系统提示“未找到匹配角色” 
 
4b. 匹配数据结果过多： 
4b1. 分页展示数据类型 
非功能需求 
列表加载时间不超过1 秒 
优先级 
高 
表3-27 “删除角色”用例规约 
用例名称 
删除角色 
执行者 
系统管理员 
用例简述 
删除系统中已存在的角色 
前置条件 
管理员已登录系统 
角色存在且可删除 
后置条件 
角色成功删除并清理相关数据 
主事件流 
1. 管理员选择要删除的角色 
2. 系统检查角色是否可删除 
3. 系统显示删除确认提示 
4. 管理员确认删除操作 
5. 系统执行删除流程 
6. 系统显示删除结果 
扩展事件流 
2a. 角色不可删除： 
2a1. 系统提示“该角色不可删除” 
2a2. 终止删除流程 
 
5a. 删除过程异常： 
5a1. 系统回滚已执行的操作 
5a2. 提示“删除失败” 
非功能需求 
删除前进行二次确认 
优先级 
高 


## Page 48

电子科技大学硕士学位论文 
34 
表3-28 “角色权限配置”用例规约 
用例名称 
角色权限配置 
执行者 
管理员 
用例简述 
系统管理员配置角色的路由权限和接口权限 
前置条件 
系统管理员已登录系统 
角色已创建 
后置条件 
完成权限配置并生效 
主事件流 
1. 管理员选择目标角色 
2. 系统显示当前角色权限配置 
3. 管理员选择权限配置类型设置 
4. 展示路由权限配置/接口权限配置 
5. 管理员对所选类型的权限进行配置 
4. 提交配置 
5. 系统保存并更新权限配置 
扩展事件流 
4a. 权限冲突： 
4a1. 系统提示冲突详情 
4a2. 返回步骤3 
非功能需求 
支持批量授权操作 
优先级 
高 
表3-29 “新建角色”用例规约 
用例名称 
新建角色 
执行者 
系统管理员 
用例简述 
系统管理员创建新的系统角色并进行初始化配置 
前置条件 
系统管理员已登录系统 
后置条件 
新角色创建成功并完成初始配置 
主事件流 
1. 管理员选择新建角色操作 
2. 系统显示角色创建表单 
3. 管理员填写角色信息 
4. 管理员进行初始权限配置 
5. 提交创建请求 
6. 系统验证并保存角色信息 
扩展事件流 
4a. 管理员跳过初始权限配置 
4a1 角色权限初始化为空 
5a. 角色名称重复： 
5a1. 系统提示“角色名称已存在” 
5a2. 返回步骤3 
非功能需求 
角色编码唯一性校验 
优先级 
高 


## Page 49

第三章 面向胎儿心脏的分割分类辅助诊断系统需求分析 
35 
表3-30 “删除角色”用例规约 
用例名称 
删除角色 
执行者 
系统管理员 
用例简述 
删除系统中已存在的角色 
前置条件 
管理员已登录系统 
角色存在且可删除 
后置条件 
角色成功删除并清理相关数据 
主事件流 
1. 管理员选择要删除的角色 
2. 系统检查角色是否可删除 
3. 系统显示删除确认提示 
4. 管理员确认删除操作 
5. 系统执行删除流程 
6. 系统显示删除结果 
扩展事件流 
2a. 角色不可删除： 
2a1. 系统提示“该角色不可删除” 
2a2. 终止删除流程 
 
5a. 删除过程异常： 
5a1. 系统回滚已执行的操作 
5a2. 提示“删除失败” 
非功能需求 
删除前进行二次确认 
优先级 
高 
系统角色管理模块提供了完善的角色管理功能，支持管理员直接创建和管理
角色，并进行细粒度的权限控制，支持对路由权限和接口权限进行精确配置。同时，
系统支持对已有角色进行新增，方便后期根据用户人群加入新的角色来满足权限
控制需求。该模块的设计既保证了系统的安全性，又提供了足够的灵活性。 
3.2.3 系统数据管理 
系统数据管理作为整个医疗信息平台的基础支撑功能模块，在数据录入与算
法调用之间构建了至关重要的桥梁作用。该模块主要通过精细化的数据类别管理
机制，实现对医疗数据访问权限和使用流程的全方位控制与监管。在应用中，系统
建立了数据分类体系，使不同类型的医疗数据能够被标记和管理。这种数据类别管
理的核心优势在于其与辅助诊断算法和数据预处理算法之间建立了明确的映射关
系。通过这种映射关系，系统能够确保各类算法模块只能访问其被授权处理的特定
数据类别和具备相应权限的患者数据集。这种设计不仅提高了数据处理的精准性
和效率，更从技术架构层面保障了患者隐私和医疗数据的安全性。 


## Page 50

电子科技大学硕士学位论文 
36 
这种基于类别的数据管理模式也为系统的可扩展性提供了坚实基础，随着新
的医疗数据类型和不同算法模块的引入，系统可以通过简单扩展数据类别和权限
映射关系，快速适应可扩展性需求。系统数据管理模块的主要功能用例如图3-7 所
示： 
 
图3-7 系统数据管理用例图 
如图所示，系统数据管理功能用例在权限设置上采取了严格的分级控制策略，
仅对系统管理员和医院管理员这两类高级管理角色开放操作权限，医生和科研工
作者虽然是系统的主要使用者，但不参与数据类别的定义和管理工作。系统中设定
的数据类别区别于文件的格式类别，系统定义的数据类别更准确地说是面向医疗
领域特定算法的专业数据分类体系，它们直接映射到临床实践中的医疗数据类型。
例如，在心脏相关检查中，系统建立了心音、心电、心动、心脏MR、心脏CT 和
心脏超声等专业数据类别。在每个数据类别内部，系统进一步细化定义了对应的具
体输入输出文件格式规范。系统中的各类辅助诊断算法模块在集成到平台时，必须
明确绑定其适用的特定数据类别，这一强制性绑定机制确保了算法与数据之间的
匹配度和兼容性，也有利于系统对医生和科研人员调用算法时进行输入数据预检
测。通过这种严格的数据类别管理机制，当医生和科研人员在临床工作中调用算法
时，系统能够自动引导他们选择符合要求的规范化输入数据，大大降低了操作错误
率，提高了算法应用的准确性和一致性。系统数据管理模块用例规约如表3-31 至
表3-33 所示： 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page50_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page50_img1.png)

## Page 51

第三章 面向胎儿心脏的分割分类辅助诊断系统需求分析 
37 
表3-31 “数据类别查询”用例规约 
用例名称 
数据类别查询 
执行者 
系统管理员、医院管理员 
用例简述 
查看和搜索系统中的数据类别信息 
前置条件 
管理员已登录系统 
后置条件 
显示数据类别信息 
主事件流 
1. 管理员进入数据管理界面 
2. 系统展示数据类别列表 
3. 管理员通过类别名称搜索 
4. 系统显示搜索结果 
扩展事件流 
4a. 无匹配结果： 
4a1. 系统提示“未找到相关数据类别” 
非功能需求 
搜索响应时间不超过1 秒 
支持模糊搜索 
优先级 
高 
表3-32 “数据类别维护”用例规约 
用例名称 
数据类别维护 
执行者 
系统管理员、医院管理员 
用例简述 
对系统数据类别进行新增、修改和删除操作 
前置条件 
管理员已登录系统 
后置条件 
完成数据类别维护并同步结果 
主事件流 
1. 管理员选择操作类型（新增/修改/删除） 
2. 系统显示相应操作界面 
3. 管理员输入或修改信息 
4. 系统验证输入数据 
5. 系统保存更改并同步结果 
扩展事件流 
4a. 数据验证失败： 
4a1. 系统提示具体错误信息 
4a2. 返回步骤3 
 
5a. 保存失败： 
5a1. 系统提示“操作失败” 
5a2. 返回步骤3 
非功能需求 
变更操作需要二次确认 
删除操作不能造成算法出现无数据类别的情况 
优先级 
高 


## Page 52

电子科技大学硕士学位论文 
38 
表3-33 “算法映射管理”用例规约 
用例名称 
算法映射管理 
执行者 
系统管理员、医院管理员 
用例简述 
管理数据类别与辅助算法、预处理算法的映射关系 
前置条件 
管理员已登录系统 
后置条件 
完成算法映射配置 
主事件流 
1. 管理员选择数据类别 
2. 系统显示当前映射关系 
3. 管理员配置算法映射 
4. 系统验证配置有效性 
5. 保存映射关系 
扩展事件流 
4a. 配置验证失败： 
4a1. 系统提示“配置无效” 
4a2. 返回步骤3 
非功能需求 
支持批量配置 
优先级 
高 
本模块通过对数据类别的管理，实现了数据访问和使用的精细化控制。每个数
据类别都与特定的辅助算法和预处理算法建立映射关系，确保数据的合理使用。同
时，通过严格的权限控制机制，保证算法模块只能访问其所属类别和具有查看权限
的患者数据，有效保障了数据安全和隐私保护。系统支持管理员通过可视化界面进
行数据类别的维护和算法映射的配置，并通过完整的操作日志记录保证了管理操
作的可追溯性。 
 非功能需求 
（1）性能需求：本系统作为面向胎儿心脏的多模态辅助诊断平台，需要处理包
括心音数据、心动数据和超声图像在内的多维医疗数据，这对系统的实时处理能力
和计算性能提出了较高要求。在用户交互方面，系统的基础操作（如数据检索、页
面导航等）响应时间必须严格控制在1 秒以内，以确保良好的操作体验，对于数据
的上传下载，由于此部分接口主要受限于客户端网络传输速度，故只做成功的约束，
不对时间进行要求。对于涉及人工智能算法的辅助诊断任务，考虑到不同算法之间
的任务复杂度、数据传输量和数据计算量的差距较大，无法设定统一的响应时间约
束，故只做成功约束，不对时间进行要求。为保证系统的并发处理能力，即使在达
到最大用户访问量和计算负载的情况下，系统也必须严格遵守上述性能指标，确保
诊断服务的及时性和稳定性。 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page52_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page52_img1.png)

## Page 53

第三章 面向胎儿心脏的分割分类辅助诊断系统需求分析 
39 
（2）环境需求：本系统作为医疗辅助诊断平台，对运行环境有较高要求。服务
器端需要配置高性能的GPU 设备以支持AI 算法的运行，推荐使用NVIDIA A100
或性能相当及以上的显卡集群部署。系统采用主流的开发技术和工具平台，服务器
端基于Linux 环境部署，开发语言主要采用Java 和Python。客户端支持Windows
和MacOS 系统，兼容Chrome、Edge、FireFox 等主流浏览器，确保医生和研究人
员能够方便地访问和使用系统。 
（3）可靠性需求：本系统处理的是医疗诊断数据，可靠性至关重要。系统需要
具备较高的可靠性和可控性，能够支持24 小时不间断运行。可靠性主要体现在以
下几个方面：首先是压力承载能力，系统通过负载均衡和分布式处理技术提高并发
处理能力；其次是故障恢复能力，系统具备完善的数据备份和故障恢复机制；最后
是服务持续性，确保在系统维护或出现故障时不影响核心服务的提供。 
（4）可维护性需求：系统设计需要充分考虑后期维护的便利性。数据库和业务
应用的设计应当满足可扩展性需求，能够及时适应业务流程的变化和新数据类型
的接入。系统架构采用模块化设计，降低模块间耦合度，使得在需要修改或升级某
个功能时不会影响其他模块的正常运行。同时，系统需要提供完善的日志记录机制，
包括操作日志、系统日志和错误日志，便于问题定位和系统维护。 
（5）可扩展性需求：考虑到医疗技术和AI 算法的快速发展，系统必须具备良
好的可扩展性。在功能方面，系统需要支持新的AI 算法模块和医疗设备的接入；
在性能方面，数据存储方案要能支持数据量的持续增长；在接口设计上，需要预留
与其他医疗系统对接的接口。 
（6）安全性需求：由于系统涉及患者的敏感医疗数据，安全性要求极高。系统
必须严格遵循医疗行业的数据安全标准，采用先进的加密技术保护数据传输和存
储安全。系统应保证数据的可靠性和真实性，防止核心数据被非法访问或篡改。同
时，系统需要实现用户权限控制，确保用户只能访问其权限范围内的数据。 
（7）权限需求：系统需要实现严格的权限管理机制，根据不同用户角色分配相
应的操作权限。 
 本章小结 
本章详细阐述了系统的功能需求和非功能性需求。在非功能性需求方面，从性
能、环境、可靠性、可维护性、可扩展性、安全性和权限管理等多个维度进行了系
统设计约束的定义。这些需求的规范确保了系统能够安全、稳定、高效地运行，为
面向胎儿心脏疾病的预处理和辅助诊断过程提供可靠的技术支持。合理的需求分
析与设计，也会为后续系统的开发实现奠定基础。



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page53_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page53_img1.png)

## Page 54

电子科技大学硕士学位论文 
40 
面向胎儿心脏的分割分类辅助诊断系统架构设计 
 体系结构设计 
本节从系统整体架构的角度进行分析，重点从宏观的模块方面介绍系统功能
框架，包括系统不同模块间的交互、业务流程和系统数据库设计等内容。 
4.1.1 技术架构 
系统采用前后端分离的B/S 架构模式，整体架构如图4-1 所示： 
 
图4-1 系统整体架构图 
如上图所示，该系统采用分层架构设计，从上至下依次展示了系统的整体结构。
最上层是系统的用户接入层，主要包含四个主要用户角色：系统管理员、医疗单位、



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page54_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page54_img1.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page54_img2.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page54_img2.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page54_img3.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page54_img3.png)

## Page 55

第四章 面向胎儿心脏的分割分类辅助诊断系统架构设计 
41 
医生和科研工作者。系统管理员模块具备用户管理、系统管理以及自定义功能权限
等核心功能；医疗单位模块主要负责用户管理和自定义功能权限；医生和科研工作
者模块则专注于业务执行层面的操作。这些模块通过Https 协议与下层系统进行安
全通信。 
在网络防护层，系统配备了两个关键的安全模块：防火墙和DDoS 防御系统。
防火墙负责对进出系统的网络流量进行监控和过滤，确保只有合法的访问请求能
够通过；DDoS 防御模块则专门用于抵御分布式拒绝服务攻击，保障系统的稳定运
行和服务可用性。 
负载均衡层是系统的核心调度区域，包含了网关、鉴权、限流和缓存四个重要
组件。网关模块负责请求的转发和路由；鉴权模块确保用户访问的合法性；限流模
块防止系统被过量请求所影响；缓存模块则提供了数据快速访问的能力，提升系统
整体性能。 
在应用层，系统部署了六个独立的微服务：文件服务器、数据库服务器、日志
服务器、缓存服务器、业务服务器和监控服务器。这些服务相互独立又协同工作，
文件服务器负责系统文件的存储和管理；数据库服务器提供系统数据持久化支持，
包括角色控制，权限控制，文件数据元数据等内容；日志服务器记录系统运行状态，
主要数据来源是由监控系统定时抓取系统指标以及用户对系统进行的操作记录组
成；缓存服务器提供高速数据访问，缓存用户的权限表、缩略图文件和算法运行结
果等内容；业务服务器处理核心业务逻辑；监控服务器则实时监控整个系统的运行
状态。这种微服务架构设计使得系统具有良好的可扩展性和维护性。 
 模块概要设计 
本小节将全面介绍系统的各个功能模块及其内部结构，采用由大到小、自顶向
下的层次分解方法，系统性地展现整体架构与具体功能单元间的逻辑关联。在模块
划分过程中，将严格遵循软件工程学中的低耦合性、高内聚性设计原则，确保各功
能模块既能相对独立地完成特定任务，又能通过标准化接口与其他模块进行有效
协作。首先对主要功能模块进行宏观介绍，随后将深入到每个模块的子功能，详细
阐述其功能定位、实现机制和交互方式。 
这种结构化和独立化的功能设计不仅提高了系统的可维护性和可扩展性，也
为后续开发过程中的任务分配和进度管理提供了依据。系统结构图作为整体架构
的可视化表达，清晰地确立了系统的各个关键功能点及其层次关系，使得系统的功
能边界和实现路径得到界定。本系统的模块结构如图4-2 所示： 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page55_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page55_img1.png)

## Page 56

电子科技大学硕士学位论文 
42 
 
图4-2 系统模块结构图 
如上图所示，整个系统的功能可划分为七个模块，每个模块都由多个功能模块
组成。其中核心模块为系统管理模块、患者管理模块、系统业务模块、数据管理模
块和日志监控模块。核心模块功能如表4-1 所示： 
表4-1 系统主模块介绍 
主模块 
说明 
系统管理 
该模块是系统的基础支撑模块，负责系统的用户管理、角色管理和数据类别
管理。用户管理实现对系统用户的精细化管理；角色管理实现不同用户群体
的权限划分；数据类别管理则通过类别维护来规范数据的使用和访问。 
患者管理 
该模块提供两种患者信息管理方式：一是通过接口与电子病历系统对接实现
信息同步，该方式下不能对患者进行直接管理；二是使用独立的患者信息存
储系统。模块包含患者信息维护、查询和权限管理等功能，通过唯一身份识
别码关联患者信息。 
系统业务 
该模块主要包括预处理和辅助诊断两部分业务内容。预处理主要为超声图像
增强。辅助诊断部分包含基于心电的先心病预测和全心脏分割两个智能诊断
算法。 
数据录入 
该模块负责患者相关数据的采集和上传工作，提供可视化的数据录入界面。
模块支持数据类型选择、文件上传和数据验证等功能，确保数据录入的规范
性和准确性。其类目划分是基于数据用途而非数据格式进行分类，数据格式
则在系统后台与类目形成映射。 
数据库 
该模块是系统的数据存储基础设施，采用多数据库协同架构。MySQL 负责
关系型数据的存储，包括用户信息、系统配置等结构化数据；MinIO 作为对
象型存储专门负责大容量和非结构化数据存储；MongoDB 则专注于系统日
志的存储。Redis 作为内存型数据库和日志模块组成系统缓存部分。 
日志监控 
日志监控模块主要分为两部分，即日志部分和监控部分，日志部分不但会对
系统操作进行记录，还会对系统业务部分的算法调用过程和调用结果进行存
储。监控部分由监控系统定期抓取系统的运行指标。 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page56_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page56_img1.png)

## Page 57

第四章 面向胎儿心脏的分割分类辅助诊断系统架构设计 
43 
本系统采用模块化设计思想，各功能模块既相对独立又紧密协作。系统管理模
块为其他功能模块提供基础支撑；患者管理模块确保患者信息的完整性和一致性；
数据预处理模块为辅助诊断提供高质量的处理后数据；辅助诊断模块则通过智能
算法为医生提供决策支持；数据录入模块则保证了数据获取的规范性和可靠性。通
过这种模块化的设计，系统实现了功能的高内聚和低耦合，提高了系统的可维护性
和扩展性。 
 接口设计 
本节将主要介绍系统的接口设计。在现代软件工程理论与实践中，接口通常被
系统性地分为三大类：外部系统调用接口、内部组件交互接口和人机交互接口。这
种分类的主要目的是展示软件系统的交互层次，体现数据流转的不同维度。因系统
功能模块较多，模块之间接口存在较多重复性，在此仅对本系统的部分核心接口设
计进行介绍。 
接口概要设计将主要包含：交互机制设计、接口技术选择和接口定义格式这三
类，如表4-2 所示： 
表4-2 接口概要设计元素 
步骤 
元素 
描述 
交互机制设计 
时机 
该元素说明了接口触发的时机 
发起 
该元素指明了接口调用发起者 
返回方式 
该元素说明了接口返回方式，例如同步还是异步返回数
据 
错误应对 
该元素说明了接口出错时应该如何处理，如重试、数据
核对等 
接口技术选择 
技术 
该元素说明了接口实现采用何种技术，如RESTful API
或WebSocket 
报文 
该元素说明了接口内容采用何种技术，如JSON 或XML
格式 
安全性 
该元素说明了接口实现的安全领域的非功能性需求，如
认证和加密 
接口定义格式 
编程语言 
该元素说明了接口实现采用的编程细节，如函数名和参
数等 
通信协议 
该元素说明了接口交互过程中Http 通信协议的定义细节 
由于本系统设计了与医院现有电子病历系统的对接功能，因此系统内构建了
规范化的外部系统调用接口。这类接口作为系统与外部医疗信息环境连接的桥梁，



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page57_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page57_img1.png)

## Page 58

电子科技大学硕士学位论文 
44 
相较于内部接口存在更大的安全性风险，系统内接口设计更多参考了现有电子病
历系统的数据传输规范。核心外部系统调用接口如表4-3 所示： 
表4-3 电子病历系统对接接口 
步骤 
元素 
描述 
交互机制设计 
时机 
当医务人员需要同步患者信息时 
发起 
医务人员 
返回方式 
同步返回 
错误应对 
记录错误日志，提示用户接口连接失败 
接口技术选择 
技术 
RESTful API 
报文 
JSON 格式 
安全性 
需要认证token，数据传输加密 
接口定义格式 
编程语言 
GET /api/v1/patients/{id} 
通信协议 
Http/Https 
同时，作为面向医生和科研人员等专业用户群体的医疗辅助系统，人机交互接
口的设计尤为关键。这类接口直接决定了用户体验的质量和工作效率。本系统内部
各功能模块之间存在复杂的数据依赖与业务协作关系，这就要求设计高效的内部
组件交互接口，以支持模块间的数据共享和功能调用，保证系统的整体协调运行。
核心内部组件交互接口和人机交互接口如表4-4 至表4-6 所示： 
表4-4 医学影像上传接口 
步骤 
元素 
描述 
交互机制设计 
时机 
当需要上传患者医学影像数据时 
发起 
医生、科研工作者 
返回方式 
异步传输，支持断点续传 
错误应对 
自动重试，记录失败日志 
接口技术选择 
技术 
RESTful API 
报文 
二进制文件流 
安全性 
文件格式校验，大小限制 
接口定义格式 
编程语言 
POST /api/v1/images/upload 
通信协议 
Http/Https 


## Page 59

第四章 面向胎儿心脏的分割分类辅助诊断系统架构设计 
45 
表4-5 辅助诊断接口 
步骤 
元素 
描述 
交互机制设计 
时机 
当医生需要进行先心病预测或心脏分割时 
发起 
医生 
返回方式 
异步返回 
错误应对 
记录错误日志，通知用户处理失败 
接口技术选择 
技术 
RESTful API 和WebSocket 
报文 
JSON 格式 
安全性 
参数验证，结果安全存储 
接口定义格式 
编程语言 
POST /api/v1/diagnosis/predict 
通信协议 
Http/Https 和gRPC 
表4-6 医学影像预处理接口 
步骤 
元素 
描述 
交互机制设计 
时机 
当用户需要对医学影像进行超分辨率或去噪去模糊处理
时 
发起 
医生、数据预处理人员 
返回方式 
异步返回，支持处理进度查询 
错误应对 
记录处理失败原因，支持处理中断和继续 
接口技术选择 
技术 
RESTful API 和WebSocket 
报文 
处理参数使用JSON 格式，处理结果使用二进制流 
安全性 
图像格式校验，处理参数范围验证，结果存储加密 
接口定义格式 
编程语言 
POST /api/v1/preprocess 
参数： 
- imageId: 图像ID 
- options: { 
superResolution: boolean， 
denoising: boolean 
} 
通信协议 
Http/Https 和gRPC 
 数据库设计 
本节将重点介绍系统数据库的概要设计，并通过实体-关系图（E-R 图）对数
据之间的关联进行描述。E-R 图作为一种常用的概念模型，能够抽象现实世界中的
事物，直观地表达实体类型、属性信息及其相互联系。通常，实体类型采用矩形框



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page59_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page59_img1.png)

## Page 60

电子科技大学硕士学位论文 
46 
表示，而属性则用椭圆形框进行标识，二者之间通过实线相连。为了表示实体类型
之间的关联，使用菱形框注明联系类别，并通过实线连接相关实体。同时，在联系
框内标注联系类型，如一对一（1:1）、一对多（1:n）或多对多（m:n）等，以清晰
展示各实体间的关系结构。 
正确的E-R 图设计取决于数据库设计人员对业务流程的真正理解和对客观对
象之间联系的把握，需要进行准确深入的用户需求分析。客观对象被抽象为E-R 图
中的实体类型，描述实体的相关数据信息被表示为实体的属性。E-R 图设计的关键
在于将实体之间的活动抽象为关系类型。 
4.4.1 系统权限表设计 
本系统采用基于基于角色的访问控制（Role-Based Access Control, RBAC）模
型的权限设计架构，通过用户（User）、角色（Role）、菜单（Menu）和API 资源
（API Resource）的多维度控制，实现了细粒度的权限管理。系统将功能权限分为前
端路由访问权限和后端API 调用权限两个维度，有效地保障了系统的安全性和可
控性。系统权限E-R 关系如图4-3 所示： 
 
图4-3 系统权限E-R 图 
如图所示，系统的权限控制模块涉及六张核心数据表。其中用户表、角色表、
路由权限表和接口资源权限四张表为主表，分别对应了系统权限E-R 图中的用户、
角色、菜单和资源实体。剩余的两张映射关系表为辅助表，对以上四个实体进行关



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page60_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page60_img1.png)

## Page 61

第四章 面向胎儿心脏的分割分类辅助诊断系统架构设计 
47 
联建立。用户表和角色表之间存在一对多的关系，即系统中的同一用户可以拥有系
统的多个角色，并且其角色对应的路由权限和接口资源权限也应取并集。角色表和
路由权限表存在一对多的关系，即每种角色可以拥有多种系统中的路由权限。同时，
角色表还与接口资源权限表存在一对多的关系，即每种角色可以拥有多种系统中
的接口资源权限。最后，用户表不与路由权限表和接口资源权限表进行直接关联，
由角色表实现间接关联。通过以上六张权限控制核心数据库表，系统形成了完善的
RBAC 架构。权限控制核心数据库表字段详情如表4-7 至表4-13 所示： 
表4-7 用户表 
名称 
代码 
数据类型 
非空 
注释 
用户ID 
id 
varchar(32) 
Y 
（主键）用户唯一
标识 
账号 
username 
varchar(50) 
Y 
用户登录账号 
密码 
password 
varchar(100) 
Y 
用户登录密码
（加密） 
姓名 
real_name 
varchar(50) 
Y 
用户真实姓名 
手机号 
phone 
varchar(20) 
Y 
用户手机号 
医院ID 
hospital_id 
varchar(32) 
N 
所属医院ID 
科室ID 
department_id 
varchar(32) 
N 
所属科室ID 
组别ID 
group_id 
varchar(32) 
N 
所属组别ID 
创建时间 
create_time 
datetime 
Y 
创建时间 
更新时间 
update_time 
datetime 
Y 
最后更新时间 
表4-8 角色表 
名称 
代码 
数据类型 
非空 
注释 
角色ID 
id 
varchar(32) 
Y 
（主键）角色唯一
标识 
角色名称 
role_name 
varchar(50) 
Y 
角色名称 
角色编码 
role_code 
varchar(50) 
Y 
角色编码 
描述 
description 
varchar(200) 
N 
角色描述 
创建时间 
create_time 
datetime 
Y 
创建时间 
更新时间 
update_time 
datetime 
Y 
最后更新时间 
状态 
status 
tinyint 
Y 
状态（0 禁用1 启
用） 


## Page 62

电子科技大学硕士学位论文 
48 
表4-9 路由权限表 
名称 
代码 
数据类型 
非空 
注释 
菜单ID 
id 
varchar(32) 
Y 
（主键）菜单唯一
标识 
菜单名称 
name 
varchar(50) 
Y 
菜单名称 
菜单编码 
code 
varchar(50) 
Y 
菜单编码 
父菜单ID 
parent_id 
varchar(32) 
N 
父菜单ID，顶级
菜单为null 
路由地址 
path 
varchar(200) 
N 
前端路由地址 
组件 
component 
varchar(200) 
N 
前端组件路径 
图标 
icon 
varchar(50) 
N 
菜单图标 
排序号 
sort_no 
int 
Y 
显示顺序 
类型 
type 
tinyint 
Y 
类型（1:目录 2:
菜单 3:按钮） 
状态 
status 
tinyint 
Y 
状态（0 禁用1 启
用） 
创建时间 
create_time 
datetime 
Y 
创建时间 
更新时间 
update_time 
datetime 
Y 
最后更新时间 
表4-10 接口资源权限表 
名称 
代码 
数据类型 
非空 
注释 
API ID 
id 
varchar(32) 
Y 
（主键）API 唯一
标识 
API 名称 
name 
varchar(50) 
Y 
API 名称 
API 编码 
code 
varchar(50) 
Y 
API 编码 
请求方法 
method 
varchar(10) 
Y 
Http 请求方法
（GET/POST 等） 
请求路径 
path 
varchar(200) 
Y 
API 请求路径 
参数类型 
param_type 
varchar(50) 
N 
资源参数类型 
所属模块 
module 
varchar(50) 
Y 
所属功能模块 
描述 
description 
varchar(200) 
N 
API 描述 
状态 
status 
tinyint 
Y 
状态（0 禁用1 启
用） 
创建时间 
create_time 
datetime 
Y 
创建时间 
更新时间 
update_time 
datetime 
Y 
最后更新时间 


## Page 63

第四章 面向胎儿心脏的分割分类辅助诊断系统架构设计 
49 
表4-11 用户-角色关系表 
名称 
代码 
数据类型 
非空 
注释 
角色ID 
role_id 
varchar(32) 
Y 
（联合主键）角色
ID 
用户ID 
user_id 
varchar(32) 
Y 
（联合主键）用户
ID 
创建时间 
create_time 
datetime 
Y 
创建时间 
表4-12 角色-路由权限关系表 
名称 
代码 
数据类型 
非空 
注释 
角色ID 
role_id 
varchar(32) 
Y 
（联合主键）角色
ID 
菜单ID 
menu_id 
varchar(32) 
Y 
（联合主键）菜单
ID 
创建时间 
create_time 
datetime 
Y 
创建时间 
表4-13 角色-接口资源关系表 
名称 
代码 
数据类型 
非空 
注释 
角色ID 
role_id 
varchar(32) 
Y 
（联合主键）角色
ID 
API ID 
api_id 
varchar(32) 
Y 
（联合主键）API 
ID 
创建时间 
create_time 
datetime 
Y 
创建时间 
本系统构建了基于RBAC 模型的多维度权限控制架构，通过在客户端和服务
端实施双层验证机制实现全方位的访问控制。在客户端，系统基于用户的角色属性
动态生成可访问的路由集合，对未经授权的路由请求进行拦截；在服务端，通过统
一的权限拦截器对所有API 请求进行细致的权限校验，确保用户仅能访问被明确
授权的接口资源。 
在权限架构设计上，系统采用基于角色的继承模式，通过角色作为权限聚合和
传递的媒介，在保证权限分配灵活性的同时降低了管理复杂度。同时，遵循关注点
分离原则，实现了菜单访问权限与API 调用权限的解耦，支持前后端权限的独立
配置与管理。在具体实现层面，系统构建了涵盖目录、菜单、按钮三个层次的界面
权限控制体系，并在API 层面实现了基于Http 请求方法的精确权限控制，确保接
口调用严格遵循最小权限原则。 
为保障系统安全，权限控制机制采用业界标准的加密算法对用户敏感数据进
行不可逆加密存储，并建立了完整的操作审计机制，记录所有权限相关操作的详细
信息，支持后期的安全审计与追溯。 


## Page 64

电子科技大学硕士学位论文 
50 
此外，系统对医院三级组织架构进行了规范化涉及，建立了其与用户表的关联
关系，根据需求文档实现了基于医院行政层级的用户组织架构管理，为权限分配提
供了组织架构支持。这种多层次、细粒度的权限控制机制，在确保系统易用性的同
时，有效降低了未授权访问和越权操作的安全风险。用户信息中涉及的医院组织架
构信息如表4-14 至表4-16 所示： 
表4-14 医院表 
名称 
代码 
数据类型 
非空 
注释 
医院ID 
hospital_id 
varchar(32) 
Y 
（主键）医院唯一
标识 
名称 
name 
varchar(50) 
Y 
医院名称 
地址 
address 
varchar(200) 
Y 
医院地址 
联系电话 
telephone 
varchar(32) 
Y 
医院联系方式 
创建时间 
create_time 
datetime 
Y 
医院信息创建时
间 
状态 
status 
Int 
Y 
医院启用状态 
表4-15 科室表 
名称 
代码 
数据类型 
非空 
注释 
科室ID 
department_id 
varchar(32) 
Y 
（主键）科室唯一
标识 
医院ID 
hospital_id 
varchar(32) 
Y 
所属医院ID 
名称 
name 
varchar(50) 
Y 
科室名称 
描述 
description 
varchar(200) 
N 
科室描述 
创建时间 
create_time 
datetime 
Y 
科室创建时间 
表4-16 组别表 
名称 
代码 
数据类型 
非空 
注释 
组别ID 
group_id 
varchar(32) 
Y 
（主键）组别唯一
标识 
医院ID 
hospital_id 
varchar(32) 
Y 
所属医院ID 
科室ID 
department_id 
varchar(32) 
Y 
所属科室ID 
名称 
name 
varchar(50) 
Y 
组别名称 
描述 
description 
varchar(200) 
N 
组别描述 
创建时间 
create_time 
datetime 
Y 
科室创建时间 
 


## Page 65

第四章 面向胎儿心脏的分割分类辅助诊断系统架构设计 
51 
通过这种多维度的权限控制设计，系统实现了对用户操作的全方位管控，既保
证了系统功能的安全性，又提供了灵活的权限配置机制，满足了不同场景下的权限
管理需求。 
4.4.2 数据库表设计 
基于系统的功能需求，除权限相关表外，本系统还需要设计以下核心业务表，
主要包括患者信息管理、医学影像管理和辅助诊断相关的数据表。系统患者模块E-
R 关系如图4-4 所示： 
 
图4-4 患者模块E-R 图 
关于患者信息部分的数据库设计，系统遵循了规范化原则，将患者信息、就诊
记录、医学影像和诊断结果分别存储在独立的数据表中，通过合理的外键关联建立
起完整的数据关系链，有效避免了数据冗余并保证了数据一致性。 
在可扩展性方面，系统在各表中预留了状态字段，为业务变更提供支持；采用
JSON 类型存储复杂的诊断结果数据，增强了系统对多种诊断类型的适应能力；同
时通过详细的时间戳字段记录，实现了完整的数据追踪和审计功能。系统还特别注
重安全性设计，通过状态管理机制支持数据软删除，保护数据完整性；在图像预处
理和辅助诊断环节均引入了审核机制，确保数据质量。 
针对医疗影像这类大容量数据，系统采用MinIO 对象存储方案，将结构化数
据与大型二进制文件分离存储，有效解决了数据库性能瓶颈问题。在字段类型选择
和主键设计上，系统也充分考虑了查询效率，限制了主要字段的最大长度，如使用
varchar(32)存储ID，使用tinyint 存储状态值，在保证功能实现的同时优化了存储
空间和索引性能。 
这种设计不仅满足了当前业务需求，也为未来系统扩展提供了良好基础。结合
上一小节描述的RBAC 权限模型，系统能够在确保数据安全的前提下，支持从患



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page65_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page65_img1.png)

## Page 66

电子科技大学硕士学位论文 
52 
者管理、影像处理到辅助诊断的完整医疗服务流程。系统的患者信息模块涉及多张
数据库表，如表4-17 至表4-20 所示： 
表4-17 患者基本信息表 
名称 
代码 
数据类型 
非空 
注释 
患者ID 
id 
varchar(32) 
Y 
（主键）患者唯一
标识 
姓名 
name 
varchar(50) 
Y 
患者姓名 
年龄 
age 
int 
Y 
患者年龄 
性别 
gender 
varchar(10) 
Y 
患者性别 
电话 
phone 
varchar(20) 
Y 
联系电话 
既往病史 
medical_history 
text 
N 
既往病史记录 
过敏史 
allergy_history 
text 
N 
过敏史记录 
创建时间 
create_time 
datetime 
Y 
创建时间 
更新时间 
update_time 
datetime 
Y 
最后更新时间 
状态 
status 
tinyint 
Y 
状态（0 无效1 有
效） 
表4-18 就诊记录表 
名称 
代码 
数据类型 
非空 
注释 
记录ID 
id 
varchar(32) 
Y 
（主键）记录唯
一标识 
患者ID 
patient_id 
varchar(32) 
Y 
关联的患者ID 
就诊时间 
visit_time 
datetime 
Y 
就诊时间 
就诊科室 
department_id 
varchar(32) 
Y 
就诊科室ID 
主诉 
chief_complaint 
text 
Y 
主诉内容 
算法调用
记录 
algorithm_history 
tinyint 
N 
是否使用了系统
相关算法（0 否
1 是） 
算法结果 
algorithm_result 
varchar(200) 
N 
算法记录ID 
诊断结果 
diagnosis 
text 
Y 
诊断结果 
算法准确
性 
algorithm_accuracy 
tinyint 
N 
算法是否准确
（0 不准确1 准
确） 
算法错误
原因 
algorithm_error_reason 
text 
N 
算法错误原因 
医生ID 
doctor_id 
varchar(32) 
Y 
就诊医生ID 
创建时间 
create_time 
datetime 
Y 
创建时间 


## Page 67

第四章 面向胎儿心脏的分割分类辅助诊断系统架构设计 
53 
表4-19 医学影像表 
名称 
代码 
数据类型 
非空 
注释 
影像ID 
id 
varchar(32) 
Y 
（主键）影像唯一
标识 
患者ID 
patient_id 
varchar(32) 
Y 
关联的患者ID 
影像类型 
type 
varchar(20) 
Y 
影像类型（超声
/CT 等） 
存储路径 
minio_path 
varchar(200) 
Y 
Minio 中的存储路
径 
上传者ID 
creator_id 
varchar(32) 
Y 
上传者ID 
创建时间 
create_time 
datetime 
Y 
创建时间 
状态 
status 
tinyint 
Y 
状态（0 无效1 有
效） 
表4-20 算法记录表 
名称 
代码 
数据类型 
非空 
注释 
记录ID 
id 
varchar(32) 
Y 
（主键）处理记录
唯一标识 
患者ID 
patient_id 
varchar(32) 
Y 
关联的患者ID 
输入数据ID 
data_id 
varchar(32) 
Y 
输入数据ID 
输入数据路
径 
data_path 
varchar(200) 
Y 
输入数据路径 
算法ID 
algorithm_id 
varchar(20) 
Y 
算法ID 
处理状态 
status 
varchar(20) 
Y 
处理状态 
结果ID 
result_id 
varchar(32) 
Y 
结果文件ID 
结果路径 
result_path 
varchar(200) 
N 
结果存储路径 
处理时间 
create_time 
datetime 
Y 
处理时间 
处理者ID 
processor_id 
varchar(32) 
Y 
处理者ID 
审核状态 
audit_status 
tinyint 
Y 
审核状态（0 未审
核1 通过2 拒
绝） 
审核意见 
audit_comment 
varchar(200) 
N 
审核意见 
4.4.3 文件服务器设计 
本系统的文件存储设计采用了多层架构，实现了数据存储和关系管理的分离。
MinIO 负责大文件的实际存储，保证存储可靠性。MySQL 维护算法与数据格式的
关系数据，确保关系型数据库中文件元数据与对象型数据库中文件实际存储位置
的一致性。Redis 提供高性能的文件基本信息元数据缓存和Base64 格式的缩略图
缓存以减少对MinIO 对象型数据库的非必要访问次数，提升数据访问效率。 


## Page 68

电子科技大学硕士学位论文 
54 
在本节，将重点描述本系统中患者医疗数据的存储方案和实体关系，不过多考
虑MySQL 数据库在本系统中担任的系统基本业务数据存储角色。文件服务器E-R
关系如图4-5 所示： 
 
图4-5 文件服务器E-R 图 
如图所示，MinIO 文件数据库实体与MySQL 数据库实体形成了一对一映射关
系，即MinIO 文件数据库中的所有文件都在MySQL 数据库中进行了元数据存储，
这样做的好处是在系统不需要对文件原始数据进行访问时，可以直接对MySQL 数
据库中的元数据进行访问，减轻文件数据库读取压力。同时系统设计了定期的数据
一致性检查，对文件的删除操作将不会直接作用于MinIO 文件数据库，而是通过
批量的方式完成数据同步。 
算法实体与MySQL 数据库实体形成了一对一映射关系，这一设计代表同一算
法可拥有多个文件元数据使用权限。虽然以上实体关系显示算法与MinIO 文件数
据库之间仅仅存在间接联系，但在系统实际应用中，算法对于数据的输入输出请求
是通过从MySQL 数据库中得到MinIO 数据库的逻辑地址来完成的，而算法取得
逻辑地址后与MinIO 数据库产生的数据传输过程是不经过MySQL 数据库的。 
考虑到系统对诊断结果和诊断记录访问的频率较高，系统专门设立了缓存对
算法的结果进行数据冗余，即算法产生的结果会同时存入缓存和MySQL 数据库，
在访问时先访问缓存再访问MySQL 数据库。 
这种设计不仅满足了当前系统的文件存储需求，也为将来的功能扩展预留了
充分的空间。系统的文件服务器模块涉及到如下5 张数据库表，如表4-21 至表4-
24 所示： 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page68_img1.jpeg](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page68_img1.jpeg)

## Page 69

第四章 面向胎儿心脏的分割分类辅助诊断系统架构设计 
55 
表4-21 算法定义表 
名称 
代码 
数据类型 
非空 
注释 
算法ID 
id 
varchar(32) 
Y 
（主键）算法唯一标识 
算法名称 
name 
varchar(50) 
Y 
算法名称 
算法类型 
type 
varchar(20) 
Y 
类型（预处理/辅助诊
断） 
输入格式 
input_format 
varchar(50) 
Y 
支持的输入数据格式 
输出格式 
output_format 
varchar(50) 
Y 
输出数据格式 
状态 
status 
tinyint 
Y 
状态（0 禁用1 启用） 
表4-22 数据格式定义表 
名称 
代码 
数据类型 
非空 
注释 
格式ID 
id 
varchar(32) 
Y 
（主键）格式唯一
标识 
格式名称 
name 
varchar(50) 
Y 
格式名称
（PNG/JPG 等） 
格式编码 
code 
varchar(20) 
Y 
格式编码 
MIME 类型 
mime_type 
varchar(50) 
Y 
MIME 类型 
表4-23 MinIO 文件关联表 
名称 
代码 
数据类型 
非空 
注释 
文件ID 
id 
varchar(32) 
Y 
（主键）文件唯一
标识 
存储桶 
bucket 
varchar(50) 
Y 
MinIO 存储桶 
对象路径 
object_path 
varchar(200) 
Y 
MinIO 对象路径 
格式ID 
format_id 
varchar(32) 
Y 
关联的数据格式
ID 
文件hash 
file_hash 
varchar(64) 
Y 
文件hash 值 
创建时间 
create_time 
datetime 
Y 
创建时间 
表4-24 Redis 缓存格式表 
缓存类型 
Key 格式 
Value 类型 
内容说明 
过期时间 
元数据缓
存 
file:metadata:{fileId} 
hash 
文件基本信息 
1 小时 
缩略图缓
存 
file:thumbnail:{fileId} 
string 
Base64 编码的
缩略图 
2 小时 
访问计数 
file:access:{fileId} 
string 
访问次数 
1 小时 


## Page 70

电子科技大学硕士学位论文 
56 
 本章小结 
本章主要讲述系统的概要设计。首先介绍系统整体的体系结构，然后根据功能
点对系统的模块划分进行详细说明。随后阐述系统的接口设计原则，并介绍了四个
核心接口：患者信息接入模块中的电子病历系统对接接口、文件服务器模块下的医
学影像上传接口，以及核心功能点下的预处理和辅助诊断接口。最后，将系统解耦
为权限模块、核心功能模块和文件服务器模块三部分，通过E-R 图描述数据库设
计思路。 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page70_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page70_img1.png)

## Page 71

第五章 面向胎儿心脏的分割分类辅助诊断系统详细设计与实现 
57 
面向胎儿心脏的分割分类辅助诊断系统详细设计与实现 
 开发环境 
5.1.1 硬件环境 
系统开发环境的硬件配置如表5-1 所示： 
表5-1 系统硬件开发环境 
项目 
开发环境 
CPU 
AMD Ryzen 5 7500F 
内存 
32GB 
存储 
2TB NVMe SSD 
GPU 
NVIDIA RTX 4070 12GB 
网络 
100Mbps 
5.1.2 软件环境 
系统的软件环境配置如表5-2 所示： 
表5-2 系统软件开发环境 
类别 
软件 
开发环境版本 
操作系统 
Linux 
Ubuntu 22.04 LTS 
容器平台 
Docker 
27.3.1 
数据库 
MySQL 
5.7.24 
Redis 
7.4 
MongoDB 
6.0.8 
对象存储 
MinIO 
RELEASE.2024-11-07T00-52-20Z 
Web 服务器 
Nginx 
1.27 
运行环境 
Java JDK 
OpenJDK 17 
Python 
3.11 
Node.js 
12.14.0 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page71_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page71_img1.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page71_img2.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page71_img2.png)

## Page 72

电子科技大学硕士学位论文 
58 
5.1.3 开发工具 
本系统在开发过程中使用的主要工具如表5-3 所示： 
表5-3 系统开发工具 
类别 
工具 
版本 
用途 
后端开发 
IntelliJ IDEA 
2023.2 
Java 开发IDE 
PyCharm 
2022.3 
Python 开发IDE 
Postman 
11.35.0 
API 测试工具 
前端开发 
Visual Studio 
Code 
1.97 
前端代码开发工具 
Chrome 
DevTools 
133.0.6943.142 
前端调试工具 
数据库工具 
Navicat 
Premium 
16.0.11 
数据库管理工具 
容器管理 
Docker 
Community 27.3.1 
容器化部署 
版本控制 
GitLab 
14.4 
代码仓库管理 
 系统架构设计 
5.2.1 系统技术架构 
面向胎儿心脏的分割分类辅助诊断系统采用基于微服务的分布式架构设计，
整体架构自顶向下分为前端层、接口层、展示层、服务层和资源层五个层次。 
前端层采用了主流的Vue.js 框架作为基础组件。Vue.js 是一套用于构建用户界
面的渐进式框架，其核心库只关注视图层，具有渐进性、易用性和灵活性等特点。
在本系统中，Vue.js 主要负责医学影像的可视化展示、患者信息管理界面的渲染以
及诊断结果的展示。同时，通过Element-UI 组件库提供统一的界面风格。 
接口层作为系统的安全门户，通过外网防火墙和DDoS 防御网从网络传输层
和网络层入手，快速识别和剔除恶意访问流量。同时，通过Nginx 实现反向代理和
负载均衡，确保系统在高并发场景下的稳定运行。此外，采用Https 协议对传输数
据进行加密，保护患者敏感信息的安全。 
展示层主要负责后台模板渲染和用户请求处理。系统采用Thymeleaf 模板技
术，作为Spring 官方支持的模板引擎之一，它与Spring Boot 框架的自动化配置完
美集成。同时，系统实现了RESTful 风格的API 接口，并通过WebSocket 技术支
持医学影像数据的实时传输，为AI 辅助诊断提供实时反馈能力。 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page72_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page72_img1.png)

## Page 73

第五章 面向胎儿心脏的分割分类辅助诊断系统详细设计与实现 
59 
服务层是系统的核心层次，包含了业务服务模块、服务通信和服务管理三大部
分。业务服务模块实现了系统的核心功能，包括预处理、辅助诊断、患者管理、数
据管理和用户权限管理等。通过gRPC 和Http 进行服务间的高效通信。在服务管
理方面，采用Docker 容器化技术实现服务的标准化部署。 
资源层负责系统数据的存储和管理，主要包括数据存储和缓存机制两个部分。
在数据存储方面，采用MySQL 存储患者信息、诊断记录等结构化数据，使用MinIO
分布式存储系统管理医学影像文件，MongoDB 负责存储系统运行日志。在缓存机
制方面，采用Redis 缓存热点数据，如常用的诊断模型和临时的处理结果，通过多
级缓存策略提升系统响应速度。 
系统整体架构如图5-1 所示： 
 
图5-1 系统整体架构图 
整个系统架构设计充分考虑了医疗系统的特殊需求，通过分层设计实现了系
统的高可用性、可扩展性和安全性。同时，微服务架构的采用使得系统各个功能模
块能够独立演进，便于后期的维护和升级。 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page73_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page73_img1.png)

## Page 74

电子科技大学硕士学位论文 
60 
5.2.2 分布式网关交互设计 
基于上文系统框架的研究和系统本身的需求可知，系统中存在大量接口调用
和数据交互，且随着未来其他辅助诊断算法和图像预处理算法的加入，系统各功能
的扩展需求强烈。虽然Spring Boot 单体架构可支撑基础功能，但为提升系统的可
扩展性和维护性，本研究采用Docker 容器化方式部署人工智能算法模块，实现了
算法模块的独立部署和弹性扩展。 
在分布式网关的实现中，系统采用了基于Java 语言的Netty 框架进行实现。
这一选择不仅符合维护团队和开发团队的Java 技术栈背景，更重要的原因是Netty
采用了高效的事件驱动型非阻塞IO 模型。相比传统的阻塞IO 模型，能够以较少
的线程处理更多的并发连接，显著提高系统吞吐量。其次，Netty 提供了优异的网
络协议支持能力，包括HTTP、WebSocket、TCP 和UDP 等多种协议，而且支持自
定义协议扩展，这使得实现HTTP 和gRPC 双协议支持变得更为便捷。相较于Spring
框架下的传统选择Spring Cloud Gateway 网关，该网关基于WebFlux 的响应式特性
实现，编程门槛更高，后期维护起来较为复杂。基于Netty 对自研网关的实现不仅
降低了维护门槛，还可以削弱传统网关中的冗余模块，仅保留本系统所必须的核心
功能，比如算法模块的鉴权、日志记录和限流等，大大简化了整体维护难度。 
由于Java 语言对Http API 的原生支持已十分完善，本节将重点介绍网关gRPC
协议部分的优势和实现。在服务器响应时间和每秒事务处理量方面，REST API 在
极限情况下具有一定优势。但在可预测性较强的接口中，gRPC 的数据传输量表现
会较Http API 小得多，这与gRPC 基于Http2.0 协议实现的多路复用特性、Protocol 
Buffers 的二进制序列化方案以及HPACK 算法的请求头压缩处理密切相关。以上
结论的测试结果将在第六章系统测试中进行体现。 
考虑到本系统中算法模块数据传输量较高，使用gRPC 协议在一定程度上能
提升算法的数据传输效率。在服务治理方面，gRPC 内置的负载均衡、重试和超时
机制，以及对双向流通信的支持，为系统提供了完善的服务治理能力，这也是本系
统算法模块所需的关键能力。 
作为高性能远程过程调用框架，gRPC 使用Protocol Buffers 作为其接口定义语
言和数据序列化格式。传统Protocol Buffers 开发模式需要为每个服务接口单独定
义Proto 文件，这导致了版本管理复杂、接口同步困难等问题。为简化开发流程，
本研究设计了统一的Proto 文件模板。通过采用统一Proto 模板和Python Pickle 序
列化方案，既保留了gRPC 的性能优势，又避免了繁琐的Proto 文件管理工作。请
求模板包含算法名称和算法参数两个固定字段，响应模板包含调用状态、处理结果、
调用描述和错误信息等固定字段，这种设计显著降低了系统维护成本和开发复杂


## Page 75

第五章 面向胎儿心脏的分割分类辅助诊断系统详细设计与实现 
61 
度。Netty 中将Http 请求泛化为gRPC 请求的核心逻辑如下所示。Netty 中将Http
请求泛化为gRPC 请求的核心逻辑如代码5-1 所示： 
代码5-1 请求泛化核心逻辑 
public class Http 到gRPC 转换Handler extends 
SimpleChannelInboundHandler<FullHttpRequest> { 
    public Http 到gRPC 转换处理器(String grpc 代理地址, int grpc 代理端口) { 
        // 创建到统一gRPC 代理的通道 
        this.grpc 通道 = ManagedChannelBuilder 
            .forAddress(grpc 代理地址, grpc 代理端口) 
            .usePlaintext() 
            .build(); 
        this.代理= 统一代理服务Grpc.newStub(grpc 通道); 
    } 
     
    @Override 
    protected void channelRead(ChannelHandlerContext 上下文, FullHttpRequest http 请求) 
    throws Exception { 
        try { 
            // 获取服务和方法信息（从URI 中解析） 
            String[] 路径部分 =  http 请求.uri().路径.split("/"); 
            // 获取请求体 
            ByteBuf 内容 = http 请求.content(); 
             
            // 创建pickle 序列化数据 
            byte[] 序列化数据 = 创建Pickle 序列化数据(服务名, 方法名, 请求体数据); 
             
            // 创建发送给统一gRPC 代理的请求 
            ProxyRequest 代理请求 = ProxyRequest.newBuilder() 
                .setSerializedData(ByteString.copyFrom(序列化数据)) 
                .build(); 
             
            // 发送请求到统一代理 
            代理.process(代理请求, new StreamObserver<ProxyResponse>() { 
                @Override 
                public void onNext(ProxyResponse 响应) { 
                    将gRPC 响应转换回Http 响应 
                } 
            }); 
        }  
    } 
} 
5.2.3 容器化部署设计 
本节将详细介绍系统各组件的容器化部署方案，主要包括基于Java 的Spring 
Boot 后端组件、基于Netty 框架实现的分布式网关组件、基于Python 的FastAPI 和


## Page 76

电子科技大学硕士学位论文 
62 
gRPC 算法服务组件。容器化技术是解决算法服务环境依赖复杂，跨平台可移植性
差这一问题的重要方案，可以极大的便利从开发环境向部署环境迁移的过程。 
Spring Boot 应用因其自包含特性和内嵌式服务器，非常适合容器化部署。容
器化后的Spring Boot 服务可以根据系统负载需求快速扩缩容，系统弹性大大提高。
本系统的分布式网关与后端组件均基于Java 语言实现，在本节只对网关核心服务
包的容器化部署配置进行介绍。网关作为算法模块的流量入口，其容器化部署需考
虑高并发、低延迟的场景需求，部署的基础镜像选择了体积较小的OpenJDK8。同
时，合理配置容器网络和资源限制也尤为重要，本系统对部署脚本的启动参数实现
了动态传递，可以方便的传递Java 虚拟机的各项配置参数。网关容器化部署核心
配置如代码5-2 所示： 
代码5-2 网关Dockerfile 核心配置项 
# 基础镜像 
FROM openjdk:8-jre-slim 
# 配置 
ENV PARAMS="" 
# 时区 
ENV TZ=PRC 
RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone 
# 添加应用 
ADD target/api-gateway-engine.jar /api-gateway-engine.jar 
# 执行镜像 
ENTRYPOINT ["sh","-c","java -jar $JAVA_OPTS /api-gateway-engine.jar $PARAMS"] 
算法模块设计了如上一小节所述的基于FastAPI 框架和gRPC 框架的两种容器
化部署方案，两种方案均基于Python 语言实现，配置项较为相似，本节此只针对
系统中应用更加广泛的FastAPI 配置项进行介绍，其核心配置如代码5-3 所示： 
代码5-3 FastAPI 框架Dockerfile 核心配置项 
# 基础镜像 
FROM python:3.11-slim 
# 工作目录 
WORKDIR /app 
# 配置参数 
ENV UVICORN_PARAMS="" 
# 复制Python 依赖文件并安装 
COPY requirements.txt . 
RUN pip install --no-cache-dir -r requirements.txt 
# 复制应用代码 
COPY ./app ./app 
# 执行镜像 
ENTRYPOINT ["sh", "-c", "uvicorn app.main:app $UVICORN_PARAMS"] 


## Page 77

第五章 面向胎儿心脏的分割分类辅助诊断系统详细设计与实现 
63 
 数据存储与管理 
本系统的数据存储与管理模块是确保医疗数据安全、高效处理的核心组件，主
要由元数据管理和数据操作管理两个部分组成。 
元数据管理建立了医院组织结构的层级框架和算法模型分类体系，为用户权
限控制和数据分类提供基础。医院组织结构元数据管理实现如图5-2 所示： 
 
图5-2 元数据管理实现图 
数据操作管理则规范了医生和科研工作者对于患者数据的上传、删除等日常
操作流程。患者数据管理实现如图5-3 所示： 
 
图5-3 患者数据管理实现图 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page77_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page77_img1.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page77_img2.jpeg](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page77_img2.jpeg)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page77_img3.jpeg](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page77_img3.jpeg)

## Page 78

电子科技大学硕士学位论文 
64 
5.3.1 元数据管理 
系统元数据管理主要涉及医院组织结构元数据和算法模型元数据两个维度。
医院组织结构元数据采用三级架构，包括医院、部门和组别。这种层级结构不仅在
用户账号创建和角色分配时提供基础支撑，更是实现数据访问控制的重要依据。系
统基于此结构实现了细粒度的数据可见性管理，包括患者信息访问权限和算法模
型使用权限的精确控制。元数据管理活动如图5-4 所示： 
 
图5-4 元数据管理活动图 
算法模型元数据的配置权限仅对系统管理员开放，其映射关系如表5-4 所示： 
表5-4 系统数据类目数据格式 
数据类目 
数据格式 
心音 
.mp4， .npy 
心电 
.csv， .npy 
心动 
.mp4， .avi 
心脏MR 
.jpg， .png， .mha， .nii 
心脏CT 
.jpg， .png， .mha， .nii 
心脏超声 
.jpg， .png， .gz 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page78_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page78_img1.png)

## Page 79

第五章 面向胎儿心脏的分割分类辅助诊断系统详细设计与实现 
65 
如上表所示，系统根据现有的辅助诊断算法和预处理算法，系统将医疗数据划
分为六大数据类目：心音、心电、心动、心脏MR、心脏CT 和心脏超声。数据类
目是为了从业务角度区分采集到的患者数据，每个类目被设计为支持特定的数据
格式，数据类目与数据格式的映射共同覆盖了当前算法模块的输入输出需求。 
5.3.2 数据操作管理 
在数据操作方面，系统实现了严格的数据上传管理机制。上传数据必须符合元
数据中定义的类目-格式映射关系，确保数据的规范性和一致性。数据操作管理活
动图如图5-5 所示： 
 
图5-5 数据操作管理活动图 
针对数据删除操作，系统采用了逻辑删除策略，即通过标记方式实现数据的
“软删除”，而非物理删除。系统在数据检索和展示时会自动过滤带有删除标记的数
据，确保用户界面的清晰性。这种设计具有误操作防护和安全性优势，对于普通用
户的误删除可以通过简单的标志位重置进行数据找回，对于恶意用户的大量数据
的攻击性删除，此办法也能防止数据大范围丢失。结合系统的日志系统，系统会记
录所有数据操作的执行账户ID，建立完整的操作审计链，对于恶意用户可以做到
有效的数据追溯和责任人追溯。 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page79_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page79_img1.png)

## Page 80

电子科技大学硕士学位论文 
66 
 系统日志与缓存机制 
为保证系统运行的可追溯性、稳定性和高性能，本系统实现了完整的操作日志
记录机制和缓存管理机制。操作日志记录机制主要用于记录和追踪系统中的关键
操作行为，确保系统运行过程的可追溯性和安全性；缓存机制则通过引入高性能的
内存数据库，实现了对系统热点数据和资源的快速访问，有效提升了系统响应速度
和整体性能。这两个机制的实现为系统的稳定运行和性能优化提供了重要保障。 
5.4.1 操作日志记录机制 
本系统建立了完整的操作日志记录机制，根据操作类型的不同，将日志记录分
为算法操作日志和系统管理日志两个主要部分。该机制通过AOP（面向切面编程）
方式实现，实现了对系统关键操作的全面记录和追踪。 
系统管理日志则主要记录用户管理、角色分配、资源权限修改等系统管理操作，
是作为溯源手段的存在。考虑到系统安全性，这类日志仅对系统维护人员开放访问
权限，用于系统问题排查和安全事件追踪。考虑到存储隔离性，系统管理类日志采
用了独立的存储策略。系统管理日志核心内容如表5-5 所示： 
表5-5 系统管理日志核心内容 
名称 
解释 
日志ID 
日志唯一标识 
操作者ID 
执行操作的用户ID 
操作时间 
操作发生时间（精确到毫秒） 
操作类型 
操作类型（用户账户管理/用户角色管理/角色路由管理/角色
接口管理/算法映射管理/元数据管理） 
操作状态 
操作状态（0 失败1 成功2 处理中） 
错误信息 
操作失败时的错误信息 
创建时间 
记录创建时间 
算法操作日志主要记录系统中的算法模块预处理操作和辅助诊断算法操作。
该类日志除记录基本的操作信息外，还包含操作的输入输出数据及其对应的缩略
图信息。 
缩略图的处理采用了与系统缓存机制相结合的方式，系统会将缩略图暂存于
缓存中，并设置访问期限，当超过预设时间未被访问时，缓存系统会自动清理这些
缩略图数据。用户在查看操作记录时，系统优先展示缓存中的缩略图，提高访问效
率。算法操作日志的查看在系统中是作为历史记录功能存在的，查看较为频繁，其



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page80_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page80_img1.png)

## Page 81

第五章 面向胎儿心脏的分割分类辅助诊断系统详细设计与实现 
67 
数据库表实现在4.4.2 节进行了详细描述，这里主要对表内核心内容进行解释，如
表5-6 所示： 
表5-6 算法操作日志核心内容 
名称 
解释 
日志ID 
日志唯一标识 
操作者ID 
执行操作的用户ID 
操作时间 
操作发生时间（精确到毫秒） 
算法类型 
算法类型（预处理/辅助诊断） 
算法代码 
具体算法的唯一代码 
输入数据 
输入数据的 
输出结果 
输出结果的 
操作状态 
操作状态（0 失败1 成功2 处理中） 
错误信息 
操作失败时的错误信息 
创建时间 
记录创建时间 
系统针对不同类型的日志采用不同的存储策略和保存期限，在保证系统运行
记录完整性的同时，避免日志处理对系统性能造成显著影响。系统的算法操作日志
记录和系统管理日志记录活动图如图5-6 所示： 
 
图5-6 日志管理活动图 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page81_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page81_img1.png)

## Page 82

电子科技大学硕士学位论文 
68 
由于系统对于安全性和操作可追溯性的高度要求，日志记录行为几乎嵌入了
系统的每个业务逻辑实现中，系统使用Spring 提供的AOP 技术实现分别实现了系
统基本逻辑和算法调用的自定义注解，并为其实现了对应的切面，开发者可以方便
的使用注解方式实现日志记录。同时，为提高系统运行速度，系统将算法调用产生
的图片结果直接存入缓存数据库中。算法调用的切面核心逻辑如代码5-4 所示： 
代码5-4 算法调用切面核心逻辑 
@Aspect 
@Component 
public class 算法日志切面 { 
    // 定义切点 - 所有带有@算法日志注解的方法 
    @Pointcut("@annotation(com.example.annotation.算法日志)") 
    public void 算法日志切点() {} 
    // 环绕通知 
    @Around("算法日志切点()") 
    public Object 记录算法执行(ProceedingJoinPoint 连接点) throws Throwable { 
        // 获取方法信息 
        注解 =连接点.获取方法().获取注解(算法日志.class); 
        Document 日志文档 = new Document(); 
        // 记录基础信息 
        日志文档.put("算法ID", "算法名称", "操作人", "操作时间", "输入数据", "状态"); 
        // 写入MongoDB  
        String 日志ID = mongoTemplate.insert(日志文档, "算法日志").getId(); 
    } 
    // 处理算法结果 
    private void 处理算法结果(Object 结果, Document 日志文档, String 算法ID) { 
        if (结果 instanceof byte[] && 是图片数据((byte[])结果)) { 
            // 转Base64 并存入Redis 
            String base64 图片 = 转Base64(图片数据); 
            String 缓存键 = "算法结果:图片:" + 算法ID + ":" +  
                System.currentTimeMillis(); 
            jedis.setex(缓存键, 86400, base64 图片); // 24 小时过期 
            // 记录到日志文档 
            日志文档.put("缩略图", 生成缩略图Base64(图片数据)); 
        }  
        else if (结果 instanceof String) { 
            // 处理文本结果 
            日志文档.put("结果类型", "文本"); 
            日志文档.put("结果", 结果); 
        }  
        else { 
            // 处理其他文件结果 
            日志文档.put("结果类型", "其他"); 
            日志文档.put("结果", "结果"); 
        }  
    } 
} 


## Page 83

第五章 面向胎儿心脏的分割分类辅助诊断系统详细设计与实现 
69 
为了实现对系统运行状态的实时监控和性能分析，本系统采用了Prometheus
和Grafana 组合方案，构建了完整的监控可视化体系。Prometheus 负责系统核心指
标的采集、存储和查询，通过在应用服务器上部署Prometheus Exporter，系统能够
自动收集包括CPU 利用率、内存占用、网络吞吐量、算法调用频率以及响应时间
等关键性能指标。系统使用Spring Boot Actuator 扩展了自定义指标，重点监控算
法处理队列长度和算法执行时间分布，为算法性能优化提供依据。Prometheus 采用
拉取式数据采集模式，定期从各监控点获取指标数据，并支持通过PromQL 查询语
言进行复杂数据分析。Grafana 则负责将Prometheus 采集的监控数据转化为直观的
可视化面板。系统针对不同角色用户定制了多套监控仪表盘：系统管理员可查看全
局系统负载和关键性能指标；技术人员可深入分析算法性能和资源消耗；业务人员
则可关注业务处理量和服务响应速度。通过Grafana 的告警功能，系统能够在关键
指标异常时自动发送邮件或短信通知，实现故障预警。此外，Grafana 还集成了日
志可视化模块，通过分析结构化日志，提供诸如算法调用趋势、错误率统计和用户
操作分布等多维度分析视图，辅助系统优化决策。系统的监控告警阈值根据历史运
行数据动态调整，避免了静态阈值导致的误报或漏报问题。完整的监控可视化体系
使系统运维从被动响应转为主动预防，显著提升了系统的可用性和稳定性。系统共
配置了对多项系统运行组件的监控，这里对MinIO 对象数据库监控配置项进行具
体介绍，MinIO 和本系统大多数微服务组件都已内置了Prometheus 兼容的指标导
出功能，不需要额外部署exporter，仅需启动时配置符合Prometheus 的metric 采集
规则的访问地址即可，Prometheus 中MinIO 监控核心配置项如代码5-5 所示： 
代码5-5 日志采集核心配置项 
# 全局配置 
global: 
  scrape_interval: 15s    # 默认抓取间隔，15 秒一次 
  evaluation_interval: 15s    # 规则评估间隔 
  scrape_timeout: 10s    # 抓取超时时间 
# 抓取配置 
scrape_configs: 
  # 监控任务名 
  - job_name: 'minio' 
  # MinIO metric 访问地址， 
    metrics_path: '/minio/v2/metrics/cluster' 
    # 监控协议 
    scheme: 'https' 
    static_configs: 
      - targets: ['minio-server:9000']  # MinIO 服务端口 
    # MinIO 访问认证 
    bearer_token: '访问令牌' 


## Page 84

电子科技大学硕士学位论文 
70 
5.4.2 系统缓存机制 
本系统引入了Redis 内存型数据库作为缓存中间件，主要用于处理用户权限信
息和算法调用结果图像的缓存需求。系统通过合理的缓存策略，有效提升了系统响
应速度和用户访问体验。 
在用户权限缓存方面，系统对活跃用户的权限信息进行缓存，具体来说，包括
用户的前端路由权限、加密后的认证信息和用户拥有的API 接口访问权限列表。
当用户登录系统后，相关的权限信息会被加载到缓存中，后续的权限验证操作可直
接从缓存中获取，避免频繁访问数据库，从而提高系统性能。系统权限缓存处理的
活动图如图5-7 所示： 
 
图5-7 系统权限缓存活动图 
因5.3 小结用户认证与权限管理的内容与缓存系统实现过程高度重合，本文将
在此统一介绍角色管理和缓存的核心逻辑。在系统运行过程中，用户对后台系统的
所有请求均需要进行权限校验，对权限数据的访问频率极高，考虑到系统运行速度
和性能，此部分操作主要由缓存数据库完成，而不是系统中的关系型数据库。用户
的权限查询请求会被区分为路由和接口两个不同的权限类型，路由类型仅会在登
陆系统时进行请求，请求后会在前端进行匹配和存储，后续页面切换涉及到的权限
数据会直接从前端进行查询；接口类型的权限查询会伴随每次对后台的请求，系统
对请求资源路径和接口权限进行验证后才能进入后续的业务实现逻辑部分，基于
缓存的权限验证核心逻辑如代码5-6 所示： 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page84_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page84_img1.png)

## Page 85

第五章 面向胎儿心脏的分割分类辅助诊断系统详细设计与实现 
71 
代码5-6 基于缓存的权限验证核心逻辑 
@Component 
public class 权限验证服务 { 
    @Autowired 
    private Jedis jedis; 
     
    // 验证权限 
    public boolean 验证权限(String 令牌, String 资源路径, String 权限类型) { 
        // 解析令牌获取用户ID 和角色列表 
        令牌解析结果 = 解析令牌(令牌); 
        if (令牌解析结果 == null) return false; 
        // 获取用户下所有角色权限，并对结果取并集 
        for (String 角色ID : 角色IDs) { 
            String 缓存键 = "角色:权限:" + 角色ID; 
            String 缓存数据 = jedis.get(缓存键); 
            // 缓存不存在则从数据库加载并缓存 
            if (缓存数据 == null) { 
                Map<String, Set<String>> 角色权限 = 从数据库加载角色权限(角色ID); 
                jedis.setex(缓存键, 3600, JSON 序列化(角色权限)); 
                if (权限类型.equals("路由")) { 
                    用户权限集合.addAll(角色权限.get("路由")); 
                } else { 
                    用户权限集合.addAll(角色权限.get("接口")); 
                } 
            } else { 
  // 直接使用缓存获取 
                Map<String, Set<String>> 角色权限 = JSON 反序列化(缓存数据); 
                if (权限类型.equals("路由")) { 
                    用户权限集合.addAll(角色权限.get("路由")); 
                } else { 
                    用户权限集合.addAll(角色权限.get("接口")); 
                } 
            } 
        } 
        // 验证是否有权限访问 
        return 用户权限集合.contains("*") ||  
               用户权限集合.contains(资源路径) ||  
               匹配通配符权限(用户权限集合, 资源路径); 
    } 
} 
由于本系统涉及到的图片展示较多，故在日志系统中额外设计了对图片资源
的缓存策略。在上一小节中，对算法调用结束后日志存储时的缩略图生成过程做了
解释，本节将对用户访问系统其他图像资源时的缓存情况进行介绍，系统图片资源
访问缓存活动图如图5-8 所示： 


## Page 86

电子科技大学硕士学位论文 
72 
 
图5-8 系统图片资源访问缓存活动图 
系统会拦截所有对文件数据库的请求，如果匹配到图片类型则会从缓存中获
取，否则才会访问文件数据库，图片访问缓存核心逻辑如代码5-7 所示： 
代码5-7 图片访问缓存核心逻辑 
public String getImage(String 图片ID) { 
    // 首先查询Redis 缓存是否存在该图片的缩略图 
    String 缓存键 = "图片缩略图:" + 图片ID; 
    String 缓存数据 = jedis.get(缓存键); 
     
    if (缓存数据 != null) { 
        return 缓存数据;  // 返回Base64 格式的缩略图 
    } else { 
        // Redis 中不存在，需要从MinIO 获取 
        String 图片地址 = minioClient.getObjectUrl(图片ID); 
         
        // 获取MinIO 中的图片 
        InputStream 原始图片 = minioClient.getObject(图片ID); 
         
        // 生成缩略图 
        BufferedImage 缩略图 = 图片处理工具.生成缩略图(原始图片); 
         
        // 将缩略图转为Base64 格式 
        String 缩略图Base64 = Base64.getEncoder().encodeToString(图片转字节(缩略图)); 
         
        // 将缩略图缓存到Redis，设置过期时间 
        jedis.setex(缓存键, 86400, 缩略图Base64);  // 86400 秒=1 天 
         
        return 图片地址; 
    } 
} 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page86_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page86_img1.png)

## Page 87

第五章 面向胎儿心脏的分割分类辅助诊断系统详细设计与实现 
73 
 预处理模块 
5.5.1 超声图像增强 
超声图像增强模块集成于本系统主界面左侧数据预处理菜单栏内。该功能对
提升胎儿先天性心脏病诊疗质量具有重要临床价值，在保证图像真实性的前提下
通过优化超声影像的质量能降低诊断过程对超声影像采集者技术水平的依赖性，
其次，经算法优化的影像可显著提升室间隔缺损等特殊先天性异常的识别灵敏度。
超声图像增强模块实现如图5-9 所示： 
 
图5-9 超声图增强模块实现图 
如上图所示，用户查看超声图像增强结果时，可直接对处理前后的文件进行预
览和对比，原始图像名为patient0450_4CH_ES_gt.jpg，大小约为19.6KiB，操作结
果图像名为patient0450_4CH_ES_gt_en.jpg，大小约158.5KiB。 
本模块的主要使用者为医生和科研工作者两个角色。用户进入系统后点击系
统左侧菜单栏中的“预处理”后，点击进入“超声图像增强”二级菜单，此时页面
中央将展示超声图像增强的历史调用记录，左侧则是增强算法选择栏。选择希望应
用的超声图像增强算法版本后，点击“新建操作”按钮进入患者选择页面，在患者
选择页面中可以通过点击“患者详情”查看患者数据，在此模块中患者数据仅会展
示系统六大数据类型中的心脏超声类型，对应文件格式后缀名为jpg、png 和gz 三
种。如果没有检索到希望进行图像增强的数据，可选择上传对应数据。选择希望进
行增强的数据后点击“确认”进行算法调用。页面进入等待状态，一段时间后查看
结果按钮会亮起，此时点击“查看结果”，页面会弹窗出现超声增强前图片和增强
后图片的对比页面，增强后图片将在原始名称后加入“_en”后缀，两类图片均可



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page87_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page87_img1.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page87_img2.jpeg](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page87_img2.jpeg)

## Page 88

电子科技大学硕士学位论文 
74 
通过点击进行缩放，弹窗最右侧会出现超声图像增强结果的“下载”按钮。如对增
强结果有异议，用户可以点击“审核”进行评论，系统将在评论后为本条算法调用
记录进行备注，同时将本条记录在增强历史记录中以高亮状态展示。超声图像增强
模块活动图如图5-10 所示： 
 
图5-10 超声图像增强模块活动图 
本算法使用了可学习纹理提取器（Learnable Texture Extractor, LTE）[39]实现对
低分辨率图像和参考图像的特征提取。纹理匹配与传输阶段采用注意力机制，将低
分辨率上采样特征作为Q，参考图像上采样再下采样特征作为K，参考图像原始特
征作为V，通过基于余弦相似度的计算来获取相关性，并参与后续特征图计算。系
统使用硬注意力机制直接选择相关性最大的位置进行特征传输。在特征传输过程
中，系统使用软注意力机制根据相关性的置信度调整传输特征的贡献度。多尺度特
征处理阶段首先通过VGG19[40]骨干网络的不同层提取低分辨率图像的多重特征，
然后在原始尺度、2 倍尺度和4 倍尺度三个层次上应用纹理变换器。最后，系统通
过跨尺度特征集成模块（Cross-Scale Feature Integration, CSFI）[39]在不同尺度之间



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page88_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page88_img1.png)

## Page 89

第五章 面向胎儿心脏的分割分类辅助诊断系统详细设计与实现 
75 
交换信息，通过上/下采样和连接操作整合所有尺度的特征，输出最终的超分辨率
图像。 
 辅助诊断模块 
5.6.1 基于心电的先心病预测 
基于心电的先心病预测模块集成于本系统主界面左侧辅助诊断菜单栏内。系
统基于心电的先心病预测为胎儿期筛查的重要功能之一。该功能在临床与超声图
像增强技术互补，胎儿的心电时序特征采集不同于超声筛查，超声成像往往需要胎
儿发育到特定阶段才能形成清晰可辨的心脏结构图像；心电时序特征采集则受影
响较小，能做到提前筛查高危先天性心脏疾病。 
基于心电的先心病预测模块实现如图5-11 所示：  
 
图5-11 基于心电的先心病预测模块实现图 
图中对名为ECG_0.npy 和ECG_1.npy 两个心电数据进行了批量预测操作，最
终预测结果均为正常。 
本模块主要使用者为医生和科研工作者两个角色。用户进入系统后点击系统
左侧菜单栏中的“辅助诊断”后，需要进入“基于心电的先心病预测”的二级菜单
基于心电的先心病预测模块活动图如图5-12 所示： 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page89_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page89_img1.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page89_img2.jpeg](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page89_img2.jpeg)

## Page 90

电子科技大学硕士学位论文 
76 
 
图5-12 基于心电的先心病预测模块活动图 
在“基于心电的先心病预测”的二级菜单内，页面中央会显示预测历史记录，
右侧则是预测算法选择栏。选择本次希望应用的预测算法版本后，点击“新建操作”
按钮进入患者选择页面，在患者选择页面中可以通过点击“患者详情”查看患者数
据，在此模块中患者数据仅会展示系统六大数据类型中的心电类型，对应文件格式
为.csv 和.npy 两种。如果没有检索到希望进行预测的患者数据，此时可选择上传对
应数据。选择好算法输入数据后，点击“确认”进行算法调用。页面进入等待状态，
一段时间后查看结果按钮会亮起，此时点击“查看结果”，页面会出现本次预测的
原始文件和对应的预测结果弹窗。如对预测结果有异议，用户可以点击“审核”进
行评论，系统将在评论后为本条算法调用记录进行备注，同时在预测算法的调用历
史记录中以高亮状态展示。 
本算法采用了多模态图像融合（Multimodal Image Fusion, MIF）框架[41]进行计
算。系统首先对输入的心电信号进行预处理，通过归一化函数对原始信号进行标准
化处理，并采用合成少数过采样技术（Synthetic Minority Over-Sampling Technique, 
SMOTE）解决类别不平衡问题，生成平衡的数据集和对应标签。随后进入多模态



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page90_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page90_img1.png)

## Page 91

第五章 面向胎儿心脏的分割分类辅助诊断系统详细设计与实现 
77 
图像转换阶段，系统利用三种互补的时间序列成像技术将一维心电信号转换为二
维图像表示：通过pyts 库的GramianAngularField（GAF）方法将ECG 信号映射到
角度坐标系统；使用同样位于该包下的MarkovTransitionField（MTF）方法捕捉信
号在不同量化级别之间转换的概率特征；最后使用基于scikit-learn 库中的欧氏距
离计算方法编写的RecurrencePlot（RP）方法捕获信号的循环行为和递归模式。在
融合图像生成环节，系统通过将上述的三种二维图像（GAF、RP、MTF）整合为
标准尺寸三通道RGB 图像。分类阶段采用修改版AlexNet[42]架构，本模块分类结
果为异常和正常两种，需在倒数第二层和最后一层全连接层进行单元数调整以适
应分类结果数量。 
5.6.2 全心脏分割 
全心脏分割模块集成于本系统主界面左侧辅助诊断菜单栏内。该模块可为医
生提供重要的临床诊断支持。目前，先天性心脏病的临床诊断通常需要专业医生在
心脏图像上手动分割心脏子结构，分割结果的准确性高度依赖于医生的专业水平。
此模块的设立旨在通过基于深度学习的人工智能手段吸收高水平医生的分割经验，
做到在具有高准确度分割结果的同时为医院实现人力资源的有效节约。 
全心脏分割模块系统实现如图5-13 所示： 
 
图5-13 全心脏分割模块实现图 
如上图所示，用户对名为ct_test_2038.mha 的心脏数据进行了全心脏分割操作
并点击结果查看，由于技术所限，目前客户端无法使用浏览器直接对.mha 文件进
行图像预览，需要用户将操作结果下载至本地进行查看。 
名为ct_test_2038.mha 的原始图像在本地预览，如图5-14 所示： 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page91_img1.jpeg](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page91_img1.jpeg)

## Page 92

电子科技大学硕士学位论文 
78 
 
图5-14 原始图像 
名为ct_test_2038_infer.mha 的分割结果图像在本地预览，如图5-15 所示： 
 
图5-15 分割结果 
本模块主要使用者为医生和科研工作者两个角色。用户进入系统后需要点击
系统左侧菜单栏中的“辅助诊断”，随后选择“全心脏分割”二级菜单，进入后，



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page92_img1.jpeg](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page92_img1.jpeg)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page92_img2.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page92_img2.png)

## Page 93

第五章 面向胎儿心脏的分割分类辅助诊断系统详细设计与实现 
79 
页面中央会显示全心脏分割历史记录，右侧则是分割算法选择栏。在选择本次希望
应用的分割算法版本后，点击“新建操作”按钮进入患者选择页面，在患者选择页
面中可以通过点击“患者详情”查看患者数据，此模块会展示系统六大数据类型中
的心脏CT 和心脏MR 两种类型数据，两种数据类型对应的文件格式后缀名称均为
jpg、png、mha 和nii 四种之一。如果没有检索到希望进行分割的患者数据，此时
可选择上传对应数据。选择好分割算法的输入数据后，点击“确认”进行算法调用。
页面进入等待状态，一段时间后查看结果按钮会亮起，此时点击“查看结果”，页
面会弹窗出现本次分割的原始文件和对应的分割后文件，分割结果文件会在原始
命名基础上加入“_infer”后缀作为区分。系统仅展示.jpg 和.png 类型的分割结果，
其他类型结果需通过右侧“下载”按钮下载后，使用其他医疗图像软件查看。若对
分割结果有异议，用户可点击“审核”进行评论，系统将为该算法调用记录添加备
注。被审核过的算法调用记录在历史记录页面中会以高亮方式显示。全心脏分割模
块活动图如图5-16 所示： 
 
图5-16 全心脏分割模块活动图 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page93_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page93_img1.png)

## Page 94

电子科技大学硕士学位论文 
80 
本算法使用了CM-TranCaF[43]框架，首先对输入图像进行预处理，包括标准化、
纹理增强以及心脏区域（Region of Interest, ROI）[44]裁剪，作为后续的分割任务提
供输入数据。对于MRI 类型，系统采用基于3D CycleGAN[45, 46]架构的模态转换网
络（Modality Transfer Network， MTN）[47]实现MRI 到CT 的图像转换，以生成与
真实CT 图像高度相似的合成数据。分割过程主要由MAUNet[48]完成，该网络使用
了4 个3D ResNet[49]核心构建单元中的残差块（Res blocks）组成多尺度特征提取
编码器，并在深层特征上应用位置注意力模块（Position Attention Block, PAB）[50]
聚合相似特征以解决边界模糊问题。解码阶段通过带有注意力门控机制（Attention 
Gates, AGs）的跳跃连接缓解背景像素导致的类别不平衡问题。为提高分割精度，
基于心脏各部分的空间位置关系是相对固定的这一医学先验知识，算法在最后使
用空间配置网络（Spatial Configuration Network, SCN）[51]对MAUNet 的粗分割结
果进行优化以生成最终结果。 
 统计分析 
5.7.1 首页大盘 
为满足不同用户群体的信息获取需求，本系统特别设计了可视化交互界面。该
界面包含丰富的图形化展示元素，为不同角色的用户提供了不同的数据洞察能力。
系统管理员视角下的统计分析页面实现如图5-17 所示： 
 
图5-17 统计分析实现图 
在系统层面，管理员可以直观查看医疗机构的层级分布，包括接入医院总数、
二级组织部门总数和三级组织组别总数。在用户规模方面，系统基于权限范围展示



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page94_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page94_img1.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page94_img2.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page94_img2.png)

## Page 95

第五章 面向胎儿心脏的分割分类辅助诊断系统详细设计与实现 
81 
相应的医生和患者数量统计：系统管理员可查看全平台用户数据，而医院管理员则
限于查看本院数据。此外，系统还为所有用户提供了统一的数据分析面板，包括平
台近10 日访问趋势、患者性别比例和年龄分布等关键指标。特别值得一提的是，
系统提供了灵活的算法性能监测配置，用户可以根据医院实际启用的算法类型，自
主选择需要观测的算法预测准确率面板。目前系统支持展示先心病辅助预测类目
（包括多模态协同预测、基于心音的预测和基于心电的预测）以及心脏分割类目（包
括心脏分割、超声心动分割、半监督心脏分割和全心脏分割）的性能指标。这种灵
活的可视化配置机制，有效满足了不同用户对算法性能监测的个性化需求。 
 用户认证与权限管理 
本小节将详细介绍系统的用户管理与权限控制功能模块的设计与实现，详细
的描述了该模块下包含各个子功能的流程与实现。系统使用基于RBAC 模型构建
用户权限体系。实现了用户、角色及权限三大模块的解耦管理。系统管理部分下的
用户管理实现如图5-18 所示： 
 
图5-18 用户管理实现图 
在RBAC 体系中，角色是连接用户和权限的桥梁。角色定义了一组权限集合，
用户通过被分配角色来获取相应权限，而非直接分配权限。这种机制简化了权限管
理，提高了安全性和可维护性。当组织结构或业务需求变化时，只需调整角色权限
设置，无需修改每个用户的权限配置，大大减少了管理成本，同时确保了访问控制
的一致性和灵活性。系统管理部分下的角色管理实现如图5-19 所示： 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page95_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page95_img1.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page95_img2.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page95_img2.png)

## Page 96

电子科技大学硕士学位论文 
82 
 
图5-19 角色管理实现图 
5.8.1 用户管理 
用户管理是面向系统管理员和医院管理员角色对普通用户账号进行管理的功
能。用户管理活动图如图5-20 所示： 
 
图5-20 用户管理活动图 
访问者进入用户管理页面后，可以选择使用搜索待管理用户账号的方式找到
待管理账号。管理员角色对用户账户的管理权限包括修改账户的个人信息和对账



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page96_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page96_img1.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page96_img2.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page96_img2.png)

## Page 97

第五章 面向胎儿心脏的分割分类辅助诊断系统详细设计与实现 
83 
户进行冻结或删除。被管理账户可被修改的个人信息包括账号、密码、邮箱、手机
号、个人描述信息。冻结账户会导致账户无法登陆，系统会提示账户已被冻结，请
联系管理员字样。删除账户为不可逆操作，系统在提示确认删除后，操作者如果选
择确认，被操作账户将在系统中被永久移除。 
5.8.2 角色创建与权限配置 
角色创建功能仅对系统管理员开放。管理员进入角色管理界面后，可以执行新
建角色操作。创建过程包括：首先设置角色基本信息，包括角色名称、角色描述等；
随后需要配置角色的路由权限和接口权限；点击保存后提交至系统进行唯一性验
证，确保角色信息和权限的规范性，系统验证通过后保存角色信息，并记录操作日
志。系统支持以系统已有角色作为权限模板进行快速配置，此设计是为了提高角色
创建效率。管理员对角色的任何创建操作都会记录详细日志，支持后期追溯。角色
创建活动图如图5-21 所示： 
 
图5-21 角色创建活动图 
5.8.3 用户角色分配 
角色分配功能由系统管理员和医院管理员负责，是实现用户权限管理的核心
机制。管理员首先需要在功能页面选择目标用户，之后点击用户详情，进入角色分
配界面。管理员可以为用户分配或移除角色，修改角色配置。同一用户支持同时拥
有多个角色，不同角色之间的权限取并集。所有角色变更操作都需要首先记录操作
日志，日志包括操作人、被操作账户和账户发生的变化。系统核验通过后会发送消



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page97_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page97_img1.png)

## Page 98

电子科技大学硕士学位论文 
84 
息通知用户，并向操作者展示成功提示。若核验失败，系统会提示具体错误原因并
返回操作界面。角色分配活动图如图5-22 所示： 
 
图5-22 角色分配活动图 
值得注意的是，当用户角色发生变化时，如果用户正在使用系统，角色发生变
化的用户在系统缓存中存储的用户权限信息会被设置为过期状态，用户的任何新
操作在校验权限信息时会提示登陆过期，后续操作需要重新登陆账户才能进行，重
新登陆账户后拿到的用户权限信息会被设置为角色变化后的权限信息。 
这种多级的权限管理机制既保证了角色分配的规范性，又通过完整的日志记
录和消息通知确保了操作的透明度。系统通过严格的信息验证机制、完整的操作日
志以及合理的权限分配，有效防止了用户管理混乱和系统资源浪费的问题。 
5.8.4 用户登录 
用户登录作为系统的基础入口功能，不仅是权限控制与身份认证的第一道屏
障，更是整个安全架构的奠基石。它建立了用户与系统之间的初始信任关系，在这
一过程中，登录机制充当着“守门人”角色，决定谁可以进入系统以及以何种身份
进入。成功的身份验证后，系统会生成会话标识或授权令牌，作为用户与系统持续
交互的凭证，同时启动相应的授权流程，将用户与其RBAC 角色关联，从而确定
其可访问的资源范围和操作权限。不仅如此，登录系统还是安全审计的起点，记录
用户的访问时间、位置和设备信息，为后续的行为分析和安全事件溯源提供基础数
据。系统用户登陆活动图如图5-23 所示： 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page98_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page98_img1.png)

## Page 99

第五章 面向胎儿心脏的分割分类辅助诊断系统详细设计与实现 
85 
 
图5-23 用户登陆活动图 
在登录过程中，用户通过浏览器或客户端进入登录页面，输入账号密码后点击
“登录”按钮提交信息至后端。系统进行多重验证，包括账号存在性检查、密码哈
希值比对及账号状态验证。验证失败时，系统返回错误提示并引导用户重新登录；
验证成功时，系统根据用户权限等级自动跳转至相应功能页面。系统实现了基于会
话或令牌的登录态缓存机制，允许用户在5 分钟有效期内无需重复登录，简化了
频繁使用场景下的操作流程。 
5.8.5 用户注册 
用户注册是面向一般用户的账号创建功能，系统注册功能需确保注册用户的
真实性和系统账号信息的规范性。用户注册功能作为系统身份认证体系的基础组
件，承担着为普通用户建立系统访问凭证的关键职责。该功能模块不仅需要为用户
提供便捷的账户创建途径，更需要在系统安全性和数据完整性方面发挥重要作用。
本系统采用不可逆哈希算法存储用户密码等关键数据，可有效防止因数据库泄露
而引发的密码安全问题。 
访问者进入注册页面后，系统要求填写账号、密码、姓名和手机号等必填信息。
系统首先对提交的信息进行合法性验证和手机号真实性验证，后续还可根据系统
运行者需求进行身份证实名认证。验证通过后，系统保存用户信息并创建账号。若
验证失败，系统会给出具体错误提示并要求重新填写。该机制确保了注册用户的真
实性和系统账号的规范性。 
用户注册活动图如图5-24 所示： 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page99_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page99_img1.png)

## Page 100

电子科技大学硕士学位论文 
86 
 
图5-24 用户注册活动图 
 本章小结 
本章介绍了基于人工智能的面向胎儿心脏的分割分类辅助诊断系统的详细设
计和实现过程，系统采用第四章的系统架构方案，从系统的基本功能和数据管理出
发，到预处理及辅助诊断核心两个功能，详细介绍了系统各个模块的设计思路，结
合核心代码进行了解析。该结构化设计方案遵循软件工程最佳实践，为后续系统测
试工作奠定了技术基础。 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page100_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page100_img1.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page100_img2.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page100_img2.png)

## Page 101

第六章 面向胎儿心脏的分割分类辅助诊断系统测试 
87 
面向胎儿心脏的分割分类辅助诊断系统测试 
软件测试是验证系统是否满足需求规格说明书要求的重要环节。对于医疗辅
助诊断系统而言，测试的重要性更为突出，不仅需要保证功能的完整性，还要确保
数据处理的准确性和系统响应的实时性。本章将从功能测试和性能测试两个维度，
对系统进行全面测试评估。 
 软硬件测试环境 
硬件测试环境是测试系统所需的物理设施。软件测试环境则是操作系统、数据
库和其他应用软件等虚拟设施。服务器硬件配置和客户端硬件配置如表6-1 和表6-
2 所示： 
表6-1 测试服务器硬件配置 
配置名 
介绍 
处理器 
Intel Xeon Gold 6338 32 核64 线程 
GPU 
NVIDIA A100 80GB 
内存 
256G 
存储 
100T 混合存储 
网络 
1000Mbps 
输入输出设备 
普通键盘、鼠标、显示器 
表6-2 测试客户端硬件配置 
配置名 
介绍 
处理器 
AMD Ryzen 5 7500F 
GPU 
NVIDIA RTX 4070 12GB 
内存 
32G 
存储 
2TB NVMe SSD 
网络 
100Mbps 
输入输出设备 
普通键盘、鼠标、显示器 
测试服务器软件配置与测试客户端的软件配置如表6-3 和表6-4 所示： 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page101_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page101_img1.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page101_img2.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page101_img2.png)

## Page 102

电子科技大学硕士学位论文 
88 
表6-3 测试服务器软件配置 
配置名 
介绍 
操作系统 
Ubuntu 24.04 LTS 
Docker Engine 
Community 27.3.1 
表6-4 测试客户端软件配置 
配置名 
介绍 
操作系统 
Windows 11 
浏览器 
Chrome 133.0.6943.142 
因系统被设计为通过Docker 技术容器化部署，故数据库等其他软件测试环境
为Docker 内部环境。在容器构建方面，由于测试基于单服务器的硬件环境，系统
基础服务均采用单容器部署方案；而算法服务则均构建2 个容器，以模拟生产环
境下的负载均衡情况。本次测试的核心容器版本和部署情况如表6-5 所示： 
表6-5 核心容器部署情况 
容器名称 
容器描述 
版本 
内存限制 
硬盘限制 
部署数
量 
yiqi-nacos 
服务发现注册中心 
2.0.2 
1G 
1G 
1 
yiqi-redis 
缓存服务器 
7.4 
8G 
20G 
1 
yiqi-minio 
文件服务器 
RELEAS
E.2024-
11-
07T00-
52-20Z 
8G 
1024G 
1 
yiqi-api-
gateway 
分布式网关 
1.0.0 
4G 
20G 
1 
yiqi-nginx 
负载均衡服务器 
1.27 
1G 
1G 
1 
yiqi-backend 
系统后台服务器 
1.0.0 
8G 
50G 
1 
yiqi-mysql 
关系型数据库 
5.7.24 
1G 
256G 
1 
yiqi-totalCS 
全心脏分割微服务 
1.0.0 
4G 
50G 
2 
yiqi- usEn 
超声图像增强微服务 
1.0.0 
4G 
20G 
2 
yiqi-ecgCf 
基于心电的先心病预测
微服务 
1.0.0 
4G 
20G 
2 
 系统功能测试 
功能测试旨在验证系统功能是否符合预期要求，其核心任务是通过分析需求
文档、操作手册及设计方案等资料，确认系统行为的正确性。为提升测试效率，测
试人员通常采用脚本编写或自动化测试工具实施验证流程。在界面测试环节，测试



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page102_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page102_img1.png)

## Page 103

第六章 面向胎儿心脏的分割分类辅助诊断系统测试 
89 
人员通过模拟用户操作或发送自动化脚本请求至服务器，随后对比预期输出与实
际响应结果。若发现结果偏差，需将问题反馈至开发团队进行代码修正，并通过回
归测试持续验证，直至系统输出完全满足需求规范。该测试方法又称为黑盒测试或
数据驱动测试，其核心原理是将被测系统视为封闭单元。测试人员无需分析内部代
码逻辑与执行机制，而是通过构建特定测试用例，着重检测系统在特定条件下是否
产生预期外的异常行为。 
6.2.1 系统功能测试策略 
本系统功能性测试主要以黑盒测试方式进行，软硬件环境见上一小节。本次测
试用例设计采用分层策略，重点覆盖以下测试维度： 
（1）合法数据验证 
通过等价类划分法（Equivalence Partitioning, EP）生成典型有效输入组合。覆
盖业务场景矩阵中的常规操作路径（如：标准表单提交/常规查询条件）。 
（2）非法数据验证 
构建违反业务规则、数据类型、长度限制的异常输入集以验证系统对非法输入
的识别与容错机制。测试采用边界值分析法（Boundary Value Analysis, BVA）对数
值型参数进行极值测试（如：最小值-1/最小值/最大值/最大值+1）。针对枚举型参
数实施全排列组合测试（如：状态机切换边界/多条件联合约束）。 
鉴于按照以上原则构建的测试用例有较高重复性特性，本章内容仅展示核心
功能的关键路径、典型异常场景以及高风险边界条件的测试用例与测试结果。 
6.2.2 用户认证与权限管理测试 
本节内容展示了用户管理与角色管理模块的核心功能测试用例及执行结果。
测试覆盖了用户认证与权限管理模块的核心功能验证与高风险场景验证。通过构
造标准化操作流程测试用例验证系统可用性。所有测试用例均严格基于需求规格
说明书与系统设计文档进行设计，测试数据覆盖了边界条件与典型业务场景。执行
结果显示，各项功能的实际操作流程与预期效果完全一致，响应时间与资源占用均
在预设阈值范围内。这一结果充分表明系统在用户认证和权限管理这两个安全敏
感的关键功能上完全满足设计要求，具备了投入生产环境的基本条件。同时，测试
过程中发现的安全漏洞或逻辑缺陷均已得到修复。因系统测试用例过多，本节主要
对等价类划分法中的合法数据用例构建进行展示，用户认证与权限管理测试用例
如表6-6 所示： 


## Page 104

电子科技大学硕士学位论文 
90 
表6-6 用户认证与权限管理测试用例 
用例编号 
测试项目 
操作流程 
期望效果 
测试结果 
1 
用户管理/
添加 
1.进入“用户管理”-“添
加”按钮 
2.输入正确的用户信息： 
3.点“保存”按钮 
4.查看窗口显示 
1.弹出添加窗口，且窗口内
容显示正确 
2.输入成功 
3.保存成功，提示“添加成
功” 
4.显示内容正确，字段完全 
符合期望 
2 
用户管理/
编辑 
1.进入“用户管理”，在某
一条用户记录后的
checkbox 后打“√” 
2.点“编辑”按钮 
3.修改正确的用户信息 
4.点“保存”按钮 
5.查看用户列表添加显示效
果 
1.成功勾选该记录 
2.正确弹出编辑窗口，且显
示内容与列表中保持一致 
3.修改成功 
4.保存成功，提示“修改成
功” 
5.列表该修改记录的各字段
内容显示与修改后一致 
符合期望 
3 
用户管理/
详情 
1.在用户列表窗口中，选择
用户名称 
2.点击“详情”按钮 
1.选择成功 
2.正确查询出该用户的基本
信息 
符合期望 
4 
用户管理/
查询 
1.进入“用户管理” 
2.逐一单个使用过滤条件 
3.点“查找”按钮 
注意： 
1.高级搜索中查询条件不应
包含外面的查询条件 
2.高级搜索中的【搜索】功
能应组合外面的查询条件 
3.退出当前页面时才清空已
设置的查询条件，否则默
认保存 
1.操作成功 
2.操作成功 
3.精确查找出对应列表信息 
符合期望 
5 
用户管理/
删除 
1.在用户信息列表窗口中，
选择一个有数据关联的用
户 
2.点“删除”按钮 
3.确认删除，查看系统提示 
1.勾选成功 
2.提示“该用户中有关联数
据，无法删除”； 
点“确定”按钮后，则返
回到之前的列表界面 
符合期望 
6 
用户管理/
删除 
1.删除关联的数据。 
2.在用户信息列表窗口中，
选择没有关联的用户 
3.点“删除”按钮 
4.确认删除，查看系统提示 
1.勾选成功 
2.弹出是否删除该信息的提
示对话框 
若点“是”，则删除该信
息 
若点“否”，则返回到之
前的列表界面 
3.提示“删除成功”，信息
列表中无该信息 
符合期望 


## Page 105

第六章 面向胎儿心脏的分割分类辅助诊断系统测试 
91 
表6-6 用户认证与权限管理测试用例（续） 
用例编号 
测试项目 
操作流程 
期望效果 
测试结果 
7 
用户管理/
启用/停用 
1.进入用户信息列表 
2.点“启用/停用”按钮 
3.确认此用户已启用/停
用，查看用户列表状态显
示 
1.勾选成功 
2.弹出是否启用/停用该用
户的提示对话框 
若点“是”，则启用/停用
该信息 
若点“否”，则返回到之
前的列表界面 
3.提示“启用/停用成
功”，信息列表中显示该
用户操作后信息状态 
符合期望 
8 
角色管理/
添加 
1.进入“角色管理”-“添
加”按钮 
2.输入正确的角色信息： 
3.点“保存”按钮 
4.查看窗口显示 
1.弹出添加窗口，且窗口内
容显示正确 
2.输入成功 
3.保存成功，提示“添加成
功” 
4.显示内容正确，字段完全 
符合期望 
9 
角色管理/
编辑 
1.进入“角色管理”，在某
一条角色记录后的
checkbox 后打“√” 
2.点“编辑”按钮 
3.修改正确的角色信息 
4.点“保存”按钮 
5.查看角色列表添加显示效
果 
1.成功勾选该记录 
2.正确弹出编辑窗口，且显
示内容与列表中保持一致 
3.修改成功 
4.保存成功，提示“修改成
功” 
5.列表该修改记录的各字段
内容显示与修改后一致 
符合期望 
10 
角色管理/
详情 
1.在角色列表窗口中，选择
角色名称 
2.点击“详情”按钮 
1.选择成功 
2.正确查询出该角色的基本
信息，基本信息需要包括
角色的路由权限信息、接
口权限信息、角色描述信
息 
符合期望 
11 
角色管理/
查询 
1.进入“角色管理” 
2.逐一单个使用过滤条件 
3.点“查找”按钮 
注意： 
1.高级搜索中查询条件不应
包含外面的查询条件 
2.高级搜索中的【搜索】功
能应组合外面的查询条件 
3.退出当前页面时才清空已
设置的查询条件，否则默
认保存 
1.操作成功 
2.操作成功 
3.精确查找出对应列表信息 
符合期望 
12 
用户登陆 
1.进入系统登陆页面 
2.输入账号密码 
3.点击登陆 
1.成功登陆系统 
符合期望 


## Page 106

电子科技大学硕士学位论文 
92 
表6-6 用户认证与权限管理测试用例（续） 
用例编号 
测试项目 
操作流程 
期望效果 
测试结果 
13 
用户注册 
1.进入系统登陆页面 
2.点击用户注册 
3.填写注册信息 
1.页面提示注册成功 
符合期望 
14 
角色管理/
删除 
1.在角色管理列表窗口中，
选择一个角色名称 
2.点“删除”按钮 
3.确认删除，查看列表显示
效果 
1.勾选成功 
2.弹出是否删除该信息的提
示对话框 
若点“是”，则删除该信
息 
若点“否”，则返回到之
前的列表界面 
3.提示“删除成功”，信息
列表中无该信息 
符合期望 
15 
角色管理/
启用/停用 
1.进入用户信息列表 
2.点“启用/停用”按钮 
3.确认此用户已启用/停
用，查看用户列表状态显
示 
1.勾选成功 
2.弹出是否启用/停用该角
色的提示对话框 
若点“是”，则启用/停用
该信息 
若点“否”，则返回到之
前的列表界面 
3.提示“启用/停用成
功”，信息列表中显示该
角色操作后信息状态 
符合期望 
6.2.3 数据管理测试 
本节内容详细呈现了数据类别管理模块的核心功能测试用例及其全面执行结
果。测试工作系统性地覆盖了数据类别的增加、删除、修改、查询及精确检索等基
础操作，重点验证了数据操作的完整性与一致性、界面交互的规范性与友好性、以
及各类约束规则的有效性与健壮性。通过构造标准化操作流程测试用例，从多角度
验证了系统在实际应用场景中的可用性与稳定性。 
所有测试用例均严格基于需求规格说明书与系统设计文档进行设计，测试数
据涵盖了常规场景、边界条件与异常处理。执行结果显示，各项功能的实际操作流
程与预期效果完全一致，响应时间与资源占用均符合性能要求。这一结果充分表明
系统在数据分类管理、事务性操作控制及信息精准定位等关键功能上完全满足设
计要求，为用户提供了高效、准确的数据类别管理能力。同时，界面反馈及操作逻
辑符合用户习惯，提升了系统整体易用性。因系统测试用例过多，本节主要对等价
类划分法中的合法数据用例构建进行展示，数据管理模块的测试用例如表6-7 所
示： 


## Page 107

第六章 面向胎儿心脏的分割分类辅助诊断系统测试 
93 
表6-7 数据管理测试用例 
用例编号 
测试项目 
操作流程 
期望效果 
测试结果 
1 
数据类别
管理/添加 
1.进入“数据类别管理”-
“添加”按钮 
2.输入正确的数据类别管理
信息： 
3.点“保存”按钮 
4.查看窗口显示 
1.弹出添加窗口，且窗口内
容显示正确 
2.输入成功 
3.保存成功，提示“添加成
功” 
4.显示内容正确，字段完全 
符合期望 
2 
数据类别
管理/编辑 
1.进入“数据类别管理”，
在某一条数据类别管理记
录后的checkbox 后打
“√” 
2.点“编辑”按钮 
3.修改正确的数据类别管理
信息 
4.点“保存”按钮 
5.查看数据类别管理列表添
加显示效果 
1.成功勾选该记录 
2.正确弹出编辑窗口，且显
示内容与列表中保持一致 
3.修改成功 
4.保存成功，提示“修改成
功” 
5.列表该修改记录的各字段
内容显示与修改后一致 
符合期望 
3 
数据类别
管理/查看
详情 
1.在数据类别管理列表窗口
中，选择数据类别管理名
称 
2.点击“详情”按钮 
1.选择成功 
2.正确查询出该数据类别管
理的基本信息 
符合期望 
4 
数据类别
管理/精确
查找 
1.进入“数据类别管理” 
2.逐一单个使用过滤条件 
3.点“查找”按钮 
注意： 
1.高级搜索中查询条件不应
包含外面的查询条件 
2.高级搜索中的【搜索】功
能应组合外面的查询条件 
3.退出当前页面时才清空已
设置的查询条件，否则默
认保存 
1.操作成功 
2.操作成功 
3.精确查找出对应列表信息 
符合期望 
5 
数据类别
管理/单个
删除 
1.在数据类别管理列表窗口
中，选择一个数据类别管
理名称 
2.点“删除”按钮 
3.确认删除，查看列表显示
效果 
1.勾选成功 
2.弹出是否删除该信息的提
示对话框 
若点“是”，则删除该信
息 
若点“否”，则返回到之
前的列表界面 
3.提示“删除成功”，信息
列表中无该信息 
符合期望 


## Page 108

电子科技大学硕士学位论文 
94 
6.2.4 超声图像增强模块测试 
本节内容主要为超声图像增强模块的核心功能测试用例及执行结果。测试覆
盖患者信息管理、图像增强处理、结果审核追踪及历史数据检索等关键操作，重点
验证医学图像处理流程完整性、数据交互准确性及审核机制有效性。通过构造标准
化操作流程测试用例验证系统可用性。本测试所有用例均基于需求文档设计，执行
结果与期望效果完全一致，表明系统在图像增强控制和历史追溯功能上满足设计
要求。因系统测试用例过多，本节主要对等价类划分法中的合法数据用例构建进行
展示，超声图像增强模块测试用例如表6-8 所示： 
表6-8 超声图像增强模块测试用例 
用例编号 
测试项目 
操作流程 
期望效果 
测试结果 
1 
超声图像
增强/新建
患者 
1.进入“超声图像增强”-
“新建患者”按钮 
2.输入正确的患者信息： 
3.点“保存”按钮 
4.查看窗口显示 
1.弹出新建患者窗口，且窗
口内容显示正确 
2.输入成功 
3.保存成功，提示“新建患
者成功” 
4.显示内容正确，字段完全 
符合期望 
2 
超声图像
增强/图像
增强执行 
1.进入“超声图像增强”页
面 
2.搜索患者“张桑” 
3.选择要增强的图像类型 
4.选择要进行的增强操作 
5.选择要进行增强的单张图
像 
6.点击保存 
7.查看增强的图像 
1.进入“超声图像增强”页
面 
2.成功搜索患者 
3.选择成功 
4.增强成功 
5.保存成功 
6.图像成功增强 
符合期望 
3 
超声图像
增强/查看
图像 
1.进入“超声图像增强”页
面 
2.搜索患者“张桑” 
3.查看增强的图像 
1.进入“超声图像增强”页
面 
2.成功搜索患者 
3.查看成功 
符合期望 
4 
超声图像
增强/下载
图像 
1.进入“超声图像增强”页
面 
2.搜索患者“张桑” 
3.下载图像 
1.进入“超声图像增强”页
面 
2.成功搜索患者 
3.下载成功 
符合期望 
5 
超声图像
增强/查看
详情 
1.在超声图像增强列表窗口
中，选择医学图像名称 
2.点击“详情”按钮 
1.选择成功 
2.正确查询出该医学图像的
基本信息 
符合期望 
6 
超声图像
增强/结果
审核 
1.进入“超声图像增强”页
面 
2.搜索患者“张桑” 
3.查看增强的图像4. 点击
“人工审核”按钮 
5. 输入审核意见并确认 
1. 成功进入“超声图像增
强”页面2. 搜索成功 
3. 选择记录成功 
4. 弹出审核窗口成功 
5. 审核意见保存成功，记
录状态更新为“已审核” 
符合期望 


## Page 109

第六章 面向胎儿心脏的分割分类辅助诊断系统测试 
95 
表6-8 超声图像增强模块测试用例（续） 
用例编号 
测试项目 
操作流程 
期望效果 
测试结果 
7 
超声图像
增强历史
结果查看 
1. 进入“超声图像增强”
页面 
2. 搜索患者 
3. 点击“历史查看”按钮 
4. 设置时间范围 
1. 成功进入“超声图像增
强”页面 
2. 搜索成功 
3. 弹出历史结果窗口 
4. 显示指定时间范围内的
预测结果 
符合期望 
8 
超声图像
增强/精确
查找 
1.进入“超声图像增强” 
2.逐一单个使用过滤条件 
3.点“查找”按钮 
1.操作成功 
2.操作成功 
3.精确查找出对应列表信息 
符合期望 
9 
超声图像
增强/单个
删除 
1.在超声图像增强列表窗口
中，选择一个医学图像名
称 
2.点“删除”按钮 
3.确认删除，查看列表显示
效果 
1.勾选成功 
2.弹出是否删除该信息的提
示对话框 
若点“是”，则删除该信
息 
若点“否”，则返回到之
前的列表界面 
3.提示“删除成功”，信息
列表中无该信息 
符合期望 
6.2.5 基于心电的先心病预测模块测试 
本届主要内容为基于心电的先心病预测模块的核心功能测试用例及执行结果。
测试覆盖患者信息管理、心电数据上传、预测算法执行、结果审核追踪及历史追溯
等关键流程，重点验证预测模块整体的流程完整性及诊断结果可溯性。通过构造标
准化操作流程测试用例检验系统可用性。本测试所有用例均基于需求文档设计，执
行结果与期望效果完全一致，表明系统此模块核心功能上可以满足原模块需求设
计要求。因系统测试用例过多，本节主要对等价类划分法中的合法数据用例构建进
行展示，基于心电的先心病预测模块测试用例如表6-9 所示： 
表6-9 基于心电的先心病预测模块测试用例 
用例编号 
测试项目 
操作流程 
期望效果 
测试结果 
1 
基于心电
的先心病
预测/新建
患者 
1. 进入“基于心电的先心
病预测”-“新建患者”按
钮 
2. 输入正确的患者信息：
姓名、年龄、性别、联系
方式等 
3. 点“保存”按钮 
4. 查看窗口显示 
1. 弹出新建患者窗口，且
窗口内容显示正确 
2. 输入成功 
3. 保存成功，提示“新建
患者成功” 
4. 显示内容正确，字段完
全 
符合期望 


## Page 110

电子科技大学硕士学位论文 
96 
表6-9 基于心电的先心病预测模块测试用例（续） 
用例编号 
测试项目 
操作流程 
期望效果 
测试结果 
2 
基于心电
的先心病
预测/数据
上传 
1. 进入“基于心电的先心
病预测”页面 
2. 搜索患者 
3. 点击“上传心电数据”
按钮 
4. 选择本地心电数据文件 
5. 点击确认上传 
1. 成功进入心电预测页面 
2. 成功搜索到患者 
3. 弹出上传窗口 
4. 选择文件成功 
5. 上传成功，提示“心电
数据上传成功” 
符合期望 
3 
基于心电
的先心病
预测/先心
病预测执
行 
1. 进入“基于心电的先心
病预测”页面 
2. 搜索患者 
3. 选择已预处理的心电数
据 
4. 点击“开始预测”按钮 
5. 等待预测完成 
1. 成功进入预测页面 
2. 成功搜索到患者 
3. 选择数据成功 
4. 开始预测，显示进度条 
5. 预测完成，显示预测结
果和概率值 
符合期望 
4 
基于心电
的先心病
预测/预测
结果查看 
1. 进入“基于心电的先心
病预测”页面 
2. 搜索患者 
3. 选择已完成预测的记录 
4. 点击“查看详情”按钮 
1. 成功进入预测页面 
2. 成功搜索到患者 
3. 选择记录成功 
4. 显示详细预测结果，包
括：预测类型、概率值、
关键特征点标记、建议后
续检查等 
符合期望 
5 
基于心电
的先心病
预测/查看
详情 
1.在心电文件列表窗口中，
选择心电数据名称 
2.点击“详情”按钮 
1.选择成功 
2.正确查询出该心电数据的
基本信息 
符合期望 
5 
基于心电
的先心病
预测/结果
审核 
1. 进入“基于心电的先心
病预测”页面 
2. 搜索患者 
3. 选择预测记录 
4. 点击“人工审核”按钮 
5. 输入审核意见并确认 
1. 成功进入预测页面 
2. 搜索成功 
3. 选择记录成功 
4. 弹出审核窗口 
5. 审核意见保存成功，记
录状态更新为“已审核” 
符合期望 
6 
基于心电
的先心病
预测/历史
结果查看 
1. 进入“基于心电的先心
病预测”页面 
2. 搜索患者 
3. 点击“历史查看”按钮 
4. 设置时间范围 
1. 成功进入预测页面 
2. 搜索成功 
3. 弹出历史结果窗口 
4. 显示指定时间范围内的
预测结果 
符合期望 
7 
基于心电
的先心病
预测/单个
删除 
1.在列表窗口中，选择一个
心电数据名称 
2.点“删除”按钮 
3.确认删除，查看列表显示
效果 
1.勾选成功 
2.弹出是否删除该信息的提
示对话框 
若点“是”，则删除该信
息 
若点“否”，则返回到之
前的列表界面 
3.提示“删除成功”，信息
列表中无该信息 
符合期望 


## Page 111

第六章 面向胎儿心脏的分割分类辅助诊断系统测试 
97 
6.2.6 全心脏分割模块测试 
本届内容主要为全心脏分割模块的核心功能测试用例及执行结果。测试覆盖
患者数据管理、医学影像上传、分割算法执行、结果审核追踪及历史记录检索等全
流程操作，重点操作流程的可靠性和医疗数据可追溯性。通过构造标准化操作流程
验证系统可用性。本测试使用的所有用例均基于需求文档设计，执行结果与期望效
果完全一致，满足模块最初的需求设计。因系统测试用例过多，本节主要对等价类
划分法中的合法数据用例构建进行展示，全心脏分割模块测试用例如表6-10 所示： 
表6-10 全心脏分割模块测试用例 
用例编号 
测试项目 
操作流程 
期望效果 
测试结果 
1 
全心脏分割/
新建患者 
1. 进入“全心脏分割”-
“新建患者”按钮 
2. 输入正确的患者信息：
姓名、年龄、性别、联系
方式等 
3. 点“保存”按钮 
4. 查看窗口显示 
1. 弹出新建患者窗
口，且窗口内容显示
正确 
2. 输入成功 
3. 保存成功，提示
“新建患者成功” 
4. 显示内容正确，
字段完全 
符合期望 
2 
全心脏分割/
数据上传 
1. 进入“全心脏分割”页
面 
2. 搜索患者 
3. 点击“上传心脏影像”
按钮 
4. 选择本地心脏影像文件 
5. 点击确认上传 
1. 成功进入全心脏
分割页面 
2. 成功搜索到患者 
3. 弹出上传窗口 
4. 选择文件成功 
5. 上传成功，提示
“心脏影像上传成
功” 
符合期望 
3 
全心脏分割/
全心脏分割
执行 
1. 进入“全心脏分割”页
面 
2. 搜索患者 
3. 选择已上传的心脏影像
数据 
4. 点击“开始分割”按钮 
5. 等待分割完成 
1. 成功进入分割页
面 
2. 成功搜索到患者 
3. 选择数据成功 
4. 开始分割，显示
进度条 
5. 分割完成，提示
“分割任务完成” 
符合期望 
4 
全心脏分割/
结果下载 
1. 进入“全心脏分割”页
面 
2. 搜索患者 
3. 选择已完成分割的记录 
4. 点击“下载结果”按钮 
5. 选择保存位置 
6. 确认下载 
1. 成功进入分割页
面 
2. 成功搜索到患者 
3. 选择记录成功 
4. 弹出下载选项 
5. 选择保存位置成
功 
6. 下载成功，文件
保存到指定位置 
符合期望 


## Page 112

电子科技大学硕士学位论文 
98 
表6-10 全心脏分割模块测试用例（续） 
用例编号 
测试项目 
操作流程 
期望效果 
测试结果 
5 
全心脏分割/
查看详情 
1. 在心脏影像列表窗口
中，选择心脏影像数据名
称 
2. 点击“详情”按钮 
1. 选择成功 
2. 正确查询出该心
脏影像数据的基本信
息  
符合期望 
6 
全心脏分割/
结果审核 
1. 进入“全心脏分割”页
面 
2. 搜索患者 
3. 选择分割记录 
4. 点击“人工审核”按钮 
5. 输入审核意见并确认 
1. 成功进入分割页
面 
2. 搜索成功 
3. 选择记录成功 
4. 弹出审核窗口 
5. 审核意见保存成
功，记录状态更新为
“已审核” 
符合期望 
7 
全心脏分割/
历史结果查
看 
1. 进入“全心脏分割”页
面 
2. 搜索患者 
3. 点击“历史查看”按钮 
4. 设置时间范围 
1. 成功进入分割页
面 
2. 搜索成功 
3. 弹出历史结果窗
口 
4. 显示指定时间范
围内的分割结果 
符合期望 
8 
全心脏分割/
精确查找 
1. 进入“全心脏分割”页
面 
2. 使用过滤条件(日期范
围、分割模型类型、审核
状态等) 
3. 点击“查找”按钮 
1. 成功进入分割页
面 
2. 设置过滤条件成
功 
3. 查询成功，显示
符合条件的分割记录 
符合期望 
9 
全心脏分割/
单个删除 
1. 在列表窗口中，选择一
个心脏影像数据名称 
2. 点“删除”按钮 
3. 确认删除，查看列表显
示效果 
1. 勾选成功 
2. 弹出是否删除该
信息的提示对话框 
若点“是”，则删除
该信息 若点
“否”，则返回到之
前的列表界面 
3. 提示“删除成
功”，信息列表中无
该信息 
符合期望 
 性能测试 
工程项目开发的系统通常都有特定的性能和效率目标，这些指标主要描述了
软件程序在特定负载与配置条件下的响应速度和吞吐能力。因此，各类软件产品正
式投入使用前，均需通过一系列完整的性能评估测试。此类测试旨在验证软件能否
达成预先设定的性能标准，同时识别系统中可能存在的效能缺陷或瓶颈点，从而实



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page112_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page112_img1.png)

## Page 113

第六章 面向胎儿心脏的分割分类辅助诊断系统测试 
99 
现优化与提升系统表现的目的。性能测试主要分为两个方面：负载测试与压力测试。
前者旨在确保软件在超出最大预期工作量情况下仍能维持正常运转，并评估多项
性能特征，包括系统反应时间、事务处理效率以及其他时间相关指标。而压力测试
采取不同思路，它不是在标准环境下进行手动或自动化测试，而是选择在计算资源
受限或其他系统资源不足的情况下执行，这些受限资源通常涉及内存、处理器使用
率、存储空间及网络带宽等方面。 
6.3.1 系统基本接口测试 
本次测试将采用JMeter 对系统基础功能的核心接口实施性能测试。通过逐步
递增线程数的测试策略，同步开展负载与压力测试，旨在确定系统负载变化的临界
阈值。该测试方法能够在单次实验过程中，完整记录系统从正常运行到极限状态直
至崩溃的性能变化曲线，为系统性能评估提供完整画像。 
在使用JMeter 进行系统基础接口测试前，需对JMeter 应用的配置项进行简要
说明。核心配置项主要包括以下三项：线程数、Ramp-Up Period 和循环次数。其
中，线程数表示测试中允许的最大并发线程数量；Ramp-Up Period 指从启动到达
到最大线程数所需的时间；循环次数则代表测试的重复执行次数。 
在本系统应用场景下，根据普通三甲医院同一科室同时使用的医生和科研人
员统计数据得出，系统基础查询接口峰值并发量为约为150。经测试在系统并发峰
值时测试结果错误率为0%，随着线程数增大至13000 后错误率陡增，这说明此系
统基础查询接口已经达到了临界点。需特别说明的是，当错误率达到100%时，平
均响应时长指标统计结果将全部来自接口返回错误信息的时长，此时该指标无意
义。基础查询接口测试结果如表6-11 所示： 
表6-11 基础查询接口测试结果 
线程数 
Ramp-Up 
Period 
循环次数 
平均响应时长 
错误率 
50 
5s 
3 
15ms 
0% 
150 
10s 
3 
15ms 
0% 
5000 
60s 
3 
15ms 
0% 
13000 
60s 
3 
17ms 
0.47% 
15000 
60s 
3 
42ms 
13.53% 
30000 
60s 
3 
964ms 
42.27% 
50000 
60s 
3 
1704ms 
81.09% 
60000 
60s 
3 
 
100.00% 
医疗影像等多种类型的数据上传同样是本系统的重要功能，考虑到用户在使
用本系统时同一时间进行大量数据上传行为的情况较为少见，数据上传接口较基
本查询接口的峰值并发量实际会低得多。因本系统数据输入输出包含了多种文件


## Page 114

电子科技大学硕士学位论文 
100 
类型，本节只展示将大小约为22.1MB，格式为.mha 的患者CT 图像作为测试文件
的测试结果。经测试，系统在并发峰值150 线程数时错误率为0%，符合系统负载
要求，在线程数超过8500 时错误率陡增，此时已达到数据上传接口临界点。数据
上传接口测试结果如表6-12 所示： 
表6-12 数据上传接口测试结果 
线程数 
Ramp-Up 
Period 
循环次数 
平均响应时长 
错误率 
50 
5s 
3 
19370ms 
0% 
150 
10s 
3 
58967ms 
0% 
8000 
60s 
3 
332528ms 
0% 
8500 
60s 
3 
657125ms 
11.47% 
9000 
60s 
3 
686012ms 
29.45% 
10000 
60s 
3 
 
100.00% 
根据系统非功能需求对基本查询接口和上传接口的规定，由上表可知，在并发
峰值时，基本查询接口的平均响应时间为15ms，低于系统规定的1s 上限。数据上
传接口的响应时间主要受客户端网络带宽影响，因此非功能需求未对其响应时间
进行约束，仅要求错误率为0%，实际测试结果满足这一要求。 
6.3.2 FastAPI 和gRPC 框架接口对比测试 
如本文5.2 节系统架构设计部分进行的介绍，在本系统中，系统中的接口可以
被大致分为两类，分别是业务模块下的通用查询接口和独立模块化的算法接口。本
系统通用查询接口均基于Spring Boot 框架实现，算法接口则提供了FastAPI 和
gRPC 两种框架实现，故本小节只针对算法接口进行不同框架间的对比测试。 
在本系统对算法模块接口的设计中，算法接口计算产生的结果文件或其他二
进制内容会被优先存储至对象型数据库中，在此操作下接口返回值主体中将不会
直接传输计算产生的结果文件或其他二进制内容，而是传输对象数据库中的数据
地址。在此设计下，密集计算接口的返回值与通用查询接口有相同的返回内容设计，
返回内容中的主体均为JSON 结构，其格式确定性较强。 
本小节的接口测试使用了如本文2.3 节介绍的Gunicorn 服务器作为FastAPI 和
gRPC 框架的Python WSGI 服务器，两种框架均配置了10 个工作进程，不同框架
的接口内部均使用了相同的测试业务逻辑，以统计不同框架实现相同业务逻辑接
口的调用速度和稳定性表现。 
首先对基于FastAPI 框架实现的接口进行测试，其测试结果如表6-13 所示： 


## Page 115

第六章 面向胎儿心脏的分割分类辅助诊断系统测试 
101 
表6-13 基于FastAPI 框架实现的接口测试结果 
线程数 
Ramp-
Up 
Period 
循环次数 
平均响应时长 
错误率 
平均返回值 
150 
10s 
3 
32594ms 
0% 
214.0Bytes 
300 
10s 
3 
66270ms 
0% 
214.0Bytes 
450 
10s 
3 
100483ms 
0% 
214.0Bytes 
600 
10 
3 
134892ms 
0% 
214.0Bytes 
750 
10s 
3 
168286ms 
0% 
214.0Bytes 
900 
10s 
3 
201860ms 
0% 
214.0Bytes 
1050 
10s 
3 
243627ms 
0% 
214.0Bytes 
1200 
10s 
3 
273275ms 
0% 
214.0Bytes 
随后，对基于gRPC 框架实现的接口进行相同配置项的测试，其测试结果如表
6-14 所示： 
表6-14 基于gRPC 框架实现的接口测试结果 
线程数 
Ramp-
Up 
Period 
循环次数 
平均响应时长 
错误率 
平均返回值 
150 
10s 
3 
28235ms 
0% 
168.0Bytes 
300 
10s 
3 
65791ms 
0% 
168.0Bytes 
450 
10s 
3 
92200ms 
0% 
168.0Bytes 
600 
10s 
3 
121778ms 
0% 
168.0Bytes 
750 
10s 
3 
140305ms 
0% 
136.0Bytes 
900 
10s 
3 
174585ms 
12.33% 
159.5Bytes 
1050 
10s 
3 
190825ms 
22.95% 
150.1 Bytes 
1200 
10s 
3 
207223ms 
34.33% 
144.4 Bytes 
由上表可知，基于gRPC 框架实现的接口在线程数为900 时出现了部分响应
错误的情况，当发生此情况时，出现错误的接口会返回与正常返回值不同的错误内
容，且响应时长会不同程度的低于当次测试的平均响应时长。因此，在错误率大于
0%时，平均返回值和平均响应时长均受到了不同程度的影响，在统计与观察接口
性能时应忽略这两项受影响数据。不同框架测试结果对应的折线图如图6-1 所示： 
 
图6-1 对比测试结果折线图 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page115_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page115_img1.png)

## Page 116

电子科技大学硕士学位论文 
102 
综合以上对比测试结果的图表内容可以得出，基于gRPC 框架实现的接口在
线程数为900 时出现了接口响应错误情况，其接口临界点小于基于FastAPI 框架实
现的接口。但在其接口错误率为0%时，根据线程数不同较基于FastAPI 实现的接
口有0.73%至19.94%的提升。考虑到本系统接口所设计的最大并发量为150 人次，
远小于gRPC 框架出现错误的线程数为900 的情况，故本系统算法模块的容器化
实现选择了优先采用gRPC 框架，同时保留了FastAPI 接口的实现，理想情况下
gRPC 框架实现接口可以较FastAPI 框架有更快的响应速度。 
6.3.3 系统核心功能接口测试 
针对系统预处理和辅助诊断这两个核心业务功能，由于其在运行阶段存在计
算量较大且耗时较长的特性，实际场景中通常不会出现高并发情况。为模拟真实场
景，本测试将采用Postman 的Runner 功能，通过短时间内的多次调用来实现压力
测试。在进行测试前，需对Postman 的Runner 功能配置参数进行简要说明，核心
配置参数仅包含两项：迭代次数和延迟，迭代次数为运行期间循环遍历用例集合的
次数；延迟代表每次迭代的时间间隔。 
根据本系统算法模块非功能性需求文档所述，由于不同算法之间的任务复杂
度、数据传输量和数据计算量差距存在较大的情况，系统没有对此部分的平均响应
时长进行约束，仅对错误率提出0%的要求。在迭代次数为20 次时，系统内全部
算法模块错误率均为0%，平均响应时长均在30 秒内。在迭代次数达到50 次时，
由于计算任务造成的服务器接口阻塞，各个算法模块的平均响应时长均显著增高，
但错误率仍为0%，符合系统对于算法模块提出的非功能需求规定。系统核心功能
接口测试结果如表6-15 所示： 
表6-15 系统核心功能接口测试结果 
接口名称 
迭代次数 
延迟 
平均响应时长 
错误率 
超声图像增强 
20 
1000ms 
11506ms 
0% 
50 
1000ms 
23960ms 
0% 
基于心电的先心
病预测 
20 
1000ms 
8614ms 
0% 
50 
1000ms 
17620ms 
0% 
全心脏分割 
20 
1000ms 
29118ms 
0% 
50 
1000ms 
74072ms 
0% 


## Page 117

第六章 面向胎儿心脏的分割分类辅助诊断系统测试 
103 
 本章小结 
本章主要介绍了系统功能测试和性能测试的测试结果。在功能测试方面，从与
详细设计模块划分相同的五大模块入手，测试了各个模块的功能正常性，每个模块
都通过设计大量的测试用例来确保测试覆盖范围的全面性，本章因篇幅限制仅展
示了功能测试合法用例，所有功能测试结果均符合预期。在性能测试方面，测试采
用了JMeter 和Postman 两种工具，针对接口的不同应用场景分别进行了并行和串
行测试。主要评估了接口的平均响应时长和错误率，验证系统在预计负载情况下的
运行状态。非功能测试结果均满足需求文档中的非功能测试要求。



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page117_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page117_img1.png)

## Page 118

电子科技大学硕士学位论文 
104 
总结与展望 
 工作总结 
本文开发的面向胎儿心脏的分割分类辅助诊断系统诞生于实验室与本市多家
医院的联合项目中，该项目需求源于临床实践中对胎儿先天性心脏病早期筛查的
迫切需求，从立项初期就确立了多达数十种基础医疗相关人工智能算法的扩展性
需求，在项目一期对几种常用算法进行了代表性、实验性实现。本人全程参与了项
目的需求分析、系统设计、功能实现、测试部署等项目流程，通过团队协作完成了
系统的研发工作。该系统成功解决了多模态医疗数据的关联构建、人工智能算法的
工程化应用以及辅助诊断业务流程的规范化实现等关键问题。 
在系统架构方面，本文应用了基于非阻塞式I/O 模型，且能统一支持Http API
和gRPC 协议的分布式网关作为不同算法模块的标准化入口。同时，利用Proto 文
件的模板化设计，有效简化了后续对算法服务进行扩展的开发流程和开发难度，有
效提高了系统的可扩展性。 
在数据存储方面，系统构建了基于MySQL、Redis 和MinIO 的混合存储架构，
通过合理的数据分层策略，实现了结构化数据和医学影像文件的高效管理。在多模
态数据管理方面，系统在设计了基于唯一身份识别码的数据关联机制的同时保留
了接入电子病历系统的接口，实现了患者心音、心动和超声等多模态数据的有效关
联，提供了灵活的患者信息管理方案。通过设计严格的数据访问控制机制和完善的
数据操作审计体系，确保了医疗数据的安全性和可追溯性。 
在算法工程化应用方面，系统全模块都采用Docker 容器化技术，包括算法模
块、分布式网关模块、业务系统模块、以及部分存储模块，并且完成了相关部署脚
本的编写。实现了算法环境的标准化封装。同时，通过缓存机制，优化了业务系统
的权限查询和算法处理结果的查询效率，提升了系统的整体性能。在业务流程设计
方面，系统建立了完整的医疗辅助诊断流程，包括数据预处理、辅助诊断，和最终
的结果审核。通过角色分离和权限控制，实现了医生、科研人员、医院管理员、系
统管理员等不同角色的协同工作。系统支持处理结果的人工审核和反馈，建立了完
善的质量控制机制。 



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page118_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page118_img1.png)

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page118_img2.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page118_img2.png)

## Page 119

第七章 总结与展望 
105 
 未来展望 
面向胎儿心脏的分割分类辅助诊断系统主要涉及的是高速稳定且可扩展性强
的人工智能算法调用系统架构和多模态数据关联构建两个研究方向。本文的系统
设计和开发依然存在些许不足，后续从以下几方面对系统不足之处进行展望： 
（1）在系统架构方面，可以进一步优化算法微服务网关的性能，引入服务网格
（Service Mesh）技术，对系统实现精确到每个微服务容器内部的检测和治理。对于
医疗系统的使用场景，系统还需要更加完善的服务监控和链路追踪机制，以提升系
统的可观测性。此外，系统还可考虑引入更高效的服务注册与发现机制，提升系统
的弹性伸缩能力。 
（2）数据管理方面，系统目前作为独立运行系统，使用了独立的患者信息系统
进行数据管理，虽然设计了与电子病历系统进行对接的相关同步接口，但仍需要进
一步加强与医院信息系统的集成对接能力，支持更多标准医疗数据格式的处理。同
时考虑到医疗信息的敏感性，系统需要建立更完善的数据备份和容灾方案。 
（3）在算法应用方面，目前系统不支持对相同算法的不同版本进行升降级服务，
后续可以设计更灵活的算法版本管理机制，支持算法的灰度发布和快速回滚。此外，
系统还可以考虑建立算法性能评估体系，实现算法效果的定期评估和持续优化。 
（4）在业务功能方面，目前系统的统计分析页面定制化能力较弱，只能展示基
本信息和部分算法准确率信息，后续可以考虑扩展系统的数据分析功能，提供更丰
富的统计报表。



### 图片

![面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page119_img1.png](images/面向胎儿心脏的分割分类辅助诊断系统的设计与实现_许志诚_page119_img1.png)

## Page 120

参考文献 
107 
参考文献 
[1] 
Sadowski S L. Congenital cardiac disease in the newborn infant: past, present, and future[J]. 
Critical care nursing clinics of North America, 2009, 21(1): 37-48. 
[2] 
Go A S, Mozaffarian D, Roger V L, et al. Heart disease and stroke statistics—2013 update: a 
report from the American Heart Association[J]. circulation, 2013, 127(1): e6-e245. 
[3] 
Van Der Linde D, Konings E E M, Slager M A, et al. Birth prevalence of congenital heart disease 
worldwide: a systematic review and meta-analysis[J]. Journal of the American College of 
Cardiology, 2011, 58(21): 2241-2247. 
[4] 
Dolk H, Loane M, Garne E, et al. Congenital heart defects in Europe: prevalence and perinatal 
mortality, 2000 to 2005[J]. Circulation, 2011, 123(8): 841-849. 
[5] 
李昆林. 国内外先天性心脏病发病率研究报告[J]. 云南医药, 2020, 41(3): 286-289. 
[6] 
封志纯, 王艳. 我国出生缺陷防控研究与应用进展[J]. 中国儿童保健杂志, 2019, 27(8): 
813. 
[7] 
Franklin O, Burch M, Manning N, et al. Prenatal diagnosis of coarctation of the aorta improves 
survival and reduces morbidity[J]. Heart, 2002, 87(1): 67-69. 
[8] 
Mozumdar N, Rowland J, Pan S, et al. Diagnostic accuracy of fetal echocardiography in 
congenital heart disease[J]. Journal Of The American Society Of Echocardiography, 2020, 
33(11): 1384-1390. 
[9] 
Verdurmen K M J, Eijsvoogel N B, Lempersz C, et al. A systematic review of prenatal screening 
for congenital heart disease by fetal electrocardiography[J]. International Journal of Gynecology 
& Obstetrics, 2016, 135(2): 129-134. 
[10] Crane J P, LeFevre M L, Winborn R C, et al. A randomized trial of prenatal ultrasonographic 
screening: impact on the detection, management, and outcome of anomalous fetuses[J]. 
American journal of obstetrics and gynecology, 1994, 171(2): 392-399. 
[11] 朱云,凌志刚,张雨强.机器视觉技术研究进展及展望[J].图学学报,2020,41(6):871-890. 
[12] 孙辉, 赵颖波. 我国执业医师资源配置现状分析及思考[J]. 中国医院, 2019, 23(6): 15-18. 
[13] Ali F, El-Sappagh S, Islam S M R, et al. A smart healthcare monitoring system for heart disease 
prediction based on ensemble deep learning and feature fusion[J]. Information Fusion, 2020, 63: 
208-222. 
[14] Friedman P A. The electrocardiogram at 100 years: history and future[J]. Circulation, 2024, 
149(6): 411-413. 


## Page 121

电子科技大学硕士学位论文 
108 
[15] 熊鹰. 1587例胎儿心电图检测分析及临床意义[J]. 南方医科大学学报, 2006, (02): 245-246. 
[16] 张强, 李博, 翟胜男, 等. 胎儿心电图的应用与进展[J]. 实用心电学杂志, 2024, 33(04): 
430-432. 
[17] Landon G, Denjoy I, Clero E, et al. Reference values of electrographic and cardiac ultrasound 
parameters in Russian healthy children and adolescents[J]. Scientific Reports, 2021, 11(1): 2916. 
[18] 李泽树, 杨虹, 杜俊峰, 等. CT 和MRI 在心血管疾病诊断中的应用[J]. 华西医学, 2006, 
21(3): 3. 
[19] Santos M K, Ferreira J R, Wada D T, et al. Artificial intelligence, machine learning, computer-
aided diagnosis, and radiomics: advances in imaging towards to precision medicine[J]. 
Radiologia brasileira, 2019, 52(06): 387-396. 
[20] Yanase J, Triantaphyllou E. A systematic survey of computer-aided diagnosis in medicine: Past 
and present developments[J]. Expert Systems with Applications, 2019, 138: 112821. 
[21] Shoumy N J, Ang L M, Seng K P, et al. Multimodal big data affective analytics: A 
comprehensive survey using text, audio, visual and physiological signals[J]. Journal of Network 
and Computer Applications, 2020, 149: 102447. 
[22] Chang H, Han T, Wang Z. Research on Chronic Disease Auxiliary Diagnosis System Based on 
Multimodal Deep Learning[C]. 2024 International Conference on Computing, Robotics and 
System Sciences (ICRSS). IEEE, 2024: 301-306. 
[23] Becker H C, Nettleton W J, Meyers P H, et al. Digital computer determination of a medical 
diagnostic index directly from chest X-ray images[J]. IEEE Transactions on Biomedical 
Engineering, 1964 (3): 67-72. 
[24] Lodwick G S, Haun C L, Smith W E, et al. Computer diagnosis of primary bone tumors: A 
preliminary report[J]. Radiology, 1963, 80(2): 273-275. 
[25] Bi W L, Hosny A, Schabath M B, et al. Artificial intelligence in cancer imaging: clinical 
challenges and applications[J]. CA: a cancer journal for clinicians, 2019, 69(2): 127-157. 
[26] van Ginneken B. Fifty years of computer analysis in chest imaging: rule-based, machine 
learning, deep learning[J]. Radiological physics and technology, 2017, 10: 23-32. 
[27] Fujita H. AI-based computer-aided diagnosis (AI-CAD): the latest review to read first[J]. 
Radiological physics and technology, 2020, 13(1): 6-19. 
[28] Haenssle H A, Fink C, Schneiderbauer R, et al. Man against machine: diagnostic performance 
of a deep learning convolutional neural network for dermoscopic melanoma recognition in 
comparison to 58 dermatologists[J]. Annals of oncology, 2018, 29(8): 1836-1842. 


## Page 122

参考文献 
109 
[29] Bejnordi B E, Veta M, Van Diest P J, et al. Diagnostic assessment of deep learning algorithms 
for detection of lymph node metastases in women with breast cancer[J]. Jama, 2017, 318(22): 
2199-2210. 
[30] Pinto dos Santos D, Baeßler B. Big data, artificial intelligence, and structured reporting[J]. 
European radiology experimental, 2018, 2(1): 42. 
[31] Benke K, Benke G. Artificial intelligence and big data in public health[J]. International journal 
of environmental research and public health, 2018, 15(12): 2796. 
[32] Wang X, Peng Y, Lu L, et al. Chestx-ray8: Hospital-scale chest x-ray database and benchmarks 
on 
weakly-supervised 
classification 
and 
localization 
of 
common 
thorax 
diseases[C]//Proceedings of the IEEE conference on computer vision and pattern recognition. 
2017: 2097-2106. 
[33] Trump D. Accelerating America’s leadership in artificial intelligence[EB/OL]. (2019-05-
10)[2024-12-10]. 
https://trumpwhitehouse.archives.gov/articles/accelerating-americas-
leadership-in-artificial-intelligence/. 
[34] 新华社. 习近平：决胜全面建成小康社会 夺取新时代中国特色社会主义伟大胜利——在
中国共产党第十九次全国代表大会上的报告[Z]. (2017-10-27)[2024-12-10]. 
https://news.cnr.cn/native/gd/20171027/t20171027_524003098.shtml. 
[35] Chen Y, Argentinis J D E, Weber G. IBM Watson: how cognitive computing can be applied to 
big data challenges in life sciences research[J]. Clinical therapeutics, 2016, 38(4): 688-701. 
[36] Bhardwaj R, Nambiar A R, Dutta D. A study of machine learning in healthcare[C]. 2017 IEEE 
41st annual computer software and applications conference (COMPSAC). IEEE, 2017, 2: 236-
241. 
[37] van Zandvoort K, Bobe M O, Hassan A I, et al. Social contacts and other risk factors for 
respiratory infections among internally displaced people in Somaliland[J]. Epidemics, 2022, 41: 
100625. 
[38] Zozus M N, Pieper C, Johnson C M, et al. Factors affecting accuracy of data abstracted from 
medical records[J]. PloS one, 2015, 10(10): e0138649. 
[39] Yang F, Yang H, Fu J, et al. Learning texture transformer network for image super-resolution[C]. 
Proceedings of the IEEE/CVF conference on computer vision and pattern recognition. 2020: 
5791-5800. 
[40] Simonyan K, Zisserman A. Very deep convolutional networks for large-scale image 
recognition[J]. arXiv preprint arXiv:1409.1556, 2014. 


## Page 123

电子科技大学硕士学位论文 
110 
[41] Ahmad Z, Tabassum A, Guan L, et al. ECG heartbeat classification using multimodal fusion[J]. 
IEEE Access, 2021, 9: 100615-100626. 
[42] Krizhevsky A, Sutskever I, Hinton G E. Imagenet classification with deep convolutional neural 
networks[J]. Advances in neural information processing systems, 2012, 25. 
[43] Ding Y, Mu D, Zhang J, et al. A cascaded framework with cross-modality transfer learning for 
whole heart segmentation[J]. Pattern Recognition, 2024, 147: 110088. 
[44] Girshick R. Fast r-cnn[C]. Proceedings of the IEEE international conference on computer vision. 
2015: 1440-1448. 
[45] Zhu J Y, Park T, Isola P, et al. Unpaired image-to-image translation using cycle-consistent 
adversarial networks[C]. Proceedings of the IEEE international conference on computer vision. 
2017: 2223-2232. 
[46] Gong K, Yang J, Larson P E Z, et al. MR-based attenuation correction for brain PET using 3-D 
cycle-consistent adversarial network[J]. IEEE transactions on radiation and plasma medical 
sciences, 2020, 5(2): 185-192. 
[47] Tsai Y H H, Bai S, Liang P P, et al. Multimodal transformer for unaligned multimodal language 
sequences[C]. Proceedings of the conference. Association for computational linguistics. 
Meeting. 2019, 2019: 6558. 
[48] Cai Y, Wang Y. Ma-unet: An improved version of unet based on multi-scale and attention 
mechanism for medical image segmentation[C]. Third international conference on electronics 
and communication; network and computer technology (ECNCT 2021). SPIE, 2022, 12167: 
205-211. 
[49] Qiu Z, Yao T, Mei T. Learning spatio-temporal representation with pseudo-3d residual 
networks[C]. proceedings of the IEEE International Conference on Computer Vision. 2017: 
5533-5541. 
[50] Hou Q, Zhou D, Feng J. Coordinate attention for efficient mobile network design[C]. 
Proceedings of the IEEE/CVF conference on computer vision and pattern recognition. 2021: 
13713-13722. 
[51] Wang K, Peng X, Yang J, et al. Suppressing uncertainties for large-scale facial expression 
recognition[C]. Proceedings of the IEEE/CVF conference on computer vision and pattern 
recognition. 2020: 6897-6906. 
 

